IU.prototype.mqa=ga(220,function(a){this.L=Lb(arguments,0)});function H7b(a,b,c){return Ejb(a,y(function(){return this.B.calculateArrayFormulaResultPreview(b,c,0,0,!0,this.F,!0)},a))}function VV(a){Ui(this,a,0,-1,null)}z(VV,Ti);function I7b(a,b){var c=b.width;b=b.height;for(var d=a.width<=c?1:Math.floor(a.width/c),e=a.height<=b?1:Math.floor(a.height/b),g=[],h=0;h<d;h++)for(var k=a.left+h*c,l=0;l<e;l++){var m=a.top+l*b;g.push(new kh(m,k,m+b,k+c))}return g}var J7b=[2];
function WV(a,b){var c=a.type;if(u(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(va(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":va(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,g=0;e=b[g];g++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}}
function K7b(a){var b=a.type;if(!u(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return u(a.value)?a.value:null}}function L7b(a){Ui(this,a,0,-1,null)}z(L7b,Ti);var M7b={Klc:0,Wxa:1,uya:2};function N7b(a){Ui(this,a,0,-1,J7b)}z(N7b,Ti);
function O7b(a,b,c){function d(){g=ja.setTimeout(e,b);a.apply(null,k)}function e(){g=null;h&&(h=!1,d())}c&&(a=y(a,c));var g=null,h=!1,k=[];return function(a){k=arguments;g?h=!0:d()}}function XV(a,b,c,d,e,g){J.call(this,a,b);this.B=b;this.Ba=c;this.Ea=d||null;this.Ya=e||null;this.D=g||null}z(XV,J);XV.prototype.Mj=f("Ba");XV.prototype.Be=f("Ea");function P7b(a,b,c,d,e,g){XV.call(this,"assistant-sidepane-insert-chart",null,d,e,g);this.U=a;this.X=b;this.Xb=c}z(P7b,XV);P7b.prototype.Xe=f("Xb");function Q7b(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(Xs({Qe:"waffle-assistant-section-more-button",content:Rr("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function YV(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Ta(b),Ws(a,b,void 0),J3b(a),a.setAttribute("data-tooltip-delay",500),K3b(a,u(c)?c:1))};function R7b(a,b,c){c=c||{};a=V;b='<div class="waffle-assistant-scroll-pane" style="'+(c.$a?"/*"+c.$a+"*/":"")+'display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">';c=c||{};c=V(""+('<div class="waffle-assistant-empty-list" style="'+(c.$a?"/*"+c.$a+"*/":"")+'display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>'));
return a(b+c+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}function S7b(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(Xs({Qe:"waffle-assistant-panel-back-button",content:Rr(""+U(uu({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function ZV(a){dq.call(this,a);this.Cd=new OV(!1,"#4285f4");this.Ka(this.Cd);this.J=new dq(this.ea);this.Ka(this.J);this.C=[];this.$h=this.Yc=!1;this.Re=this.we=this.Wa=this.X=null}z(ZV,dq);q=ZV.prototype;q.Qa=function(){ZV.V.Qa.call(this);this.va=ur(R7b);this.we=T(this,"waffle-assistant-panel-content-container");this.Re=T(this,"waffle-assistant-empty-list")};
q.Da=function(){ZV.V.Da.call(this);var a=T(this,"waffle-assistant-spinner-container");this.Cd.render(a);this.J.Ua(T(this,"waffle-assistant-panel-card-holder"));this.getHandler().R(this.va,"scroll",O7b(this.JUa,10,this))};q.setVisible=function(a){S(this.va,a);A(this.C,function(a){if(!a.mc()){var c=this.J.kd();a.U=c;this.J.Ka(a,!0);a.WN()}},this);this.Yc=a};
q.Hpa=function(a,b){var c=this.ea;this.X&&this.u4();this.X=new dq;this.Ka(this.X);a=sr(a,S7b,{title:b});this.Wa=new Ys("",this.ea);this.X.Ka(this.Wa);this.Wa.Ua(fn(c,"waffle-assistant-panel-back-button",a));YV(this.Wa.va,"Back");this.X.getHandler().R(this.Wa,"action",this.khb)};q.u4=function(){this.X.dispose();this.X=null};function T7b(a,b){a.Cd.setActive(b);S(T(a,"waffle-assistant-panel-pane"),!b)}q.gL=function(a){S(this.Re,a);S(this.we,!a)};
function U7b(a,b){Gb(a.C,b);a.J.removeChild(b);a.J.gi(b,0);a.C.push(b)}q.sB=function(a){Gb(this.C,a);-1!=mq(this.J,a)&&this.J.removeChild(a,!0)};q.D3=function(){this.J.Wd(!0);Fc(this.C);this.C=[]};q.JUa=function(){for(var a=this.va,a=a.scrollTop+Kp(a).height,b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?($V(d,!0),b+=Kp(d.va).height):$V(d,!1)}};function V7b(a,b){a.$h=b;A(a.C,function(a){a.rG(b)})}q.Hd=f("$h");q.khb=function(){this.dispatchEvent("assistant-sidepane-back-button-clicked")};function aW(a,b,c,d){dq.call(this,d);this.L=a;this.Xa=b;this.U=new Ys("",this.ea);this.Ka(this.U);this.F=new dq(this.ea);this.Ka(this.F);this.C=null;this.Sa=[];this.La=this.Ja=!1;this.J=c}z(aW,dq);q=aW.prototype;q.OKa=Gf;q.XRa=Hf;q.Qa=function(){aW.V.Qa.call(this);this.va=ur(Q7b,{title:this.M0()})};
q.Da=function(){aW.V.Da.call(this);this.F.Ua(T(this,"waffle-assistant-section-card-holder"));this.U.Ua(T(this,"waffle-assistant-section-more-button"));this.getHandler().R(this.U,"action",this.vrb);this.C=this.$Aa();H(this,this.C);S(W7b(this),this.OKa());this.setVisible(!1)};q.setVisible=function(a){if(this.mc()&&this.Ra()!=a&&(S(this.va,a),a)){S(this.U.va,this.$Ra());a=new L7b;var b=this.Yba();P(a,4,b);b=new Qn;Yi(b,58,a);this.J.Pb(2774,new Bo(10,b))}};q.Ra=function(){return this.mc()&&Np(this.va)};
q.$Ra=function(){return this.Sa.length>this.L};q.M0=v;q.IV=v;q.$Aa=function(){return new ZV(this.ea)};q.N0=function(a){this.La=a;A(X7b(this),function(b){b.rG(a)});V7b(this.C,a)};q.Hd=f("La");q.Ah=na;q.r3=v;q.Yba=v;q.Usa=function(a){this.Sa.push(a);if(this.F.kd()<this.L){var b=this.IV(a);b.rG(this.La);var c=this.F.kd();b.U=c;this.F.Ka(b,!0)}this.XRa()&&(this.C.gL(!1),b=this.C,a=this.IV(a),b.C.push(a),b.Yc&&(T7b(b,!1),c=b.J.kd(),a.U=c,b.J.Ka(a,!0),a.WN()))};
function X7b(a){var b=[];a.F.vg(function(a){b.push(a)});return b}function W7b(a){return T(a,"waffle-assistant-section-content")}q.$la=function(){return nua(this.F)};q.Xba=function(){this.Sa=[];Fc(this.F.Wd(!0));this.setVisible(!1);this.C.D3();this.C.gL(!0)};function Y7b(a){a.F.vg(function(a,c){c<this.L&&a.WN()},a)}
q.Vsa=function(a){var b=0;if(this.Ja)this.C.JUa();else if(this.$la()){this.setVisible(!0);for(var b=Kp(T(this,"waffle-assistant-section-header")).height+Kp(W7b(this)).height,c=X7b(this),d=0;d<c.length;d++)b<a&&d<this.L?(this.YHa(c[d]),$V(c[d],!0),b+=Kp(c[d].va).height):$V(c[d],!1)}else this.setVisible(!1);return a-b};q.YHa=na;q.setActive=function(a){(this.Ja=a)||this.C.u4()};q.Hb=f("Ja");function Z7b(a,b){a.C.Hpa(b,a.M0())}q.vrb=function(){this.setActive(!0);this.dispatchEvent("assistant-sidepane-set-active-panel")};var $7b={UNKNOWN_ERROR:0,$lc:1},a8b={Rlc:0,mC:1,hfc:2,Mec:3,Ugc:4},b8b={Olc:0,dfc:1,oH:2,Qcc:3},c8b={Ilc:0,vlc:1,w7b:2,Hkc:3,Gkc:4};function bW(){B.call(this)}z(bW,B);var d8b=null;bW.prototype.rl=function(){return C(this,1)};function cW(){B.call(this)}z(cW,B);var e8b=null;cW.prototype.getText=function(){return C(this,1)};cW.prototype.iq=function(){return wc(this,1)};function dW(){B.call(this)}z(dW,B);var f8b=null;dW.prototype.getStatus=function(){return C(this,1)};dW.prototype.hasFormula=function(){return wc(this,2)};dW.prototype.getError=function(){return C(this,9)};dW.prototype.xg=function(a){E(this,9,a)};
function eW(){B.call(this)}z(eW,B);var g8b=null;q=eW.prototype;q.n8=function(){return wc(this,1)};q.hasFormula=function(){return wc(this,2)};q.getType=function(){return C(this,3)};q.Dd=function(a){E(this,3,a)};q.bf=function(){return wc(this,3)};bW.prototype.Aa=function(){var a=d8b;a||(d8b=a=Dc(bW,{0:{name:"Error",fb:"ritz.assistant.Error"},1:{name:"message",qa:9,type:String},2:{name:"code",qa:14,defaultValue:0,type:$7b}}));return a};bW.Aa=bW.prototype.Aa;
cW.prototype.Aa=function(){var a=e8b;a||(e8b=a=Dc(cW,{0:{name:"AnswerQueryPhrase",fb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",qa:9,type:String},2:{name:"start_byte",qa:5,type:Number},3:{name:"num_bytes",qa:5,type:Number}}));return a};cW.Aa=cW.prototype.Aa;
dW.prototype.Aa=function(){var a=f8b;a||(f8b=a=Dc(dW,{0:{name:"AnswerResponse",fb:"ritz.assistant.AnswerResponse"},1:{name:"status",qa:5,type:Number},10:{name:"parse_status",qa:14,defaultValue:0,type:a8b},11:{name:"answer_status",qa:14,defaultValue:0,type:b8b},2:{name:"formula",qa:9,type:String},3:{name:"debug_parse_response",qa:9,type:String},4:{name:"interpretation",qa:9,type:String},5:{name:"debug_interpretation_response",qa:9,type:String},6:{name:"unused_phrase",td:!0,qa:11,type:cW},7:{name:"used_entity_phrase",
td:!0,qa:11,type:cW},8:{name:"unused_entity_phrase",td:!0,qa:11,type:cW},9:{name:"error",qa:11,type:bW},12:{name:"alternate_suggestion",td:!0,qa:11,type:eW}}));return a};dW.Aa=dW.prototype.Aa;eW.prototype.Aa=function(){var a=g8b;a||(g8b=a=Dc(eW,{0:{name:"QuerySuggestion",fb:"ritz.assistant.QuerySuggestion"},1:{name:"query",qa:9,type:String},2:{name:"formula",qa:9,type:String},3:{name:"type",qa:14,defaultValue:0,type:c8b}}));return a};eW.Aa=eW.prototype.Aa;function fW(){B.call(this)}z(fW,B);var h8b=null;fW.prototype.getChartType=function(){return C(this,1)};
fW.prototype.Aa=function(){var a=h8b;a||(h8b=a=Dc(fW,{0:{name:"AutovisRecommendationProto",fb:"ritz.assistant.AutovisRecommendationProto"},1:{name:"chart_type",qa:9,type:String},2:{name:"chart_title",qa:9,type:String},3:{name:"horizontal_axis_title",qa:9,type:String},4:{name:"horizontal_axis_min",qa:1,type:Number},5:{name:"horizontal_axis_max",qa:1,type:Number},6:{name:"left_vertical_axis_title",qa:9,type:String},7:{name:"left_vertical_axis_min",qa:1,type:Number},8:{name:"left_vertical_axis_max",
qa:1,type:Number},9:{name:"right_vertical_axis_title",qa:9,type:String},10:{name:"right_vertical_axis_min",qa:1,type:Number},11:{name:"right_vertical_axis_max",qa:1,type:Number},12:{name:"columns_to_group_by",td:!0,qa:5,type:Number},13:{name:"column_aggregation_types",td:!0,qa:9,type:String},14:{name:"is_transposed",qa:8,type:Boolean},15:{name:"use_first_column_as_domain",qa:8,type:Boolean},16:{name:"first_data_row_index",qa:5,type:Number},17:{name:"is_stacked",qa:8,type:Boolean},18:{name:"autovis_range",
qa:11,type:Md},19:{name:"text_analysis_words",td:!0,qa:9,type:String},20:{name:"text_analysis_word_counts",td:!0,qa:5,type:Number},21:{name:"mapped_column_label",td:!0,qa:9,type:String},22:{name:"best_facet_column",qa:5,type:Number},23:{name:"best_facet_labels",td:!0,qa:9,type:String},24:{name:"needs_data_transformation",qa:8,type:Boolean},25:{name:"data_transformation",qa:11,type:Ze}}));return a};fW.Aa=fW.prototype.Aa;var i8b={Jda:0,xca:1,$0:2,Z1:3};function gW(){B.call(this)}z(gW,B);var j8b=null;q=gW.prototype;q.getName=function(){return C(this,1)};q.lh=function(a){E(this,1,a)};q.getType=function(){return C(this,4)};q.Dd=function(a){E(this,4,a)};q.bf=function(){return wc(this,4)};function hW(){B.call(this)}z(hW,B);var k8b=null;hW.prototype.getName=function(){return C(this,1)};hW.prototype.lh=function(a){E(this,1,a)};function iW(){B.call(this)}z(iW,B);var l8b=null;function jW(a,b){return C(a,1,b)}
iW.prototype.Zd=function(a){return C(this,2,a)};iW.prototype.Ko=function(){return wc(this,2)};gW.prototype.Aa=function(){var a=j8b;a||(j8b=a=Dc(gW,{0:{name:"Dimension",fb:"ritz.assistant.Dimension"},1:{name:"name",qa:9,type:String},2:{name:"filter",td:!0,qa:9,type:String},3:{name:"non_unique_filter",td:!0,qa:13,type:Number},4:{name:"type",qa:14,defaultValue:0,type:i8b},5:{name:"year_only_dates",qa:8,type:Boolean},6:{name:"density",qa:1,type:Number}}));return a};gW.Aa=gW.prototype.Aa;
hW.prototype.Aa=function(){var a=k8b;a||(k8b=a=Dc(hW,{0:{name:"Metric",fb:"ritz.assistant.Metric"},1:{name:"name",qa:9,type:String}}));return a};hW.Aa=hW.prototype.Aa;iW.prototype.Aa=function(){var a=l8b;a||(l8b=a=Dc(iW,{0:{name:"EntityListTable",fb:"ritz.assistant.EntityListTable"},1:{name:"metric",td:!0,qa:11,type:hW},2:{name:"dimension",td:!0,qa:11,type:gW},3:{name:"non_unique_dimension",td:!0,qa:13,type:Number}}));return a};iW.Aa=iW.prototype.Aa;var m8b={pYb:0,fH:1,$Zb:2,PXb:3,CVa:4};function kW(){B.call(this)}z(kW,B);var n8b=null;function lW(){B.call(this)}z(lW,B);var o8b=null;lW.prototype.Mf=function(a){return C(this,4,a)};function mW(){B.call(this)}z(mW,B);var p8b=null;q=mW.prototype;q.getConfidence=function(){return C(this,2)};q.ah=function(){return C(this,3)};q.l6=function(){return C(this,4,0)};q.getPivotTableDef=function(){return C(this,5)};q.Oea=function(){return Bc(this,7)};q.getAutovisRecommendation=function(){return C(this,8)};
function nW(){B.call(this)}z(nW,B);var q8b=null;kW.prototype.Aa=function(){var a=n8b;a||(n8b=a=Dc(kW,{0:{name:"AssistantResponseProto",fb:"ritz.assistant.AssistantResponseProto"},1:{name:"recommendation",td:!0,qa:11,type:mW},2:{name:"selection_recommendation",td:!0,qa:11,type:mW}}));return a};kW.Aa=kW.prototype.Aa;
lW.prototype.Aa=function(){var a=o8b;a||(o8b=a=Dc(lW,{0:{name:"AssistantRequestProto",fb:"ritz.assistant.AssistantRequestProto"},1:{name:"table_range",qa:11,type:Md},2:{name:"selected_row",td:!0,qa:5,type:Number},3:{name:"selected_column",td:!0,qa:5,type:Number},4:{name:"color",td:!0,qa:11,type:md},5:{name:"color_frequency",td:!0,qa:5,type:Number}}));return a};lW.Aa=lW.prototype.Aa;
mW.prototype.Aa=function(){var a=p8b;a||(p8b=a=Dc(mW,{0:{name:"RecommendationProto",fb:"ritz.assistant.RecommendationProto"},1:{name:"recommendation_type",qa:14,defaultValue:0,type:m8b},2:{name:"confidence",qa:1,type:Number},3:{name:"description",qa:9,type:String},4:{name:"grid_ranges",td:!0,qa:11,type:Md},5:{name:"pivot_table_def",qa:11,type:Ie},6:{name:"conditional_format_rules",td:!0,qa:11,type:Pe},7:{name:"banding_protos",td:!0,qa:11,type:zd},8:{name:"autovis_recommendation",qa:11,type:fW},9:{name:"entity_list_table",
qa:11,type:iW}}));return a};mW.Aa=mW.prototype.Aa;
nW.prototype.Aa=function(){var a=q8b;a||(q8b=a=Dc(nW,{0:{name:"AssistantFlagsProto",fb:"ritz.assistant.AssistantFlagsProto"},1:{name:"include_text_histograms",qa:8,type:Boolean},2:{name:"include_word_clouds",qa:8,type:Boolean},3:{name:"include_conditional_formats",qa:8,type:Boolean},4:{name:"include_forms_integration",qa:8,type:Boolean},5:{name:"include_answers",qa:8,type:Boolean},6:{name:"include_autovis_faceting",qa:8,type:Boolean},7:{name:"include_banding",qa:8,type:Boolean},9:{name:"include_autovis_sum",
qa:8,type:Boolean}}));return a};nW.Aa=nW.prototype.Aa;function r8b(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(Ul?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(Ul?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function oW(){}z(oW,SI);oa(oW);oW.prototype.qc=n("waffle-assistant-link-button");function s8b(){var a;a=""+('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden">'+U(uu({Gv:"waffle-assistant-feedback-dogfood-icon-container",icon:"waffle-assistant-feedback-dogfood-icon"}))+'<div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>');return V(a)};function t8b(a,b){dq.call(this,b);this.C=a;this.B=new Rs("",new oW,this.ea);this.Ka(this.B)}z(t8b,dq);q=t8b.prototype;q.Qa=function(){this.va=ur(s8b)};q.Da=function(){t8b.V.Da.call(this);var a=T(this,"waffle-assistant-feedback-card-link");this.B.Ua(a);this.getHandler().R(this.va,"mousedown",this.YUb).R(this.B,"action",this.Kmb);this.show(!1)};q.YUb=function(a){a.stopPropagation()};
q.show=function(a){var b=this.va,c=T(this,"waffle-assistant-feedback-card-link");mp(b,"waffle-assistant-feedback-card-hidden",!a);Xm(c,a)};q.Kmb=function(){Q.Vw.Vb({source:this.C});this.show(!1);this.dispatchEvent(new J("feedback-dialog-opened"))};function pW(){}z(pW,Ps);oa(pW);pW.prototype.qc=n("waffle-assistant-button");function u8b(){var a;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(uu({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(uu({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function qW(a){dq.call(this,a);this.B=new Rs("",new pW,this.ea);this.Ka(this.B);this.C=new Rs("",new pW,this.ea);this.Ka(this.C)}z(qW,dq);qW.prototype.Qa=function(){this.va=ur(u8b)};qW.prototype.Da=function(){qW.V.Da.call(this);var a=T(this,"waffle-assistant-thumbs-down-button");this.B.Ua(a);YV(a,"Not useful");a=T(this,"waffle-assistant-thumbs-up-button");this.C.Ua(a);YV(a,"Useful");this.getHandler().R(this.B,"action",this.D).R(this.C,"action",this.F)};
function v8b(a,b){a.ea.Jf(T(a,"waffle-assistant-thumbs-text"),b)}qW.prototype.D=function(){this.dispatchEvent(new J("thumbs-down"));S(this.va,!1)};qW.prototype.F=function(){this.dispatchEvent(new J("thumbs-up"));S(this.va,!1)};function rW(a,b){dq.call(this,b);this.C=a;this.O=this.D=this.U=null;this.Ja=new OV(!0,"#4285f4");this.Ka(this.Ja);this.Sa=this.gb=this.Ic=!1;this.X=null;this.Pe=this.bb=!1}z(rW,dq);q=rW.prototype;q.ZB=v;q.Nw=v;q.fMa=Gf;q.VS=Gf;q.p8=Hf;q.dA=v;q.tJ=If;q.sJ=If;q.wja=If;q.$Fa=If;q.ZFa=If;q.rG=da("Pe");q.Hd=f("Pe");q.P7=na;q.Qa=function(){this.va=ur(r8b)};
q.Da=function(){rW.V.Da.call(this);var a=T(this,"waffle-assistant-card-spinner-container");this.Ja.render(a);pp(T(this,"waffle-assistant-card-inner"),"visibility","hidden");if(this.VS()){var a=this.va,b=new cq(a);H(this,b);this.getHandler().R(b,"focusin",this.Ohb).R(b,"focusout",this.Nhb).R(a,"mouseenter",this.Dla).R(a,"mouseleave",this.V7)}w8b(this,!1);this.p8()&&Ul?(this.O=new t8b(this.dA(),this.ea),this.O.render(T(this,"waffle-assistant-card-feedback-container")),this.D=new qW(this.ea),this.D.render(T(this,
"waffle-assistant-thumbs-container")),x8b(this,!0),a=Qa(this.wja()),Oa(a)||v8b(this.D,a),a=Qa(this.$Fa()),Oa(a)||YV(T(this.D,"waffle-assistant-thumbs-up-button"),a),a=Qa(this.ZFa()),Oa(a)||YV(T(this.D,"waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.D,"thumbs-down",this.WUb).R(this.D,"thumbs-up",this.XUb).R(this.O,"feedback-dialog-opened",this.Lmb).R(this,"trigger_feedback",this.dPb)):x8b(this,!1);this.Nw()};function sW(a){return T(a,"waffle-assistant-card-content-container")}
function y8b(a){a.VS();return T(a,"waffle-assistant-card-options")}function x8b(a,b){Ul&&S(T(a,"waffle-assistant-thumbs-container"),a.p8()&&b)}q.WN=function(){this.isDisposed()||(this.Ic=!0,z8b(this))};function $V(a,b){!a.gb&&b&&(a.gb=!0,z8b(a))}function z8b(a){if(a.Ic&&a.gb){var b=y(a.VUb,a);a.ZB(b)}}q.Dla=function(){this.Sa||(w8b(this,!0),this.Sa=!0,Sk(this.X),this.X=Rk(this.gAa,100,this))};
q.gAa=function(){this.isDisposed()||(Sk(this.X),this.X=null,this.va.parentNode.querySelector(":hover")==this.va?this.X=Rk(this.gAa,100,this):this.V7())};q.V7=function(){w8b(this,!1);this.Sa=!1};q.Ohb=function(){w8b(this,!0)};q.Nhb=function(){Rk(function(){this.isDisposed()||Sm(this.va,document.activeElement)||this.va.parentNode.querySelector(":hover")==this.va||w8b(this,!1)},0,this)};
q.WUb=function(){A8b(this,!0);x8b(this,!1);var a=this.sJ();this.dispatchEvent(new XV("assistant-sidepane-thumbs",this,a))};q.XUb=function(){x8b(this,!1);var a=this.tJ();this.dispatchEvent(new XV("assistant-sidepane-thumbs",this,a))};q.Lmb=function(){A8b(this,!1)};q.dPb=function(){A8b(this,!0)};function w8b(a,b){var c=T(a,"waffle-assistant-card-options");a=a.VS();S(c,a&&b)}q.VUb=function(){this.Ja.setActive(!1);S(this.Ja.va,!1);pp(T(this,"waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new J("content-rendered"))};
function A8b(a,b){mp(T(a,"waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.O.show(b)};function B8b(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function C8b(){return V(U(Xs({Qe:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Rr(""+U(uu({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(Xs({Qe:"waffle-assistant-zoom-button",content:Rr(""+U(uu({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function D8b(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.H2a)+"</span>"),b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle"></div></div><div class="waffle-assistant-facet-content-wrapper"><div class="waffle-assistant-facet-charts-container">\x3c!-- Create chart containers with two in each row. --\x3e');
a=a.Qab;for(var c=a.length,d=0;d<c;d++)var e=a[d],b=b+((0==d%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),b=e?b+U(e):b+"(empty)",b=b+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==d%2||d==c-1?"</div>":""));b+="</div>"+(Ul?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)}
;function E8b(a,b,c,d,e,g,h){dq.call(this,h);this.F=a;this.C=b;this.J=c;this.D=d;this.O=e;this.L=g;this.B=this.Xb=null;this.Zc=Do(new Co,10).Fa()}z(E8b,dq);q=E8b.prototype;q.Da=function(){E8b.V.Da.call(this);(new qV(lI,this.C.Qg)).send(y(this.ekb,this,this.C))};q.P7=function(a,b){var c=this.F.clone(),d=c.Rb("title")+(' when "'+(this.J+('" is "'+(this.D+'"'))));c.setOption("title",d);this.dispatchEvent(new P7b(c,this.O,this.Xb,2746,a,b))};
q.ekb=function(a,b){b&&((b=b.Xe())&&3>b.getNumberOfColumns()&&"BubbleChart"==a.getChartType()&&(a.dh("ScatterChart"),a.setOption("useFirstColumnAsDomain",!0),a.setOption("treatLabelsAsText",!1)),a.Hf(b),EV(a,b),JH(a,"ready",y(this.MUb,this,a)),LV(a,this.va,boa),this.Xb=b)};q.MUb=function(a){a.Eu()&&(JH(a.Eu(),"onmouseover",y(this.qib,this)),JH(a.Eu(),"onmouseout",y(this.rib,this)))};q.qib=function(){this.B=Ea()};q.rib=function(){za(this.B)&&500<Ea()-this.B&&this.L.Pb(2750,this.Zc);this.B=null};function F8b(a,b,c,d,e){dq.call(this,e);this.D=a;this.Ba=b;this.F=c;this.L=d;this.J=Bc(this.D,23);this.Y=C(this.D,22);this.Z=Bc(this.D,21)[this.Y];this.X=[];this.Ja=new Ei;this.O=this.C=this.B=null;this.U=!1;this.Zc=Do(new Co,10).Fa()}z(F8b,dq);q=F8b.prototype;q.Qa=function(){F8b.V.Qa.call(this);this.va=ur(D8b,{H2a:this.Z,Qab:this.J});this.va.style.visibility="hidden"};
q.Da=function(){F8b.V.Da.call(this);this.getHandler().R(this.va,"mousedown",this.JUb).R(T(this,"waffle-assistant-facet-toggle"),"mousedown",this.hzb);Ul&&(this.O=new t8b("assistantAutovisFacetFeedback",this.ea),this.O.render(T(this,"waffle-assistant-facet-feedback-container")),this.B=new qW(this.ea),this.Ka(this.B),this.B.render(T(this,"waffle-assistant-facet-thumbs-container")),v8b(this.B,"Were these charts useful?"),this.getHandler().R(this.B,"thumbs-up",this.LUb).R(this.B,"thumbs-down",this.KUb));
G8b(this,!0)};q.Hd=f("U");q.JUb=function(a){a.stopPropagation()};q.hzb=function(){var a=hp(T(this,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");G8b(this,a);this.F.Pb(a?2647:2646,this.Zc)};function G8b(a,b){Vm(T(a,"waffle-assistant-facet-toggle"),b?"HIDE":"SHOW");mp(T(a,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);a.B&&S(a.B.va,b)}
function H8b(a){a.L&&!a.U&&A(a.X,y(function(a){var c=a.va;if(!this.L.contains(c)){var d=this.L;a=new I8b(c,a);Kgb(d,a)}},a))}q.LUb=function(){this.F.Pb(2649,this.Zc)};q.KUb=function(){this.F.Pb(2648,this.Zc);this.O.show(!0)};function tW(a,b,c,d,e,g){rW.call(this,a,g);this.B=a.getAutovisRecommendation();this.Re=b;this.Yc=c;this.Cd=d;this.Ba=e;this.L=new Ys("",this.ea);this.Ka(this.L);this.La=new Ys("",this.ea);this.Ka(this.La);this.we=new Ei;this.bc=null;this.Z=!1;this.Lb=[];this.yb=[];this.Xa=[];this.F=this.J=this.Y=null;this.Zc=Do(new Co,10).Fa()}z(tW,rW);
var J8b={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}},K8b=["BarChart","ColumnChart"],uW={jVa:"waffle-assistant-after-chart-preview",FVa:"waffle-assistant-before-chart-preview",TVa:"waffle-assistant-card-draggable",
H1:"waffle-assistant-chart-highlights",eYa:"waffle-assistant-insert-chart-button",sda:"waffle-assistant-chart-preview",OZa:"waffle-assistant-button-separator",j_a:"waffle-assistant-styled-border",k_a:"waffle-assistant-styled-rect",i0a:"waffle-assistant-zoom-button"};q=tW.prototype;q.ZB=function(a){this.bc=a;L8b(this)};q.Nw=function(){M8b(this,y(function(a){a=Z6b(this.Re,a);fp(this.va,a)},this),!1)};q.fMa=Hf;q.VS=Hf;q.dA=n("autovisFeedback");q.tJ=n(2208);q.sJ=n(2207);q.wja=n("Was this chart useful?");
q.Qa=function(){tW.V.Qa.call(this);sW(this).appendChild(ur(B8b));y8b(this).appendChild(ur(C8b));var a=Bc(this.B,23);if(a&&0!=a.length){this.F=new F8b(this.B,this.U,this.Cd,this.Ba,this.ea);this.Ka(this.F,!0);var a=this.F,b=this.Hd();a.U=b;H8b(a)}};
q.Da=function(){tW.V.Da.call(this);ip(this.va,uW.TVa);var a=T(this,uW.eYa);this.L.Ua(a);YV(a,"Insert chart");a=T(this,uW.i0a);this.La.Ua(a);YV(a,"View full size");var a=T(this,uW.FVa),b=T(this,uW.sda),c=T(this,uW.jVa);this.getHandler().R(this.va,"keydown",this.GUb).R(b,"click",this.vib).R(a,"focus",this.rhb).R(c,"focus",this.ogb).R(this.L,"action",this.dpb).R(this.L.va,"mousedown",this.Tsa).R(this.La,"action",this.QAb).R(this.La.va,"mousedown",this.Tsa).R(T(this,uW.H1),"mousedown",this.Tsa).R(Zv(this.Re),
"Ib",this.HUb);N8b(this)};q.rG=function(a){tW.V.rG.call(this,a);N8b(this);this.mc()&&O8b(this)};function N8b(a){if(a.mc()){var b=a.Hd();a.L.setVisible(!b);a=fn(a.ea,uW.OZa,y8b(a));S(a,!b)}}q.GUb=function(a){13==a.keyCode&&a.target==this.va&&(a.preventDefault(),a.stopPropagation(),P8b(this,2255))};
function Q8b(a){for(var b=a.getChartType(),c=!!C(a.B,14),d=C(a.B,16),e=!!C(a.B,15),g="Histogram"==b,h="PieChart"==b,k=vW(a),l=1<k.length,m=[],b=0;b<k.length;b++){var p=R8b(k[b].rect,c!=h);Kb(m,p)}var b=Iz(a.Yc).jd(),r=sb(ec(Pg),b.K0,b),c=sb(m,function(a){return sb(r,Ca(oh,a))});g&&e&&(c=Lb(c,1));a.Xa=S8b(c.length,h&&0<d||!g&&!h&&e,h&&l);d=Iz(a.Yc);for(b=0;b<c.length;b++)for(e=a.Xa[b],g=0;g<c[b].length;g++)c[b][g]&&Ah(c[b][g])&&(h=TT(d,c[b][g],uW.k_a),H(a,h),PF(HI(d),h,!0),pp(h.va,"background-color",
e),h.setVisible(!0),a.Lb.push(h),h=nI(d,c[b][g],uW.j_a,1,0),H(a,h),AWa(h,e),h.setVisible(!0),a.yb.push(h))}function T8b(a){Fc(a.Lb);Fc(a.yb);a.Lb=[];a.yb=[];a.Xa=[]}q.HUb=function(){this.Z&&(T8b(this),Q8b(this))};q.Dla=function(){tW.V.Dla.call(this);this.Z||(Q8b(this),this.Z=!0)};q.V7=function(){tW.V.V7.call(this);T8b(this);this.Z=!1};q.vib=function(){this.va.focus()};
q.rhb=function(){var a=T(this,uW.H1);if(Np(a))a.focus();else{if(a=this.D)a=T(this.D,"waffle-assistant-thumbs-up-button"),Np(a)?(a.focus(),a=!0):a=!1;a||this.L.va.focus()}};q.ogb=function(){var a;if(a=this.O)a=this.O,T(a,"waffle-assistant-feedback-card-hidden")?a=!1:(T(a,"waffle-assistant-feedback-card-link").focus(),a=!0);a||this.va.focus()};q.dpb=function(){this.Cd.Pb(2255,this.Zc);P8b(this,2255)};q.Tsa=function(a){a.stopPropagation()};q.QAb=function(){X.Z0.Vb(this)};
q.P7=function(a,b){P8b(this,2257,a,b)};function P8b(a,b,c,d){M8b(a,y(function(a){a=new P7b(a,this.U,this.J&&this.J.Xe(),b,c,d);this.dispatchEvent(a)},a),!1)}
q.IUb=function(a,b){if(b){(b=b.Xe())&&3>b.getNumberOfColumns()&&"BubbleChart"==a.getChartType()&&(a.dh("ScatterChart"),a.setOption("useFirstColumnAsDomain",!0));a.Hf(b);EV(a,a.Xe());B3b(a,"ready",y(this.FUb,this));b=[];try{var c=new Ye;c.setContext(a.toJSON());var d=!!C(this.B,14);E(c,3,d);var e=C(this.B,16);E(c,4,e);E(c,5,"ROWS"==(d?"ROWS":"COLS"));E(c,8,0);var g;if(C(this.B,24)){g=[QT(C(this.B,18))];var h=C(this.B,25);E(c,9,h)}else g=vW(this);for(d=0;d<g.length;d++)c.addRange(Gh(g[d].rect,g[d].xd));
var k=this.we.serialize(c);b=sb(g7b(Ca(ritz.getVerbalHighlightsForProto,k),a).call(),d7b)}catch(l){b=[]}c=T(this,uW.H1);S(c,0<b.length);0<b.length&&(c.appendChild(b[0]),Xm(c,!0));this.J=a;LV(a,T(this,uW.sda),boa)}};q.FUb=function(){null!==this.Y&&(MJ(KJ.getInstance(),this.Y),this.Y=null);this.isDisposed()||(this.bc(),O8b(this))};function O8b(a){if(a.Ba&&!a.Hd()){var b=T(a,uW.sda);if(!a.Ba.contains(b)){var c=a.Ba;a=new I8b(b,a);Kgb(c,a)}}}
function U8b(a){a.bb&&(a.Y=LJ(KJ.getInstance(),dj.xta),a.bb=!1);var b=new UH(qc(J8b)),c=a.B.getChartType(),d=C(a.B,16),e=!!C(a.B,14),e=1<vW(a).length||!e&&1<vW(a)[0].rect.width||e&&1<vW(a)[0].rect.height;("PieChart"==c&&!e||"PieChart"!=c&&0>=d)&&b.setOption("legend.position","none");b.setOption("title",C(a.B,2));b.setOption("hAxis.title",C(a.B,3));wc(a.B,4)&&b.setOption("hAxis.viewWindow.min",C(a.B,4));wc(a.B,5)&&b.setOption("hAxis.viewWindow.max",C(a.B,5));b.setOption("vAxes.0.title",C(a.B,6));wc(a.B,
7)&&b.setOption("vAxes.0.viewWindow.min",C(a.B,7));wc(a.B,8)&&b.setOption("vAxes.0.viewWindow.max",C(a.B,8));b.setOption("vAxes.1.title",C(a.B,9));wc(a.B,10)&&b.setOption("vAxes.1.viewWindow.min",C(a.B,10));wc(a.B,11)&&b.setOption("vAxes.1.viewWindow.max",C(a.B,11));b.setOption("useFirstColumnAsDomain",C(a.B,15));b.setOption("isStacked",C(a.B,17));b.setOption("treatLabelsAsText",yb(K8b,c));b.dh(c);d=Bc(a.B,12);if(!C(a.B,24)&&d&&d.length)if(b.setOption("applyAggregateData",0),d=Bc(a.B,13),"PieChart"===
c)b.setOption("aggregateFunction",d[0]);else for(c=0;c<d.length;c++)b.setOption("series."+c+".aggregateFunction",d[c]);b.raa(lI);c=V8b(a,vW(a));b.oi(c.toString());a.F&&(c=c.clone(),a.F.C=c);return b}
function L8b(a){var b=U8b(a);b.setOption("legend.position","none");b.setOption("hAxis.slantedText",0);b.setOption("hAxis.textStyle.fontSize",11);b.setOption("vAxes.0.textStyle.fontSize",11);b.setOption("vAxes.1.textStyle.fontSize",11);b.setOption("fontStyle.size",10);b.setOption("fontStyle.italic",!1);b.setOption("titleTextStyle.bold",!1);b.setOption("titleTextStyle.fontSize",12);b.setOption("async",40);!1!==b.Rb("useFirstColumnAsDomain")&&b.Xe()&&"number"===b.Xe().bd(0)&&b.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==b.Rb("useFirstColumnAsDomain")&&b.Xe()&&"string"===b.Xe().bd(0)){var c=0,d=Em("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";T(a,"waffle-assistant-card-inner").appendChild(d);for(var e=0;e<b.Xe().getNumberOfRows();e++)Vm(d,b.Xe().qf(e,0)),c=Math.max(c,Rp(d).width);Lm(d);c=Math.min(27,Math.max(15,10+100*c/271))}"BubbleChart"==b.getChartType()&&(b.setOption("bubble.highContrast",!1),b.setOption("bubble.stroke","none"),b.setOption("bubble.textStyle.fontSize",2E3),
b.setOption("bubble.textStyle.color","transparent"),b.setOption("sizeAxis.minSize",4),b.setOption("sizeAxis.maxSize",4),b.setOption("treatLabelsAsText",!0));b.setOption("chartArea.top","15%");d=b.Rb("hAxis.title");b.setOption("chartArea.height",Oa(Qa(d))?"80%":"65%");b.setOption("chartArea.left",c+"%");b.setOption("chartArea.width",95-c+"%");"PieChart"==b.getChartType()&&(b.setOption("chartArea.top",Oa(Qa(b.Rb("title")))?"12%":"15%"),b.setOption("chartArea.height","70%"),b.setOption("chartArea.left",
"0%"),b.setOption("chartArea.width","100%"),b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled"),b.setOption("legend.textStyle.fontSize",10));(new qV(lI,b.Qg)).send(y(a.IUb,a,b));a.F&&M8b(a,y(function(a){var b=this.F,c=new UH(a.toJSON());c.setOption("axisFontSize",0);c.setOption("hAxis.title",null);c.setOption("hAxis.textPosition","none");c.setOption("vAxes.0.title",null);c.setOption("vAxes.0.textPosition","none");c.setOption("vAxes.1.title",null);c.setOption("vAxes.1.textPosition",
"none");c.setOption("allowAsync",!0);c.setOption("titleTextStyle.fontSize",0);c.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});c.setOption("legend","none");c.setOption("applyAggregateData",void 0);c.setOption("pieSliceTextStyle.fontSize",11);c.setOption("tooltip.textStyle.fontSize",11);"BubbleChart"==c.getChartType()&&(c.setOption("bubble.highContrast",!1),c.setOption("bubble.stroke","none"),c.setOption("bubble.textStyle.color","transparent"),c.setOption("sizeAxis.minSize",3),
c.setOption("sizeAxis.maxSize",3),c.setOption("treatLabelsAsText",!0));var d=QT(C(b.D,18));X1a(b.C,[d]);for(var d=C(b.D,25),e=fq(b,"waffle-assistant-faceted-chart"),p=0;p<e.length;p++){var r=d.clone(),t=r,w=b.Y,x=b.J[p],D=new cf;E(D,1,w);D.Ta(x);E(t,7,D);b.C.eb("dt",encodeURIComponent(JSON.stringify(b.Ja.serialize(r))));r=new UH(a.toJSON());r.oi(b.C.toString());t=c.clone();t.oi(b.C.toString());r=new E8b(r,t,b.Z,b.J[p],b.Ba,b.F,b.ea);b.Ka(r);r.Ua(e[p]);b.X.push(r)}H8b(b);b.va.style.visibility="visible"},
a),!1)}function M8b(a,b,c){var d=U8b(a);if("BubbleChart"==d.getChartType()){d.dh("ScatterChart");if(!1!==d.Rb("useFirstColumnAsDomain")){var e=vW(a),g=e[0].rect,h=C(a.B,14);if(!h&&1==g.width||h&&1==g.height)e=Lb(e,1);else{var k=g.fc()+(h?1:0),l=g.Rc(),h=g.Ub()+(h?0:1),m=g.cd();O2b(g,k,h,l,m)}a=V8b(a,e);d.oi(a.toString())}d.setOption("useFirstColumnAsDomain",!0)}(new qV(lI,d.Qg)).send(function(a){a?(a=a.Xe(),c&&d.Hf(a),EV(d,a),b(d)):b(null)})}
function V8b(a,b){var c=!!C(a.B,14),d=C(a.B,16)||0,c=sl(S1a("/gviz/tq"),"").eb("transpose",c?"1":"0").eb("headers",d.toString()).eb("hds",0).eb("merge",c?"ROWS":"COLS").eb("authkey",em("authKey"));C(a.B,24)&&(b=[QT(C(a.B,18))],c.eb("dt",encodeURIComponent(JSON.stringify(a.we.serialize(C(a.B,25))))));X1a(c,b);return c}function vW(a){a=Bc(a.C,4);for(var b=[],c=0;c<a.length;c++)b.push(QT(a[c]));return b}q.getChartType=function(){return this.B.getChartType()};
function S8b(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=m5b("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Kb(d,d);return d}function R8b(a,b){return b?I7b(a,new bh(a.width,1)):I7b(a,new bh(1,a.height))};function W8b(){GL.call(this);this.Ia.push(this);this.oa=this.Z=!0;this.La="waffle-assistant-dragged-card"}z(W8b,Jgb);W8b.prototype.contains=function(a){return!!A(this.F,function(b){if(b.element==a)return!0})};W8b.prototype.Pja=function(a){var b=W8b.V.Pja.call(this,a);if(T3b()){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=sb(b.querySelectorAll("clippath"),function(a){return a.id}),X8b(b,a);return b};
function X8b(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];va(c)&&$a(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=Nm(a);for(d=0;d<a.length;d++)X8b(a[d],b)}function I8b(a,b){IL.call(this,a,b)}z(I8b,IL);I8b.prototype.Rja=f("element");function Y8b(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function wW(a,b){rW.call(this,a,b);this.B=a.getAutovisRecommendation()}z(wW,rW);q=wW.prototype;q.Nw=na;q.dA=n("assistantWordCloudFeedback");q.tJ=n(2634);q.sJ=n(2633);q.Qa=function(){wW.V.Qa.call(this);sW(this).appendChild(ur(Y8b));ip(sW(this),"waffle-assistant-word-cloud-content-container")};
q.ZB=function(a){for(var b=Bc(this.B,19),c=Bc(this.B,20),d=T(this,"waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(this.Al(b,c,e),120<d.clientHeight){this.Al(b,c,e-1);break}b=this.ea;c=C(this.B,2);c=jn(b,c);d=T(this,"waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
q.Al=function(a,b,c){for(var d=T(this,"waffle-assistant-word-cloud-words-container"),e=this.ea;d.firstChild;)d.removeChild(d.firstChild);for(var g=b[c],h=b[0],k=0;k<=c;k++){0!=k&&d.appendChild(jn(e," "));var l=e.createElement("SPAN");e.appendChild(l,jn(e,a[k]));e.appendChild(d,l);ip(l,"waffle-assistant-word-cloud-word");var m=b[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-g)/(h-g)*15+9+"px"}};function xW(a,b,c,d,e){aW.call(this,20,d,c,e);this.Y=a;this.X=b;this.B=new W8b;H(this,this.B);this.D=null;this.O=0}z(xW,aW);q=xW.prototype;q.Da=function(){xW.V.Da.call(this);this.B.Ue();this.getHandler().R(this.B,"drag",this.EUb).R(this.B,"dragend",this.DUb)};q.M0=n("Analysis");q.r3=function(a){return 0==a};q.IV=function(a){return"WordCloud"==a.getAutovisRecommendation().getChartType()?new wW(a,this.ea):new tW(a,this.Y,this.X,this.J,this.B,this.ea)};q.N0=function(a){xW.V.N0.call(this,a);a&&rgb(this.B)};
q.YHa=function(a){Cf(this.getHandler(),a,"content-rendered",this.CUb);this.O++};q.CUb=function(){0==--this.O&&this.dispatchEvent("assistant-done-rendering")};q.EUb=function(){this.D=Gp(this.B.Tc.target)};q.DUb=function(a){var b=this.D,c=Iz(this.X).B;if(gh(yE(c,"page",!1,!1)).contains(b)){var d=wE(c,b.x,b.y,"page"),c=AE(c,mh(d),"page"),b=new N(b.x-c.left,b.y-c.top);a.B.getData().P7(d,b)}this.D=null};q.Yba=n(2);function yW(a,b,c,d){this.B=a;this.IH=b;this.$z=c?C(c,2):null;this.F=c?Bc(c,6):[];this.J=c?Bc(c,7):[];this.D=c?Bc(c,8):[];this.error=d;this.interpretation=Yna&&c&&wc(c,4)?C(c,4):null;this.C=Zna&&c?Bc(c,12):[]}function zW(a){return null==a.error&&null!=a.$z}
function Z8b(a){var b=[];if(Xna&&zW(a)){var c=[];A(Ib(a.F,a.D),function(a){c.push($8b(a,"waffle-assistant-answercard-question-unused-phrase"))},a);A(a.J,function(a){c.push($8b(a,"waffle-assistant-answercard-question-used-entity"))},a);Qb(c,function(a,b){return a.PB>b.PB?1:-1});var d=0;A(c,function(a){a.PB>d&&b.push({text:this.B.substring(d,a.PB),className:null});d=a.PB+a.length;b.push({text:this.B.substring(a.PB,d),className:a.pk})},a);d<a.B.length&&b.push({text:a.B.substring(d),className:null})}else b.push({text:a.B,
className:null});return{nKb:b,interpretation:a.interpretation,IH:a.IH,$z:a.$z,error:a.error}}function $8b(a,b){return{PB:C(a,2),length:C(a,3),pk:b}};function AW(a,b,c,d){L.call(this);this.U=a;this.X=b;this.Y=c;this.Ia=d;this.ma=new M(this);H(this,this.ma);this.B=new IU;H(this,this.B);this.O="";this.L=[];this.D=this.C=this.J=null;this.F=!1;q4b(this.B,this.U);this.B.U=10;this.B.Z=!0;this.B.J=!1;this.B.mqa("waffle-assistant-visible");this.B.O=Ta("waffle-assistant-dragged-formula").split(" ");this.B.Ue();this.ma.R(this.B,"beforedragstart",this.Z).R(this.B,"dragmove",this.Ea).R(this.B,"beforedragend",this.oa)}z(AW,L);
AW.prototype.Z=function(a){a=pb(this.U.childNodes,a.B);this.O=this.L[a]};
AW.prototype.Ea=function(a){var b=a.event instanceof bq?a.event.B:a.event;this.F?(a.U.Yv(b,!0),a.preventDefault()):(vp(a.D,a.event.clientX,a.event.clientY),a=wp(a.D),b=Iz(this.X).B,gh(yE(b,"page",!1,!1)).contains(a)?(a=wE(b,a.x,a.y,"page"),(b=Iw(aw(this.Y),a.y,a.x))?a=new N(b.Ub(),b.fc()):b=mh(a),this.J=a,this.C&&this.C.rc().equals(b)||(a=Iz(this.X),I(this.C),this.C=TT(a,b,"waffle-assistant-formula-insertion-rect"),H(this,this.C),PF(HI(a),this.C),I(this.D),this.D=nI(a,b,"waffle-assistant-formula-insertion-border",
2,0),H(this,this.D),AWa(this.D,"#000"),this.D.setVisible(!0))):a9b(this))};AW.prototype.oa=function(a){if(this.J){var b=this.J,c=aw(this.Y),b=new TE(c,b,this.O);this.Ia.B(b);this.dispatchEvent(new J("formula_inserted"))}a.U.Yv(null,!0);a.preventDefault();this.O="";a9b(this)};function a9b(a){a.J=null;I(a.C);a.C=null;I(a.D);a.D=null};function b9b(){return V('<div class="waffle-assistant-answers-card-remove">'+U(uu({icon:"docs-icon-img docs-icon-trash"}))+"</div>")};function c9b(a){null==a.IH||ra(a.IH);var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+d9b(a),d;null==a.IH||ra(a.IH);d=a.IH;var e=a.$z;a=a.interpretation;a=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Ur("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(a?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(a)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){a+='<div class="waffle-assistant-answercard-answer">';for(var g=d.length,h=0;h<g;h++){var k=d[h];if(0==h&&1<k.length){a+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=k.length,m=0;m<l;m++)a+='<span class="waffle-assistant-answercard-answer-col">'+U(k[m])+"</span>"}else for(a+='<div class="waffle-assistant-answercard-answer-row">',l=k.length,m=0;m<l;m++){var p=k[m];a=p?a+('<span class="waffle-assistant-answercard-answer-col">'+
U(p)+"</span>"):a+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}a+="</div>"}a+="</div>"}a+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+U(uu({icon:"docs-icon-img docs-icon-insert-formula"}))+
'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+U(e)+"</div></div></div></div></div></div>";d=V(a);return b(c+d+"</div></div>")}
function e9b(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+d9b(a);a=a.error;a=V('<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(uu({icon:"docs-icon-img docs-icon-alert"}))+'</div><div class="waffle-assistant-answercard-error-content"><div class="waffle-assistant-answercard-error">'+U(a)+"</div></div></div>");return b(c+a+"</div></div>")}
function d9b(a){a=a.nKb;var b;b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Ur("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+"</div></div></div>")}
function f9b(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')}function g9b(){return V(U(b9b()))};var h9b="help;how can;how do i;how do you;how do u;how to;what can;what is this".split(";");function i9b(a,b){J.call(this,"sqc");this.D=a;this.B=b||""}z(i9b,J);function BW(a,b,c,d,e,g,h,k){rW.call(this,new mW,k);this.B=a;this.Xa=b;this.Lb=c;this.yb=d;this.bc=g;this.La=e;this.Ba=h;this.Zc=Do(new Co,10).Fa();this.Z=new Rs("",new pW,this.ea);this.Ka(this.Z);this.Y=this.J=this.L=this.F=null}z(BW,rW);
var CW={C3b:"waffle-assistant-answercard-feedback-container",rXa:"waffle-assistant-answercard-feedback-link",FXa:"waffle-assistant-answercard-formula",HXa:"waffle-assistant-answercard-formula-text-container",GXa:"waffle-assistant-answercard-formula-text",VXa:"waffle-assistant-answercard-hide-formula-link",wZa:"waffle-assistant-answers-card-remove",LZa:"waffle-assistant-answercard-see-formula-link"};q=BW.prototype;
q.Qa=function(){BW.V.Qa.call(this);if(zW(this.B)){var a=this.ea;this.L=new Rs("",new oW,a);this.Ka(this.L);this.J=new Rs("",new oW,a);this.Ka(this.J)}else this.Y=new Rs("",new oW,a),this.Ka(this.Y);y8b(this).appendChild(ur(g9b))};q.Da=function(){BW.V.Da.call(this);var a=T(this,CW.wZa);this.Z.Ua(a);YV(a,"Remove card",0);a=this.getHandler();Cf(a,this.Z,"action",this.OUb);zW(this.B)?a.R(this.L,"action",this.Gwb).R(this.J,"action",this.iob):Cf(a,this.Y,"action",this.Swb)};
q.ZB=function(a){var b=zW(this.B)?c9b:e9b;sW(this).appendChild(ur(b,Z8b(this.B)));zW(this.B)?(this.L.Ua(T(this,CW.LZa)),this.J.Ua(T(this,CW.VXa)),this.F=new AW(T(this,CW.HXa),this.Xa,this.Lb,this.yb),b=this.Hd(),this.F.F=b,this.F.L=[this.B.$z],H(this,this.F),b=T(this,"waffle-assistant-answercard-formula-text"),fp(b,"Formula: "+(this.B.$z+". Click/Press ENTER to copy or drag to insert on to sheet.")),Ef(this.getHandler().R(this.F,"formula_inserted",this.NUb),T(this,CW.GXa),hd,this.Anb),j9b(this,!1)):
(x8b(this,!1),b=ur(f9b),this.ea.appendChild(this.va,b),this.Y.Ua(T(this,CW.rXa)));a()};q.Nw=function(){fp(this.va,"Answer Card for question: "+this.B.B)};q.VS=Hf;q.dA=n("assistantAnswersFeedback");q.tJ=function(){return zW(this.B)?2628:2654};q.sJ=function(){return zW(this.B)?2627:2653};q.wja=n("Was this answer correct?");q.$Fa=n("Correct");q.ZFa=n("Incorrect");q.rG=function(a){BW.V.rG.call(this,a);this.F&&(this.F.F=a)};
function j9b(a,b){a.L.setVisible(!b);a.J.setVisible(b);S(T(a,"waffle-assistant-answercard-formula"),b)}q.OUb=function(){var a=new VV;P(a,3,zW(this.B));var b=new XT;Yi(b,4,a);a=new Qn;Yi(a,46,b);this.La.Pb(2753,new Bo(10,a));this.dispatchEvent(new J("rc"))};q.Gwb=function(){j9b(this,!0)};q.iob=function(){j9b(this,!1)};q.NUb=function(){this.La.Pb(2709,this.Zc)};q.Swb=function(){this.Y.setVisible(!1);S(T(this,"waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new J("trigger_feedback"))};
q.Anb=function(){var a=this.ea.jb(),b=a.createElement("textarea");b.textContent=this.B.$z;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&k9b(this.bc,"Formula copied to clipboard",this.ea)};function l9b(a,b,c){c=c||{};a=Qr("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(uu({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="'+(c.$a?"/*"+c.$a+"*/":"")+'display:none"></div></div></form></div>';return V(a)};function m9b(a){var b,c;c=Qr("Suggested question");b='<div class="waffle-assistant-suggested-questions">';a=a.PVa;for(var d=a.length,e=0;e<d;e++){var g=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(uu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+U(g)+"</div></div></div>"}return V(b+
"</div>")}function n9b(a){return V('<div class="waffle-assistant-answers-suggestioncard-header">'+U(a.title)+"</div>")};function DW(a,b){rW.call(this,a,b);this.J=null}z(DW,rW);q=DW.prototype;q.p8=Gf;q.L0=v;q.qX=v;q.ZB=function(a){0<this.ea.Kh(sW(this)).length||this.h_();a()};q.dA=n("assistantAnswersFeedback");
q.h_=function(){var a=this.ea,b=sW(this),c=Qa(this.L0());Oa(c)||a.TA(b,ur(n9b,{title:c}),0);this.J=ur(m9b,{PVa:this.qX()});b.appendChild(this.J);b=fq(this,"waffle-assistant-answercard-question-container");A(b,function(b,c){var g=new Rs("",new pW,a);this.Ka(g);g.Ua(b);this.getHandler().R(g,"action",y(this.Gub,this,c))},this)};q.Gub=function(a,b){var c=b.target.getElement();b=this.ea;c=fn(b,"waffle-assistant-answercard-question",c);b=b.Mx(c);this.dispatchEvent(new i9b(a,b))};function EW(a,b,c,d){DW.call(this,new mW,d);this.L=a;this.B=b;this.F=c}z(EW,DW);EW.prototype.L0=function(){return this.B?"RELATED QUESTIONS":"Did you mean?"};EW.prototype.qX=function(){return sb(this.F,function(a){return C(a,1)})};EW.prototype.Nw=function(){fp(this.va,(this.B?"Related Questions for user question ":"Did you mean for user question ")+this.L)};
EW.prototype.h_=function(){EW.V.h_.call(this);var a=this.B?"waffle-assistant-answers-suggestioncard-related-ques-header":"waffle-assistant-answers-suggestioncard-dym-header";this.L0();ip(T(this,"waffle-assistant-answers-suggestioncard-header"),a)};function o9b(a){a=""+('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answers-helpcard-content" ><div class="waffle-assistant-answers-helpcard-text">'+U(a.text)+'</div><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-helpcenter-link-container">Or Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?</div></div><div class="waffle-assistant-answers-helpcard-suggestions-heading" role="heading">Try suggested questions</div></div>');
return V(a)}function p9b(){return V(U(b9b()))};function FW(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){var g;do g=Math.floor(Math.random()*a);while(d[g]);d[g]=1;c.push(g)}else{for(e=0;e<a;e++)c.push(e);for(e=0;e<b;e++)d=Math.floor(Math.random()*(a-e)+e),g=c[e],c[e]=c[d],c[d]=g}return c.slice(0,b)}function GW(a){return FW(a,1)[0]};function HW(a,b,c){DW.call(this,new mW,c);this.Ba=a;this.Z=b;this.Y=null;this.B=new Rs("",new oW,this.ea);this.Ka(this.B);this.F=new Rs("",new oW,this.ea);this.Ka(this.F);this.L=new Rs("",new pW,this.ea);this.Ka(this.L)}z(HW,DW);q=HW.prototype;q.VS=Hf;q.Qa=function(){HW.V.Qa.call(this);ip(this.va,"waffle-assistant-answers-helpcard");y8b(this).appendChild(ur(p9b))};
q.Da=function(){HW.V.Da.call(this);var a=T(this,"waffle-assistant-answers-card-remove");this.L.Ua(a);YV(a,"Remove card",0);Cf(this.getHandler().R(this.B,"action",this.TUb).R(this.F,"action",this.eob),this.L,"action",this.UUb)};q.h_=function(){HW.V.h_.call(this);this.Y=ur(o9b,{text:"Answers lets you ask questions to build formulas over your data"});this.ea.WA(this.Y,this.J);this.B.Ua(T(this,"waffle-assistant-answers-learn-more"));this.B.setVisible(!1);this.F.Ua(T(this,"waffle-assistant-answers-helpcenter-link"))};
q.L0=If;q.qX=function(){var a=q9b(this.Ba),b=FW(a.length,Math.min(a.length,3)),c=[];A(b,function(b){c.push(a[b])});return sb(c,function(a){return a.query})};q.Nw=function(){fp(this.va,"Help card with suggestions")};q.eob=function(){Q.Yo.Vb()};q.TUb=function(a){a.stopPropagation();a.preventDefault();Fo("https://support.google.com/docs/answer/6280499",{target:"_blank"})};q.UUb=function(){var a=new VV;P(a,3,!1);var b=new XT;Yi(b,4,a);a=new Qn;Yi(a,46,b);this.Z.Pb(2753,new Bo(10,a));this.dispatchEvent(new J("rc"))};function r9b(a){rW.call(this,new mW,a);this.B=this.ea.createElement("div");Vm(this.B,"Previous")}z(r9b,rW);q=r9b.prototype;q.Nw=function(){fp(this.va,"Previous questions below")};q.Qa=function(){r9b.V.Qa.call(this);kp(this.va,"waffle-assistant-card");ip(this.va,"waffle-assistant-answers-previousheadercard")};q.ZB=function(a){0<this.ea.Kh(sW(this)).length||sW(this).appendChild(this.B);a()};q.p8=Gf;q.dA=n("assistantAnswersFeedback");function s9b(a){this.F=[];this.C={};this.ld=a;this.B=new DP}function t9b(a,b,c,d,e){function g(a){return a.toLowerCase()}Mb(b);Mb(c,void 0,g);Mb(d,void 0,g);Mb(e,void 0,g);a.F=b;A(c,a.D,a);A(d,a.D,a);A(e,a.D,a)}s9b.prototype.D=function(a){for(var b=a.toLocaleLowerCase(),c=0;c<b.length;++c)if(0==c||/[^a-zA-Z0-9]/.test(b[c-1])&&!/[^a-zA-Z0-9]/.test(b[c])){var d=a,e=b.substr(c),g=this.B.get(e);g||(g=[],this.B.add(e,g));g.push(d)}};
s9b.prototype.JF=function(a,b,c){var d;if(Ta(a||"")){d=this.ld.Ll();d=u9b(this,a.substring(0,d));var e=v9b(this,b-d.length,a);d=Ib(d,e)}else d=v9b(this,b);d.length>b&&(d=Lb(d,0,b));c(a,d)};function v9b(a,b,c){var d=c||"";c=Zb(a.C,function(a){return Ka(a,d)});var e=w9b(ec(c),d?1:2,1);a=rb(a.F,function(a){return Ka(a,d)&&!e[a.toLowerCase()]});b=w9b(a,b-dc(e),2);return Ib(ec(b),ec(e))}
function u9b(a,b){for(var c=[],d=3,e={},g=b.toLowerCase(),h=0;h<g.length&&0<d;++h)if(0==h||" "==g[h-1]&&" "!=g[h]){var k={},l=0,m=g.substr(h),p=a.B.xe(m);A(p,function(a){var b=a.length-m.length;l=Math.max(b,l);a=this.B.get(a);k[b]||(k[b]=[]);Kb(k[b],a)},a);for(p=0;p<=l&&0<d;++p){var r=k[p];if(r)for(var t=0;t<r.length&&0<d;++t){var w=r[t];$a(b.toLowerCase(),w.toLowerCase())||e[w]||(--d,c.push({text:w,Fy:0,aAa:g.length-h}),e[w]=!0)}}}return c}
function w9b(a,b,c){b=FW(a.length,Math.min(a.length,b));var d={};A(b,function(b){d[a[b].toLowerCase()]={text:a[b],Fy:c,aAa:0}});return d};function IW(){DF.call(this,"",null,!1)}z(IW,DF);IW.prototype.vB=function(a,b){if(2==a.Fy||1==a.Fy)return IW.V.vB.call(this,a.text,b);var c=this.Ha(),d=this.Ll(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var g=c.substring(0,d-a.aAa)+a.text;e||(g+=" ");a=IW.V.vB.call(this,{toString:function(){return g+c.substring(d)}},b);this.z_(g.length);b=this.yj;b.blur();b.focus();return a};
IW.prototype.Rg=function(a){var b=IW.V.Rg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.B,nVa(b)&&b.qE()&&a.preventDefault(),b=!0);return b};function x9b(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(uu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(uu({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(uu({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function y9b(a){this.B=a||rm()}y9b.prototype.KK=function(a,b,c){b=ur(x9b);var d=fn(this.B,"waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.B.Jf(d,a.text);var d=fn(this.B,"waffle-assistant-answers-ac-entity-icon",b),e=fn(this.B,"waffle-assistant-answers-ac-suggested-query-icon",b),g=fn(this.B,"waffle-assistant-answers-ac-session-query-icon",b);S(d,0==a.Fy);S(e,2==a.Fy);S(g,1==a.Fy);this.B.appendChild(c,b)};function JW(a,b,c,d,e,g,h,k){ZV.call(this,k);this.Pe=c;this.Xf=d;this.cj=e;this.$g=a;this.Ic=h;this.Ba=this.O=this.Y=this.D=this.gb=null;this.ld=new IW;this.ld.OEa=!0;this.ld.Z=!0;this.Sa=new s9b(this.ld);a=new AF(null,new y9b(k));this.L=new vF(this.Sa,a,this.ld);H(this,this.L);this.F=g;this.Z=null;this.Ai=new Cjb(b,!0,!0);this.Xa=!1;this.Zc=Do(new Co,10).Fa();this.hk=new Ei;this.La={};this.Ja={};this.U=this.B=this.yb=null;this.bc=[];this.Lb=[];this.Df=KJ.getInstance();this.bb=""}z(JW,ZV);q=JW.prototype;
q.Qa=function(){JW.V.Qa.call(this);var a=this.L.Oe();a.className="waffle-assistant-answers-ac-renderer";a.Zi="waffle-assistant-answers-ac-row";a.Gs="waffle-assistant-answers-ac-active";a.wH="waffle-assistant-answers-ac-highlighted"};q.Da=function(){JW.V.Da.call(this);this.ld.B=this.L;this.L.j3=!1;this.L.B9=6;this.getHandler().R(this.L,"update",this.Ygb);this.gL(null==this.Z)};
q.Hpa=function(a,b){JW.V.Hpa.call(this,a,b);b=this.ea;var c=this.X;b.appendChild(a,ur(l9b));this.U=fn(b,"waffle-assistant-answers-query-box",a);this.D=new Rs("",new pW,this.ea);c.Ka(this.D);this.D.Ua(fn(b,"waffle-assistant-answers-clear-query-button",this.U));this.Ba=new OV(!1,"#4285f4");c.Ka(this.Ba);this.yb=fn(b,"waffle-assistant-answers-spinner-container",this.U);this.Ba.render(this.yb);this.B=fn(b,"waffle-assistant-answers-input-box",this.U);BVa(this.ld,this.B);YV(this.D.getElement(),"Clear query");
c.getHandler().R(this.U,"submit",y(this.syb,this)).R(this.U,"focus",y(this.XDa,this,!0),!0).R(this.U,"blur",y(this.XDa,this,!1),!0).R(this.D,"action",y(this.z2a,this)).R(this.B,"input",y(this.vPb,this)).R(this.B,"focus",y(this.cLb,this));this.D.setVisible(!1)};q.u4=function(){DVa(this.ld,this.B);this.D.setVisible(!1);this.Ba.dispose();this.Ba=null;JW.V.u4.call(this)};q.gL=function(a){JW.V.gL.call(this,a);this.B&&(a?this.B.setAttribute("disabled",!0):this.B.removeAttribute("disabled"))};q.Ah=da("gb");
function z9b(a,b,c){var d=sb(q9b(a.$g),function(a){return a.query}),e=sb(Bc(c,1),function(a){return a.getName()}),g=[],h=[];A(Bc(c,2),function(a){g.push(a.getName());h=h.concat(Bc(a,2))});t9b(a.Sa,d,e,g,h);a.Z=b;a.gL(null==b)}q.reset=function(){sU(this.La);sU(this.Ja);sU(this.Sa.C);this.O=this.Y=null};
function A9b(a){if(a.mc()&&(B9b(a),null!=a.Z))for(var b=Iz(a.Pe),c=b.jd(),c=sb(ec(Pg),c.K0,c),c=sb(c,Ca(oh,a.Z.rect)),d=0;d<c.length;d++)if(c[d]&&Ah(c[d])){var e=TT(b,c[d],"waffle-assistant-answers-styled-rect");H(a,e);PF(HI(b),e,!0);e.setVisible(!0);a.bc.push(e);e=nI(b,c[d],"waffle-assistant-answers-styled-border",1,0);H(a,e);e.setVisible(!0);a.Lb.push(e)}}function B9b(a){Fc(a.bc);Fc(a.Lb);a.bc=[];a.Lb=[]}
q.Ygb=function(a){a.row&&(a=a.row,2==a.Fy?this.F.Pb(2652,this.Zc):0==a.Fy&&(this.Xa=!0,this.F.Pb(2651,this.Zc)),2!=a.Fy&&1!=a.Fy||C9b(this,!0))};q.XDa=function(a){mp(this.U,"waffle-assistant-answers-query-box-focused",a)};q.vPb=function(){this.D.setVisible(!!K7b(this.B))};q.cLb=function(){var a=Qa(K7b(this.B));this.ld.z_(a.length);kVa(this.L,a||"  ");this.L.update(!0)};
function C9b(a,b,c){var d=Ta(K7b(a.B));if(!a.gb||3<=a.gb.getStatus().getState().B)d=new yW(d,null,null,"Looks like you are offline. Try again when you reconnect."),D9b(a,d,!1);else{if(d&&a.Z)if(a.La[d])a.F.Pb(2681,a.Zc),c=a.La[d],1<a.C.length&&E9b(a),(b=a.Ja[d])&&F9b(a,b),U7b(a,c);else{var e=G9b(),g=Wi(Wi(e,XT,46),VV,4);P(g,2,a.Xa);a.F.Pb(2635,new Bo(10,e));a.Xa=!1;e=rw(a.Z.rect);b=Nk(lj(mj(a.gb.Bf("/answers/parse").Gf("q",d,"gid",a.Z.xd,"range",e),y(a.Oj,a,d,!!b)),y(a.PUb,a,d,!!b)),"POST");c&&b.Gf("sgfml",
c);b.Te();a.bb=LJ(a.Df,dj.tta);H9b(a,!0)}else WV(a.B,"");a.B.blur();a.D.setVisible(!!d);xF(a.L)&&a.L.Bj()}}q.syb=function(a){a.stopPropagation();a.preventDefault();C9b(this)};q.z2a=function(){WV(this.B,"");this.D.setVisible(!1)};q.dob=function(a){WV(this.B,a.B);this.B.focus();C9b(this,!0)};
q.PUb=function(a,b){H9b(this,!1);a=new yW(a,null,null,"There was a problem getting your answer. Please try again.");D9b(this,a,!1);a=G9b();var c=Wi(Wi(a,XT,46),VV,4);P(c,1,b?M7b.Wxa:M7b.uya);this.F.Pb(2640,new Bo(10,a))};
q.Oj=function(a,b,c){var d=null,e=null,g=!1,h=G9b(),k=Wi(Wi(h,XT,46),VV,4);P(k,1,b?M7b.Wxa:M7b.uya);b=new Bo(10,h);if(c.yl()){e=this.hk.od(dW.Aa(),c.Nf());if(g=e.getStatus()){var l;switch(g){case 1:l=2639;break;case 2:l=2643;break;case 3:l=2644;break;case 4:l=2638;break;case 5:l=2707;break;case 6:l=2706}l&&this.F.Pb(l,b)}if(g&&2==g){-1!=I9b(a)?this.Y||(E9b(this),this.Y=new HW(this.$g,this.F,this.ea),F9b(this,this.Y),J9b(this),this.getHandler().R(this.Y,"sqc",this.dob).R(this.Y,"rc",this.UJa)):(a=
new yW(a,null,null,"Sorry, couldn't understand your question."),D9b(this,a,!0));H9b(this,!1);return}l=e.hasFormula()?C(e,2):null;c=wc(e,9)?e.getError().rl():null;g=!0;l?(d=Vv(this.Xf),d=null!=d?d.toString():"0",(d=H7b(this.Ai,l,d))||this.F.Pb(2645,b),d=new yW(a,d,e,null)):c&&(d=new yW(a,null,e||null,c))}else this.F.Pb(2640,b);d||(d=new yW(a,null,e||null,"Sorry, couldn't understand your question."));H9b(this,!1);D9b(this,d,g)};
function G9b(){var a=new VV,b=new XT;Yi(b,4,a);a=new Qn;Yi(a,46,b);return a}function I9b(a){return xb(h9b,function(b){return Ka(a,b)})}function D9b(a,b,c){E9b(a);K9b(a,b);c=new BW(b,a.Pe,a.Xf,a.cj,a.F,a.Ic,c,a.ea);F9b(a,c);J9b(a);if(zW(b)){var d=a.Sa,e=b.B;d.C[e.toLowerCase()]||(d.C[e.toLowerCase()]=e)}c.Ba&&(a.La[b.B]=c);a.getHandler().R(c,"rc",a.UJa);""!=a.bb&&(MJ(a.Df,a.bb),a.bb="")}
function E9b(a){var b=ob(a.C);b&&(b instanceof BW?(b=a.Ja[b.B.B])&&a.sB(b):(a.sB(b),a.Y=null));0!=a.C.length&&(a.O?U7b(a,a.O):(a.O=new r9b(a.ea),F9b(a,a.O)))}function K9b(a,b){var c=b.C;if(0<c.length){var c=Lb(c,0,4),d=new EW(b.B,!!b.$z,c,a.ea);F9b(a,d);sb(c,function(a){return a.getType()});a.F.Pb(2769,a.Zc);a.getHandler().R(d,"sqc",y(a.$jb,a,b));a.Ja[b.B]=d}}q.$jb=function(a,b){WV(this.B,b.B);this.B.focus();a=a.C[b.D];C9b(this,!0,C(a,2));a.getType();this.F.Pb(2762,this.Zc)};
function H9b(a,b){S(a.yb,b);S(fn(a.ea,"waffle-assistant-answers-button-container",a.U),!b);a.Ba&&a.Ba.setActive(b)}function F9b(a,b){b.rG(a.Hd());a.C.push(b);a.Yc&&(a.J.gi(b,0,!0),b.WN());$V(b,!0)}function J9b(a){for(var b=a.C;5<b.length;)a.sB(b[0])}q.D3=function(){JW.V.D3.call(this);this.reset()};
q.UJa=function(a){var b=this.ea;a=a.target;a instanceof BW?(this.sB(a),k9b(this.Ic,"Answer removed",b,y(this.ovb,this,a))):a instanceof HW&&(this.sB(a),this.Y=null,k9b(this.Ic,"Card removed",b));b=this.C;!this.O||b[0]!=this.O&&b[b.length-1]!=this.O||(this.sB(this.O),this.O=null)};q.ovb=function(a){D9b(this,a.B,a.Ba)};q.sB=function(a){if(a.mc()&&(JW.V.sB.call(this,a),a instanceof BW)){var b=a.B.B,c=this.Ja[b];c&&(JW.V.sB.call(this,c),delete this.Ja[b]);delete this.La[b]}I(a)};function L9b(){var a;a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">Dogfooders, we\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(uu({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+Ur("Ask a question about your data")+'" /></div></form></div>');return V(a)};function KW(a,b,c){DW.call(this,b,c);this.B=a}z(KW,DW);KW.prototype.L0=If;KW.prototype.qX=function(){var a=q9b(this.B),b=FW(a.length,Math.min(a.length,3)),c=[];A(b,function(b){c.push(a[b])});return sb(c,function(a){return a.query})};KW.prototype.Nw=function(){fp(this.va,"Suggested questions")};function M9b(a){this.B=a;for(var b=[],c=0;c<xc(a,2);c++)50>a.Zd(c).getName().length&&b.push(c);this.C=b;b=[];for(c=0;c<xc(a,1);c++)50>jW(a,c).getName().length&&b.push(c);this.D=b;b=[];for(c=0;c<xc(a,1);c++){for(var d=jW(a,c).getName(),e=!0,g=0;g<N9b.length;g++)if(-1!=d.search(new RegExp("(\\b|_)"+N9b[g]+"(\\b|_)","i"))){e=!1;break}e&&b.push(c)}this.L=b;this.J=O9b(a,0);O9b(a,1);b=[];for(c=0;c<xc(a,2);c++).8<=C(a.Zd(c),6)&&b.push(c);this.F=b}
function O9b(a,b){for(var c=[],d=0;d<xc(a,2);d++)a.Zd(d).getType()==b&&c.push(d);return c}function P9b(a,b,c){return b||c?(b=b?a.J:null,c&&(b=null==b?a.F:Q9b(b,a.F)),b=R9b(b,a.C),0<b.length?b[GW(b.length)]:-1):0<a.C.length?a.C[GW(a.C.length)]:GW(xc(a.B,2))}function LW(a,b){return b?(a=R9b(a.L,a.D),0<a.length?a[GW(a.length)]:-1):0<a.D.length?a.D[GW(a.D.length)]:GW(xc(a.B,1))}function S9b(a){var b=Bc(a.B,3),b=Q9b(b,a.J),b=Q9b(b,a.F);a=R9b(b,a.C);return 0<a.length?a[GW(a.length)]:-1}
function T9b(a,b){for(var c=5;;){var d=a.B.Zd(b),e=GW(xc(d,2));c--;if(50>=C(d,2,e).length||0==c)return e}}function U9b(a){for(var b=FW(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}function Q9b(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}function R9b(a,b){b=Q9b(a,b);return 0<b.length?b:a}var N9b=["average","total","sum","mean","median"];function V9b(){this.C=[];this.B=!1}V9b.prototype.reset=function(){this.C=[];this.B=!1};function q9b(a){if(!a.B)throw Error("Suggestions not generated. Must call generate() at the top level");return a.C}function MW(a,b,c){a.push({query:b,$z:void 0,type:c})}var W9b="Minimum Maximum Most Least Highest Lowest".split(" "),X9b=["Average","Total","Sum","Mean"];function NW(a,b,c,d,e,g,h){aW.call(this,1,g,e,h);this.Wa=c;this.Z=null;this.Y=new Rs("",new oW,this.ea);this.Ka(this.Y);this.X=new Rs("",new oW,this.ea);this.Ka(this.X);this.O=new V9b;this.B=new JW(this.O,a,b,c,d,e,this.Xa,h);this.D=this.Ba=null;this.Zc=Do(new Co,10).Fa()}z(NW,aW);q=NW.prototype;q.Qa=function(){NW.V.Qa.call(this);var a=ur(L9b);this.ea.appendChild(W7b(this),a)};
q.Da=function(){NW.V.Da.call(this);var a=T(this,"waffle-assistant-answers-query-box"),b=T(this,"waffle-assistant-answers-input-box");this.X.Ua(T(this,"waffle-assistant-answers-logging-opt-out"));this.Y.Ua(T(this,"waffle-assistant-answers-learn-more"));this.getHandler().R(a,"focus",this.Bub,!0).R(a,"blur",this.zub,!0).R(a,"mouseover",this.Dub).R(a,"mouseout",this.Cub).R(a,"click",this.Aub).R(b,"input",this.QUb).R(this.X,"action",this.Zsb).R(this.Y,"action",this.RUb).R(Zv(this.Wa),"Ib",O7b(this.SUb,
25,this));this.setVisible(null!=this.Ba);Y9b(this,Wna&&em("showAnswersLoggingOptOut"))};q.$Ra=Gf;q.OKa=Hf;q.XRa=Gf;q.M0=n("Answers");q.r3=function(a){return 3==a};
q.Usa=function(a,b){if(a.getConfidence()){var c=b||null,d=C(a,9)||new iW;this.Ba=c;var e=this.O,g=[],h=new M9b(d),k=h.B,l=P9b(h,!0,!0);if(0<xc(k,1)&&-1!=l){var m=jW(k,LW(h)),k=k.Zd(l);k.getName()!=m.getName()&&MW(g,"Top "+k.getName()+" by "+m.getName(),0)}k=h.B;1<xc(k,1)&&(l=2<=h.D.length?U9b(h.D):FW(xc(h.B,1),2),m=jW(k,l[0]),k=jW(k,l[1]),m.getName()!=k.getName()&&MW(g,"Correlation between "+m.getName()+" and "+k.getName(),1));m=h.B;k=LW(h,!0);-1!=k&&MW(g,X9b[GW(X9b.length)]+" of "+jW(m,k).getName(),
2);l=h.B;m=LW(h,!0);if(0<xc(l,3)&&-1!=m&&(m=jW(l,m),k=S9b(h),-1!=k&&(l=l.Zd(k),0<xc(l,3)&&l.getName()!=m.getName()))){a:for(var p=5;;){var r=h.B.Zd(k),t=GW(xc(r,3)),w=C(r,3,t);p--;if(50>=C(r,2,t).length||0==p){k=w;break a}}MW(g,X9b[GW(X9b.length)]+" of "+m.getName()+" when "+l.getName()+" is "+C(l,2,k),4)}k=h.B;l=P9b(h,!0,!0);0<xc(k,1)&&-1!=l&&(m=jW(k,LW(h)),k=k.Zd(l),k.getName()!=m.getName()&&MW(g,k.getName()+" with "+W9b[GW(W9b.length)]+" "+m.getName(),8));m=h.B;0<xc(m,1)&&(m=jW(m,LW(h)),MW(g,W9b[GW(W9b.length)]+
" "+m.getName(),9));m=h.B;0<xc(m,3)&&(k=S9b(h),-1!=k&&(m=m.Zd(k),0<xc(m,3)&&MW(g,"Most frequent "+m.getName(),10)));if((m=3>g.length)||0==GW(5))p=h.B,0<xc(p,1)&&0<xc(p,2)&&(k=jW(p,LW(h)),l=P9b(h),p=p.Zd(l),0<xc(p,2)&&p.getName()!=k.getName()&&(l=T9b(h,l),MW(g,"Show "+k.getName()+" for "+p.getName()+" "+C(p,2,l),6)));if(m||0==GW(5))k=h.B,l=P9b(h,!0,!0),1<xc(k,2)&&-1!=l&&(m=2<=h.C.length?U9b(h.C):FW(xc(h.B,2),2),p=m[0]==l?m[1]:m[0],m=k.Zd(p),k=k.Zd(l),0<xc(m,2)&&m.getName()!=k.getName()&&(h=T9b(h,p),
MW(g,"What is "+k.getName()+" for "+m.getName()+" "+C(m,2,h),7)));h=Math.random;for(m=g.length-1;0<m;m--)k=Math.floor(h()*(m+1)),l=g[m],g[m]=g[k],g[k]=l;e.C=g;e.B=!0;this.setVisible(null!=c);z9b(this.B,c,d);this.Hb()&&A9b(this.B);this.D||(NW.V.Usa.call(this,a,b),this.getHandler().R(this.D,"sqc",this.uyb))}else this.Xba(!0)};q.IV=function(a){this.D||(this.D=new KW(this.O,a,this.ea));return this.D};q.$Aa=f("B");q.$la=function(){return this.Ra()};
q.Xba=function(a,b,c){if(a||u(b)&&!b)this.D&&NW.V.Xba.call(this,a,b,c),this.mc()&&(this.O.reset(),this.Ba=null,a=this.B,a.mc()&&(b=a.Sa,b.F=[],b.B.clear(),a.B&&WV(a.B),a.D3(),a.Z=null,a.gL(!0),a.D&&!a.D.isDisposed()&&a.D.setVisible(!1),a.Xa=!1),this.D&&(this.D.dispose(),this.D=null),this.setVisible(!1),this.Hb()&&B9b(this.B));c&&this.B.reset()};q.Ah=function(a){this.Z=a;this.B.Ah(a)};q.setActive=function(a){NW.V.setActive.call(this,a);a?A9b(this.B):B9b(this.B)};
function Y9b(a,b){S(T(a,"waffle-assistant-answers-logging-message-container"),b)}function Z9b(a,b){a=T(a,"waffle-assistant-answers-query-box");mp(a,"waffle-assistant-answers-query-box-focused",b)}q.SUb=function(){this.Hb()&&A9b(this.B)};q.Bub=function(){Z9b(this,!0);A9b(this.B)};q.zub=function(){Z9b(this,!1);this.Hb()||B9b(this.B)};q.Dub=function(){A9b(this.B)};q.Cub=function(){this.Hb()||B9b(this.B)};q.Aub=function(){$9b(this,"")};
q.QUb=function(){var a=T(this,"waffle-assistant-answers-input-box");$9b(this,a.value);a.value=""};q.uyb=function(a){$9b(this,a.B);Rk(function(){C9b(this.B,!0)},150,this);this.J.Pb(2652,this.Zc)};function $9b(a,b){a.setActive(!0);a.dispatchEvent("assistant-sidepane-set-active-panel");Rk(function(){var a=this.B;WV(a.B,b);a.B.focus()},150,a)}
q.Zsb=function(a){a.stopPropagation();a.preventDefault();this.Z&&(Nk(lj(mj(this.Z.Bf("/answers/logoptout"),y(this.yqb,this)),y(this.xqb,this)),"POST").Te(),this.J.Pb(2663,this.Zc))};q.RUb=function(a){a.stopPropagation();a.preventDefault();Fo("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};q.yqb=function(a){a.yl()&&Y9b(this,!1)};q.xqb=ca();q.Yba=n(1);function a$b(){var a;a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+b$b()+"</div>");return V(a)}
function c$b(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+b$b()+"</div>")}function b$b(){var a;a=""+U(Xs({Qe:"waffle-assistant-formatting-edit-button",content:Qr("Edit"),style:4}));return V(a)};function OW(a,b,c){rW.call(this,a,c);a=sb(this.C.Oea(),h4b);this.B=new EU(!1,a,7);this.Ka(this.B);this.F=new Ys("",this.ea);this.Ka(this.F);this.J=b}z(OW,rW);var d$b={rca:"waffle-assistant-banding-color-picker-container",Cca:"waffle-assistant-formatting-edit-button",hH:"waffle-assistant-banding-range"};q=OW.prototype;q.Qa=function(){OW.V.Qa.call(this);sW(this).appendChild(ur(a$b))};
q.Da=function(){OW.V.Da.call(this);this.getHandler().R(this.F,"action",this.Ylb).R(this.B,"banding-scheme-changed",this.nhb);this.J.Pb(2768,void 0)};
q.ZB=function(a){var b=T(this,d$b.rca);this.B.render(b);n4b(this.B);var c=T(this,d$b.hH),b=this.C.l6(),d=Jh(b);Vm(c,rw(d));c=b.cb();b=Jh(b);b=ritz.getWorkbookRangeIntersectingIds(c,b.fc(),b.Ub(),b.Rc(),b.cd(),7,!1);b.length?(b=ritz.getBandedRangeByWorkbookRangeId(b[0]),b=(new Ei).od(zd.Aa(),b),b=h4b(b)):b=null;b&&(b=p4b(this.B,b),vL(this.B,b?b.getElement():null));b=T(this,d$b.Cca);this.F.Ua(b);a()};q.Nw=function(){fp(this.va,"Suggested alternating background colors");WT(this.B,"Choose a color scheme")};
q.dA=n("assistantBandingFeedback");q.tJ=n(2672);q.sJ=n(2671);q.Ylb=function(a){Bn.dispatchEvent({type:"show-banding-pane-recommendation",ZPa:this.C,u3a:o4b(this.B)});a.stopPropagation()};q.nhb=function(a){FU(this.B)&&(this.dispatchEvent(new XV("assistant-sidepane-apply-banding",this,2673)),a.stopPropagation())};function PW(a,b){rW.call(this,a,b);this.B=new Ys("",this.ea);this.Ka(this.B);this.Wa=Bc(a,6)}z(PW,rW);var QW={Cca:"waffle-assistant-formatting-edit-button",EXa:"waffle-assistant-conditionalformat-format-preview",IZa:"waffle-assistant-conditionalformat-rule-holder",g1:"waffle-assistant-conditionalformat-description",OYa:"one-rule",G_a:"two-rules",v_a:"three-rules",gZa:"waffle-assistant-conditionalformat-format-preview-label"};q=PW.prototype;q.Qa=function(){PW.V.Qa.call(this);sW(this).appendChild(ur(c$b))};
q.Da=function(){PW.V.Da.call(this);var a=T(this,QW.Cca);this.B.Ua(a);YV(a,"Apply and edit conditional format rules");this.getHandler().R(this.B,"action",this.Ngb)};q.ZB=function(a){Vm(T(this,QW.g1),Cc(this.C,3));var b=T(this,QW.IZa),c=new e$b(this,this.ea);this.Ka(c);c.Ua(b);YV(b,"Apply conditional format rules");a()};q.Nw=na;q.dA=n("assistantConditionalFormatFeedback");q.tJ=n(2630);q.sJ=n(2629);
q.Ngb=function(){f$b(this);this.dispatchEvent(new XV("assistant-sidepane-change-selection",this,2670,void 0,void 0,Jh(C(this.Wa[0],1,0))));Fn()};function f$b(a){a.dispatchEvent(new XV("assistant-sidepane-apply-conditional-format-rules",a,2563))}function e$b(a,b){Sq.call(this,void 0,void 0,b);this.B=a}z(e$b,Sq);
e$b.prototype.Fe=function(a){e$b.V.Fe.call(this,a);var b=this.B.Wa,c;switch(b.length){case 0:break;case 1:c=QW.OYa;break;case 2:case 4:c=QW.G_a;break;default:c=QW.v_a}for(var d=0;d<b.length;d++){var e=b[d],g=Cm("DIV");jp(g,[QW.EXa,c]);var h=Cm("DIV");ip(h,QW.gZa);g.appendChild(h);Vm(h,"123");if(wc(e,2)){var k=C(C(e,2),1);switch(C(C(k,1),1)){case 9:case 13:var k=Bc(C(k,1),2)[0],l=Bc(e,1)[0];Vm(h,uF(k,Cc(l,1),Cc(l,2),Cc(l,4)))}}z3b(e,g);a.appendChild(g)}};e$b.prototype.gj=function(){f$b(this.B);return!0};function g$b(a,b,c){aW.call(this,2,b,a,c)}z(g$b,aW);q=g$b.prototype;q.M0=n("Formatting");q.r3=function(a){return 2==a||4==a};q.IV=function(a){var b=C(a,1);switch(b){case 2:return new PW(a,this.ea);case 4:return new OW(a,this.J,this.ea);default:throw Error("Unsupported recommendation type: "+b);}};q.N0=function(a){g$b.V.N0.call(this,a);this.setVisible(!a)};q.Vsa=function(a){return this.Hd()?(this.setVisible(!1),a):g$b.V.Vsa.call(this,a)};q.Yba=n(3);function RW(a,b,c,d){Au.call(this,a,b,c,d)}z(RW,Au);RW.prototype.Qa=function(){RW.V.Qa.call(this);ip(this.va,"waffle-assistant-toast");ip(T(this,"docs-ui-toast-content"),"waffle-assistant-toast-content")};RW.prototype.DH=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=iq(this,b);RW.V.DH.call(this,a,b,c)};RW.prototype.Vl=function(a,b,c,d){this.DH(a,b,d);a=kq(this,b);Ef(this.getHandler(),a,hd,y(function(){this.setVisible(!1);c()},this))};function h$b(){this.B=null}z(h$b,G);function k9b(a,b,c,d){a.B&&(a.B.dispose(),a.B=null);a.B=new RW(b,c,!1,5E3);a.B.render();d&&a.B.Vl("Undo","w-a-u-tm-u",d,void 0);a.B.setVisible(!0)}h$b.prototype.$=function(){h$b.V.$.call(this);this.B&&(this.B.dispose(),this.B=null)};function i$b(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+Ur("Press enter to insert formula")+'"></span></div>');return V(a)};function SW(a,b){dq.call(this);this.B=a;this.C=b}z(SW,dq);q=SW.prototype;q.Qa=function(){this.va=ur(i$b,{name:this.B,title:this.C})};q.Da=function(){SW.V.Da.call(this);var a=T(this,"waffle-assistant-quicksum-entry-name");YV(a);this.getHandler().R(this.va,"keypress",this.BUb);S(this.va,!1)};q.getFunctionName=f("B");q.Ta=function(a){Vm(T(this,"waffle-assistant-quicksum-entry-value"),a||"");S(this.va,!!a)};q.Ra=function(){return Np(this.va)};
q.BUb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new J("insert",this)))};function TW(a,b,c,d,e){dq.call(this,e);this.Ja=a;this.Z=b;this.O=c;this.J=d;this.C=a.B;this.Ba=new Ei;this.X=Do(new Co,17).Fa();this.U=Do(new Co,2).Fa();this.L=!1;this.D=[];this.B=null;this.F=[]}z(TW,dq);
TW.prototype.Da=function(){TW.V.Da.call(this);this.gi(new SW(ritz.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.gi(new SW(ritz.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.gi(new SW(ritz.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.gi(new SW(ritz.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.gi(new SW(ritz.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.B=new AW(this.va,this.Z,this.C,this.O);this.B.F=this.L;H(this,this.B);this.getHandler().R(this,"insert",
this.Y).R(this.B,"formula_inserted",this.La)};
function j$b(a){function b(a){return l?ritz.renderNumberAsFormattedString(a,m):null}if($v(a.C)){var c=aw(a.C),d=eC(c),e=hJ(a.C);if(vb(d,c.Ft,c)){var g=[];a.D=[];for(c=0;c<d.length;c++){var h=d[c],k=Wga(e+"",h.fc(),h.Ub(),h.Rc(),h.cd());g.push(a.Ba.serialize(k));a.D.push(h)}if(d=ritz.quickSum(g)){S(a.va,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.vd(0).Ta(b(d.sum));a.vd(1).Ta(b(d.average));a.vd(2).Ta(b(d.min));a.vd(3).Ta(b(d.max));1<e?a.vd(4).Ta(ritz.renderNumberAsFormattedString(e,
c)):S(a.va,!1);if(a.B){a.B.L=[];a.F=[];for(c=0;c<a.kd();++c)d=a.vd(c),a.F.push(k$b(a,d.getFunctionName()));a.B.L=a.F}}else S(a.va,!1)}else S(a.va,!1)}else S(a.va,!1)}TW.prototype.Y=function(a){var b=a.target;a=this.D[0];a=new N(a.left,a.Rc());b=b.getFunctionName();b=k$b(this,b);a=new TE(aw(this.C),a,b);this.O.B(a);this.J.Pb(2624,this.U)};TW.prototype.La=function(){this.J.Pb(2624,this.X)};function k$b(a,b){var c=yw(a.Ja.X);a=sb(a.D,function(a){return rw(a)});return"="+b+"("+a.join(c)+")"};function l$b(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(Xs({content:Qr("INSERT CHART"),style:4,Qe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(Xs({Qe:"waffle-autovis-lightbox-close",content:Rr(""+U(uu({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Qr("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">\x3c!-- TODO(cuiffo): Replace with real icons --\x3e'+
U(Xs({content:Rr("&#10094;"),style:4,Qe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Sr('aria-label="'+Ur("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(Xs({content:Rr("&#10095;"),style:4,Qe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Sr('aria-label="'+Ur("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.PEb)+"</div></div></div>");return V(a)}function m$b(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function UW(a,b,c){dq.call(this,c);this.D=a;this.C=b;this.F=[];this.B=new Ys("",this.ea);this.Ka(this.B);this.O=new Ys("",this.ea);this.Ka(this.O);this.L=new Ys("",this.ea);this.Ka(this.L);this.J=new Ys("",this.ea);this.Ka(this.J)}z(UW,dq);q=UW.prototype;q.Qa=function(){UW.V.Qa.call(this);this.va=ur(l$b,{PEb:this.D.length})};
q.Da=function(){UW.V.Da.call(this);var a=X.yG.isEnabled();n$b(this,!a);a=T(this,"waffle-autovis-lightbox-close");this.B.Ua(a);a=T(this,"waffle-autovis-lightbox-insert");this.O.Ua(a);var b=T(this,"waffle-autovis-lightbox-previous");this.L.Ua(b);b=T(this,"waffle-autovis-lightbox-next");this.J.Ua(b);o$b(this);p$b(this,this.C,!1);this.getHandler().R(document.body,Yc,this.SPb).R(this.va,"keydown",this.TPb).R(Bm(),"resize",this.WPb).R(this.B,"action",this.close).R(this.O,"action",this.epb).R(this.L,"action",
this.VPb).R(this.J,"action",this.UPb);b=new fv(this.va,this.ea);gv(b);H(this,b);a.focus()};function o$b(a){var b=T(a,"waffle-autovis-lightbox-content"),c=T(a,"waffle-autovis-lightbox-content-inner");a=T(a,"waffle-autovis-lightbox-page-count");var d=zm();a=Kp(a);var e=d.height-a.height-195,g=d.width-200;.75<e/g?(d=g,e=.75*g):d=e/.75;Hp(c,d,e);Hp(b,d,e+a.height+35)}function n$b(a,b){mp(a.va,"waffle-autovis-lightbox-readonly",b)}
function p$b(a,b,c){c&&En("Page "+(b+1+(" of "+(a.D.length+"."))));a.F[b]?q$b(a,b):a.D[b]&&M8b(a.D[b],y(a.Bib,a,b),!0)}q.Bib=function(a,b){if(!this.isDisposed()&&b){var c=T(this,"waffle-autovis-lightbox-container"),d=ur(m$b);c.appendChild(d);this.F[a]=d;LV(b,d,boa);q$b(this,a)}};function q$b(a,b){S(a.F[a.C],!1);S(a.F[b],!0);a.L.Ma(0!=b);a.J.Ma(b!=a.D.length-1);var c=T(a,"waffle-autovis-lightbox-page-number");Vm(c,b+1);a.C=b}q.SPb=function(a){!Sm(this.va,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
q.TPb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.C&&p$b(this,this.C-1,!0):39!=a.keyCode&&40!=a.keyCode||r$b(this);a.stopPropagation()};q.WPb=function(){var a=T(this,"waffle-autovis-lightbox-container");Im(a);this.F=[];o$b(this);p$b(this,this.C,!0)};q.epb=function(){this.close();P8b(this.D[this.C],2256)};q.VPb=function(){0!=this.C&&p$b(this,this.C-1,!0);0==this.C&&this.J.va.focus()};q.UPb=function(){r$b(this);this.C==this.D.length-1&&this.L.va.focus()};
function r$b(a){a.C!=a.D.length-1&&p$b(a,a.C+1,!0)}q.close=function(){this.dispose()};q.Uc=function(){UW.V.Uc.call(this);var a=this.D[this.C];a&&a.va&&a.va.focus()};function s$b(a){L.call(this);this.jc=a;this.F=a.B;this.Oa=new Ei;this.Ea=Kj();this.J=Kj();this.Sa=this.B=this.D=this.C=this.L=this.Y=null;this.La=!1;this.X=null;this.wb=!0;this.Ia=this.Ba=!1;this.Ja=this.Ya=null;this.O=KJ.getInstance();this.Z=this.oa="";this.U=new nW;E(this.U,1,Tl);E(this.U,2,Ena);a=goa&&!a.Hd();E(this.U,3,a);E(this.U,4,$na);E(this.U,5,Vna);E(this.U,6,coa);E(this.U,7,hoa)}z(s$b,L);var t$b={a_b:"cu",SVa:"cs",RVa:"ce",rYa:"ls",qYa:"le"};q=s$b.prototype;
q.update=function(a,b,c){c&&this.B&&!wb(c,function(a){return Qga(a,this.B.rect)},this)||(this.Ea.cancel(!0),a&&(this.Ia=!0,this.J.cancel(!0),this.D=this.C=this.L=this.Y=null),this.Ea=u$b(),this.Ea.addCallback(this.L1a,this),this.Ea.addCallback(Ca(this.M1a,b),this))};q.Ah=da("Ya");function u$b(){var a=null,b=new Dj(function(){null===a||Sk(a)}),a=Rk(function(){b.Ab()});return b}q.Khb=function(){this.Ba=!0};
q.L1a=function(){var a=this.F.getActiveGrid();if(a){var b=aw(this.F),c=eC(b),d=v$b(this,c||[]),e=v$b(this,this.Sa||[]);d&&!e||!d&&!w$b(c,this.Sa)?(this.D=null,this.La=!0):this.La=!1;this.Sa=c;var g=hC(b).clone();A(eC(b),function(a){ph(g,a)});this.X=new Dh(a.cb(),"",g)}else this.X=null};
q.M1a=function(a){this.oa=LJ(this.O,dj.Kua);var b=this.F.getActiveGrid(),c=this.X&&this.X.xd;if(!b||b.cb()!=c||null===c)return this.X=null;var d=this.F.getActiveGrid().C,b=Zz(d,this.X.rect);b.addCallback(function(){if(!this.F.getActiveGrid()||Vv(this.F)!=c)return null;var b=aw(this.F),g=bA(b,this.X.rect,ec(Og),a?void 0:500),h=Vz(b.D,"r"),k=b.Mm("r");return!b.Ft(g)||h>=g.fc()&&BIa(b)||k<=g.Rc()&&AIa(b)?(this.dispatchEvent(new J("ls")),aA(d,g,ec(Og),a?void 0:500).addCallback(this.b4a,this)):g},this);
b.addCallback(function(a){var b=this.F.getActiveGrid();return a&&b&&b.cb()==c&&null!==c?x$b(this,a,aw(this.F)):null},this);b.addCallback(function(b){b=b&&new Dh(c,"",b);if(null===b&&null!==this.B||null!==b&&!b.equals(this.B))this.D=this.C=this.L=this.Y=null;var d=null!==b&&b.equals(this.B),h=this.Ia||this.La||!d&&(null===this.L||null!==this.C&&null===this.D);h&&(this.wb=this.Ba&&this.wb||!this.B||!b||!b.rect.intersects(this.B.rect));this.B=b;""!=this.oa&&(MJ(this.O,this.oa),this.oa="");h&&(a&&(this.Z=
LJ(this.O,dj.Lua)),this.J.cancel(!0),this.J=Kj(),this.J.addCallback(this.T1a,this),this.J.addCallback(this.Z3a,this),a&&(this.J.addCallback(Ca(this.V3a,d),this),this.Ya&&!Tv(this.jc.D)&&doa?this.J.addCallback(this.cdb,this):(this.J.addCallback(this.Q1a,this),this.J.addCallback(this.R1a,this)),this.J.addCallback(this.U3a,this)),Gj(this.J,this.Khb,this))},this);return b};
q.T1a=function(){if(null!==this.B&&null!==this.B.rect&&null===this.Y){var a=LJ(this.O,dj.wta);this.Y=ritz.getAssistantConfidence(""+this.B.xd,this.B.rect.top,this.B.rect.height+this.B.rect.top,this.B.rect.left,this.B.rect.width+this.B.rect.left,this.Oa.serialize(this.U));MJ(this.O,a)}};q.b4a=function(){this.dispatchEvent(new J("le"))};q.Z3a=function(){this.dispatchEvent(new y$b(this.B,this.Y))};q.V3a=function(a){a=new z$b(a,this.Ia);this.Ia=!1;this.dispatchEvent(a)};
q.cdb=function(){if(null===this.B||null===this.B.rect||null!==this.C&&null!==this.D)return null;I(this.Ja);var a=LJ(this.O,dj.Nua),b=A$b(this),c=b&&!b.pMa,b=ritz.getAssistantRequestProto(this.B.xd.toString(),this.B.rect.top,this.B.rect.height+this.B.rect.top,this.B.rect.left,this.B.rect.width+this.B.rect.left,c?b.rows:[],c?b.Ae:[]),b=this.Oa.od(lW.Aa(),b),c=new Ei;c.$u=!0;var b=Qi(c.serialize(b)),d=new Dj;this.Ja=lj(mj(jj(Ula(Nk(this.Ya.Bf("/explore/getrecommendations").Gf("rp",b),"GET")).setTimeout(6E4),
1),function(b){var c=LJ(this.O,dj.Mua);b=B$b(this,b.Nf());MJ(this.O,c);this.C=Bc(b,1);this.D=Bc(b,2);this.Ja=null;MJ(this.O,a);d.Ab()},this),function(){this.C=[];this.D=[];d.Ab()},this).Te();return d};
q.Q1a=function(){function a(){b=null;ritz.continueAssistantRecommendation(this.L)?(this.C=Bc(B$b(this,ritz.getAssistantRecommendations(this.L)),1),d.Ab()):b=Rk(a,5,this)}if(null===this.B||null===this.B.rect||null!==this.L&&null!==this.C)return null;this.L=ritz.newAssistantRecommender(this.Oa.serialize(this.U));this.D=this.C=null;ritz.startAssistantRecommendation(this.L,""+this.B.xd,this.B.rect.top,this.B.rect.height+this.B.rect.top,this.B.rect.left,this.B.rect.width+this.B.rect.left);var b=null,c=
y(function(){null!==b&&(Sk(b),this.D=this.C=this.L=b=null)},this),d=new Dj(c),b=Rk(a,5,this);return d};q.R1a=function(){var a=A$b(this);a&&this.L&&null===this.D&&(this.D=a.pMa?[]:Bc(B$b(this,ritz.getAssistantRecommendationsOnlySelection(this.L,a.rows,a.Ae)),2))};
q.U3a=function(){this.Ba=!1;var a=this.D&&0<this.D.length,b=a?this.D:this.C,b=rb(b||[],function(a){return.4<=a.getConfidence()});b.length=Math.min(b.length,10);0==b.length&&!a&&this.C&&0<this.C.length&&.7<=this.Y&&(b=[this.C[0]]);""!=this.Z&&(MJ(this.O,this.Z),this.Z="");this.dispatchEvent(new C$b(this.B,b,this.wb))};function B$b(a,b){return a.Oa.od(kW.Aa(),b)}
function x$b(a,b,c){b=b.clone();bc(Og,function(a){for(var e=!0;e&&b;){for(var g=Sg(a),h=0;h<(g?b.width:b.height);h++){var k=xh(b,a),l=g?b.Ub():b.fc();if(g&&!KHb(c.uf(k,l+h))||!g&&!KHb(c.uf(l+h,k))){e=!1;break}}e&&(Uga(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function w$b(a,b){return Sb(a,b,function(a,b){return qh(a,b)})}
function A$b(a){var b=a.F.getActiveGrid();if(!b||!a.B||b.cb()!=a.B.xd)return null;for(var c=eC(aw(a.F)),c=sb(c,Ca(oh,a.B.rect)),c=rb(c,qa),d=sb(c,function(a){return new eh(a.left-this.B.rect.left,a.top-this.B.rect.top,a.width,a.height)},a),b=new mg,e=new mg,g=0;g<d.length;g++){for(var h=0;h<d[g].width;h++)e.add(d[g].left+h);for(h=0;h<d[g].height;h++)b.add(d[g].top+h)}a=v$b(a,c);return{rows:b.Fd(),Ae:e.Fd(),pMa:a}}
function v$b(a,b){a.F.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(rh(b)||0==Bh(b))return!0;a=kMa(aw(a.F).U,b.top,b.left);return b.equals(a)}function y$b(a,b){J.call(this,"cu");this.B=a;this.D=b}z(y$b,J);y$b.prototype.getConfidence=f("D");function C$b(a,b,c){J.call(this,"ce");this.B=a;this.D=b;this.U=c}z(C$b,J);function z$b(a,b){J.call(this,"cs");this.B=a;this.D=b}z(z$b,J);function VW(a,b,c,d,e,g){xU.call(this,g);this.Ja=a;this.yb=b.B;this.Ba=c;this.Ic=d;this.J=e;this.U=new TW(b,c,d,e,this.ea);this.Ka(this.U);this.O=new OV(!1,"#4285f4");this.Ka(this.O);this.L=null;this.gb=this.bb=!1;this.Sa=!0;this.La=KJ.getInstance();this.Y=this.X="";this.Zc=Do(new Co,10).Fa()}z(VW,xU);q=VW.prototype;q.Qa=function(){VW.V.Qa.call(this);this.va=ur(this.Xsa());ip(this.va,"waffle-assistant-sidepanel")};q.Xsa=v;
q.Da=function(){VW.V.Da.call(this);var a=T(this,"waffle-assistant-quicksum-panel");this.U.Ua(a);a=T(this,"waffle-assistant-spinner-container");this.O.render(a);this.getHandler().R(this,"close-sidebar",this.Ola).R(this.Ja,t$b.rYa,this.Cla).R(this.Ja,t$b.qYa,this.Bla).R(this.Ja,t$b.SVa,this.ala).R(this.Ja,t$b.RVa,this.$ka).R(T(this,"waffle-assistant-scroll-pane"),"scroll",O7b(this.O0,10,this));a=X.yG.isEnabled();this.Zba(!a)};
q.resize=function(){var a=T(this,"waffle-assistant-sidepane-content"),a=Kp(a).height;if(Ul){var b=T(this,"waffle-assistant-dogfood-message"),c=T(this,"waffle-assistant-scroll-pane"),d=Kp(b).height,b=Up(b),b=b.top+b.bottom;Jp(c,a-d-b);a-=d+b}c=T(this,"waffle-assistant-spinner-container");pp(c,"margin-top",a/2-16+"px")};q.Ah=na;
function D$b(a,b){var c=a.$B();0!=c.length&&(I(a.L),c=c.filter(function(a){return a instanceof tW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.L=new UW(c,b,a.ea),a.L.render(),H(a,a.L),n$b(a.L,a.gb)))}q.Zba=function(a){this.gb=a;mp(this.va,"waffle-assistant-readonly",a);var b=this.U;b.L=a;b.B&&(b.B.F=a);mp(b.va,"waffle-assistant-quicksum-panel-readonly",a);this.L&&!this.L.isDisposed()&&n$b(this.L,a)};
q.setVisible=function(a){var b=this.Ra();VW.V.setVisible.call(this,a);a&&!b&&(this.Y=LJ(this.La,dj.Qua),this.O.setActive(!0),WW(this));a||this.XS(!0)};q.Cla=function(){this.Ra()&&(this.XS(!0),this.O.setActive(!0),WW(this))};q.Bla=function(){this.Ra()&&(this.O.setActive(!1),WW(this))};q.ala=function(a){this.Ra()&&(this.J.Pb(2775,this.Zc),this.XS(void 0,a.B,a.D),this.Z8()||this.O.setActive(!0),WW(this),this.Sa=!1)};
q.$ka=function(a){if(this.Ra()){this.J.Pb(2776,this.Zc);var b=a.D;0<b.length&&(this.X=LJ(this.La,dj.Pua));this.XS(!1);this.O.setActive(!1);for(var c=0;c<b.length;c++){var d=b[c];C(d,1);this.Wsa(d,a.B)}a=a.U;b=this.$B();0<b.length&&this.bb&&(b[b.length-1].bb=!0);this.bb=!1;WW(this);this.Ysa(a);this.O0()}};q.Wsa=v;q.Ysa=v;q.XS=v;function WW(a){var b=a.Z8(),c=Np(T(a,"waffle-assistant-quicksum-panel")),d=a.O.Hb(),b=b||c||d;a=T(a,"waffle-assistant-empty-list");S(a,!b)}q.Z8=v;q.O0=v;q.$B=v;
function E$b(a){return T(a,"waffle-assistant-scroll-pane").scrollTop+Kp(T(a,"waffle-assistant-sidepane-content")).height}q.Bc=na;q.Hd=f("gb");q.Ola=function(){this.J.Pb(2226,this.Zc)};q.SDb=function(){""!=this.X&&(MJ(this.La,this.X),this.X="");""!=this.Y&&(MJ(this.La,this.Y),this.Y="");this.Sa||(this.J.Pb(2777,this.Zc),this.Sa=!0)};function F$b(a,b,c){a=a||{};c=c||{};return V(U(GU(Or({title:Rr(""+G$b()),$j:Rr((Ul?H$b():"")+'<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content">'+I$b(c)+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="'+(c.$a?"/*"+c.$a+"*/":"")+'display: none"></div><div class="waffle-assistant-card-holder"></div></div></div>'),id:Qr("autovis"),m0:Qr("waffle-assistant-title"),FV:Qr("waffle-assistant-sidepane-content")},
a))))}
function J$b(a,b,c){a=a||{};b=V;var d=Rr('<div class="waffle-assistant-replaceable-title">'+G$b()+"</div>");c=c||{};c=V((Ul?'<div class="waffle-assistant-dogfood-message-container">'+H$b()+"</div>":"")+'<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+I$b(c)+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="'+(c.$a?"/*"+c.$a+"*/":"")+'display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="'+
(c.$a?"/*"+c.$a+"*/":"")+'display: none"></div></div></div>');return b(U(GU(Or({title:d,$j:Rr(""+c),id:Qr("autovis"),m0:Qr("waffle-assistant-title"),FV:Qr("waffle-assistant-sidepane-content")},a))))}function G$b(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(uu({icon:"docs-icon-img docs-icon-explore-white"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")}
function H$b(){return V('<div class="waffle-assistant-dogfood-message"><div class="waffle-assistant-dogfood-icon"></div><div class="waffle-assistant-dogfood-message-body"><b>New features!</b> Please help us test them.</div></div>')}
function I$b(a){a=a||{};return V(""+('<div class="waffle-assistant-empty-list" style="'+(a.$a?"/*"+a.$a+"*/":"")+'display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>'))};function XW(a,b,c,d,e,g,h){VW.call(this,a,b,c,d,e,h);this.Wa=g;this.F=new dq(this.ea);this.Ka(this.F);this.Z=new h$b;H(this,this.Z);this.C=[];this.D=null}z(XW,VW);var YW={Vy:"waffle-assistant-scroll-pane-feature-content",vua:"waffle-assistant-dogfood-message-container",qXa:"waffle-assistant-features",pda:"waffle-assistant-expanded-panel",AZa:"waffle-assistant-replaceable-title",wjc:"waffle-assistant-scroll-pane",QM:"waffle-assistant-title"};q=XW.prototype;q.Xsa=function(){return J$b};
q.Da=function(){XW.V.Da.call(this);this.F.Ua(T(this,YW.pda));if(Vna){var a=new NW(this.Wa,this.Ba,this.yb,this.Ic,this.J,this.Z,this.ea);this.Ka(a);this.C.push(a)}if(goa||hoa)a=new g$b(this.J,this.Z,this.ea),this.Ka(a),this.C.push(a);a=new xW(this.yb,this.Ba,this.J,this.Z,this.ea);this.Ka(a);this.C.push(a);var b=T(this,YW.qXa);A(this.C,function(a){a.render(b);this.F.Ka(a.C,!0)},this);K$b(this)};q.Wsa=function(a,b){var c=Cc(a,1);wb(this.C,function(a){return a.r3(c)}).Usa(a,b)};
q.Ysa=function(){A(this.C,function(a){Y7b(a)})};q.XS=function(a,b,c){A(this.C,function(d){d.Xba(a,b,c)})};q.Z8=function(){return!!wb(this.C,function(a){return a.$la()})};q.O0=function(){var a=E$b(this);A(this.C,function(b){this.D&&this.D!=b||(b instanceof xW&&Cf(this.getHandler(),b,"assistant-done-rendering",this.SDb),a=b.Vsa(a))},this)};q.$B=function(){if(this.D)return this.D.C.C;var a=[];A(this.C,function(b){Kb(a,X7b(b))});return a};q.Zba=function(a){XW.V.Zba.call(this,a);K$b(this)};
q.Ah=function(a){A(this.C,function(b){b.Ah(a)})};q.Bc=function(){var a=T(this,YW.Vy),b=T(this,YW.AZa),c=T(this,YW.QM),d=this.F.va;if(this.D)this.D.C.setVisible(!1),this.D.setActive(!1),this.D=null,S(a,!0),Ul&&S(T(this,YW.vua),!0),S(d,!1),sr(b,G$b),this.resize();else if(this.D=wb(this.C,function(a){return a.Hb()}))S(a,!1),Ul&&S(T(this,YW.vua),!1),S(d,!0),this.D.C.setVisible(!0),Z7b(this.D,b);Jp(c,Kp(b).height);Rk(function(){var a=Dv;a&&a.dispatchEvent("resize");this.O0()},150,this)};
q.setVisible=function(a){var b=this.Ra();XW.V.setVisible.call(this,a);a&&!b&&L$b(this,!0)};q.Ola=function(){XW.V.Ola.call(this);this.D&&this.Bc()};q.Cla=function(){XW.V.Cla.call(this);L$b(this,!0)};q.Bla=function(){XW.V.Bla.call(this);L$b(this,!1)};q.ala=function(a){XW.V.ala.call(this,a);L$b(this,!0,a.B)};q.$ka=function(a){XW.V.$ka.call(this,a);L$b(this,!1)};function K$b(a){A(a.C,function(a){a.N0(this.Hd())},a)}function L$b(a,b,c){A(a.C,function(a){c||T7b(a.C,b)})};function ZW(a,b){dq.call(this,b);this.D=new Ys("",b);this.B=new Ys("",b);this.F=this.J=void 0;this.C=a}z(ZW,dq);q=ZW.prototype;q.sL=v;q.createElement=v;q.Be=f("C");q.Qa=function(){var a=this.createElement(),b=Kp(this.C),b=Math.max(b.height,b.width)+50;this.J=new bh(b,b);b=-this.sL();this.F=new N(b,b);pp(a,{borderWidth:this.sL()+"px",borderRadius:2*this.sL()+"px"});vp(a,this.F);Hp(a,this.J);Xm(a,!1);this.va=Cm("DIV","waffle-assistant-promo-wrapper",a)};
q.Da=function(){ZW.V.Da.call(this);var a=T(this,"waffle-assistant-promo-continue-button");a&&this.D.Ua(a);(a=T(this,"waffle-assistant-promo-close-button"))&&this.B.Ua(a);ip(this.getElement().nextElementSibling,"waffle-assistant-promo-anchor-element");this.getHandler().R(this.D,"action",this.Ejb).R(this.B,"action",this.cVb)};function $W(a,b,c){c(b);hp(b,"waffle-assistant-sidepane-content")||$W(a,b.parentElement,c)}q.Ejb=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};
q.cVb=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};q.Uc=function(){kp(this.getElement().nextElementSibling,"waffle-assistant-promo-anchor-element");ZW.V.Uc.call(this)};function M$b(a){var b;a=a||{};return V('<div class="waffle-assistant-promo-base '+W(a.Lf)+'" tabindex="0"><div class="waffle-assistant-promo-content">'+(a.cK?'<div class="waffle-assistant-promo-header">'+U(null==(b=a.cK)?"":b)+"</div>":"")+'<div class="waffle-assistant-promo-description">'+U(null==(b=a.l4)?"":b)+'<div class="waffle-assistant-promo-buttons">'+(a.GV?U(Xs({Qe:"waffle-assistant-promo-button waffle-assistant-promo-continue-button",content:Rr(""+U(a.GV)),style:4})):"")+(a.r4?U(Xs({Qe:"waffle-assistant-promo-button waffle-assistant-promo-close-button",
content:Rr(""+U(a.r4)),style:4})):"")+"</div></div></div></div>")}
function N$b(){return V('<div class="waffle-assistant-entry-promo-icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" class="waffle-assistant-entry-promo-icon" width="32px" height="32px" viewBox="0 0 24 24" fill="#0F9D58"><path d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg></div>')};function aX(a){var b=xm("waffle-assistant-chart-preview",void 0);ZW.call(this,b,a)}z(aX,ZW);aX.prototype.createElement=function(){return ur(M$b,{Lf:"waffle-assistant-analysis-promo",cK:"See the big picture",l4:"Data visualizations and text summaries make it easier to spot trends and outliers.",GV:"Got it"})};aX.prototype.sL=n(330);aX.prototype.Da=function(){aX.V.Da.call(this);$W(this,this.Be(),function(a){ip(a,"waffle-assistant-promo-container-element")})};
aX.prototype.Uc=function(){$W(this,this.Be(),function(a){kp(a,"waffle-assistant-promo-container-element")});aX.V.Uc.call(this)};function bX(a,b){ZW.call(this,document.querySelector(".waffle-assistant-feature-section .waffle-assistant-answers-input"),b);this.L=a}z(bX,ZW);bX.prototype.createElement=function(){var a=new Ev,b="Interested in the "+(a.xm("b")+(this.L+(a.Jm("b")+"? Ask a question about your data to learn more, no formulas needed.")));return ur(M$b,{Lf:"waffle-assistant-answers-promo",cK:"Find answers in a snap",l4:a.format(b),GV:"Next",r4:"Dismiss"})};bX.prototype.sL=n(250);
bX.prototype.Da=function(){bX.V.Da.call(this);$W(this,this.Be(),function(a){ip(a,"waffle-assistant-promo-container-element")})};bX.prototype.Uc=function(){$W(this,this.Be(),function(a){kp(a,"waffle-assistant-promo-container-element")});bX.V.Uc.call(this)};function cX(a,b){var c=xm("waffle-assistant-entry",void 0);ZW.call(this,c,b);this.L=a}z(cX,ZW);cX.prototype.sL=n(400);
cX.prototype.createElement=function(){var a=ur(M$b,{Lf:"waffle-assistant-entry-promo",cK:"Get insights instantly",l4:this.L.startsWith("en")?"Find answers to questions about your data, apply formatting, and create charts in a single click using Sheets Explore.":"Apply formatting and create charts over your data in a single click using Sheets Explore.",GV:"Check it out",r4:"Dismiss"}),b=ur(N$b);this.ea.append(a,b);return a};
cX.prototype.Da=function(){cX.V.Da.call(this);var a=this.ea.tia(this.Be(),"docs-sheet-status-container-avs");ip(a,"waffle-assistant-promo-container-element");kp(this.getElement().nextElementSibling,"waffle-assistant-promo-anchor-element")};cX.prototype.Uc=function(){var a=this.ea.tia(this.Be(),"docs-sheet-status-container-avs");kp(a,"waffle-assistant-promo-container-element");cX.V.Uc.call(this)};function dX(a){var b=xm("waffle-assistant-banding-recommendation",void 0);ZW.call(this,b.parentElement,a)}z(dX,ZW);dX.prototype.createElement=function(){return ur(M$b,{Lf:"waffle-assistant-formatting-promo",cK:"Make it pop",l4:"Quickly apply alternating row color formatting to add style, polish, and visual appeal.",GV:"Next",r4:"Dismiss"})};dX.prototype.sL=n(300);
dX.prototype.Da=function(){dX.V.Da.call(this);var a=this.va;vp(a,wp(a).translate(0,-150));$W(this,this.Be(),function(a){ip(a,"waffle-assistant-promo-container-element")});ip(a.nextElementSibling,"waffle-assistant-formatting-anchor-element")};dX.prototype.Uc=function(){var a=this.va;$W(this,this.Be(),function(a){kp(a,"waffle-assistant-promo-container-element")});kp(a.nextElementSibling,"waffle-assistant-formatting-anchor-element");dX.V.Uc.call(this)};function O$b(a,b,c,d,e,g,h,k,l){CU.call(this,b,h);this.Ia=a;this.B=b;this.X=c;this.Ea=d;this.Sa=e;this.oa=g;this.Oa=k;this.J=c.B;this.Ba=this.Y=!1;this.F=l;this.C=null;this.wb=new Ei;this.O=null;a=Zv(this.Sa);this.ma.R(this.Ea,"selectionChange",this.$Ub).R(this.J,"Sa",this.ZUb).R(a,"kb",this.hrb).R(this.B,"assistant-sidepane-apply-conditional-format-rules",this.Pgb).R(this.B,"assistant-sidepane-apply-banding",this.Ogb).R(this.B,"assistant-sidepane-change-selection",this.bib).R(this.B,"assistant-sidepane-insert-chart",
this.fpb).R(this.B,"assistant-sidepane-thumbs",this.cyb).R(this.B,"assistant-sidepane-set-active-panel",this.Ywb).R(this.B,"assistant-sidepane-back-button-clicked",this.jhb).R(this.Ia,"cu",this.xjb);Ao(this.L,X.yG,Mn,this.ipb).subscribe(X.hT,"action",this.hhb).subscribe(X.Z0,"action",this.Qxb).subscribe(X.hca,"action",this.Lxb);X.Y0.Ma(!0);this.Zc=Do(new Co,10).Fa();this.Ja=KJ.getInstance();this.Z=LJ(this.Ja,dj.Oua);Rk(Ca(this.uV,!1),100,this)}z(O$b,CU);q=O$b.prototype;q.Ei=function(){return X.kca};
q.uu=function(){return X.lca};q.Pn=function(a){O$b.V.Pn.call(this,a);X.Z0.Ma(a);this.uV(!1);!this.Y&&a&&(this.Y=!0,noa&&this.Oa.B["ritz-DisplayExploreV2Promo"].Ta(!1))};q.Ah=function(a){this.B.Ah(a);this.Ia.Ah(a)};q.hhb=function(){var a=this.B.Ra();this.Ei().setVisible(!a);a?this.F.Pb(2226,this.Zc):(this.B.focus(),this.F.Pb(2253,this.Zc))};q.Lxb=function(){this.B.Ra()||this.Pn(!0)};q.Qxb=function(a){D$b(this.B,a)};q.$Ub=function(){this.uV(!0);this.C&&(I(this.C),this.C=null)};
q.uV=function(a,b){if(b){if(!b.length)return;if(1==b.length&&this.O&&b[0].equals(this.O)){this.O=null;return}}var c=this.B;c.Ra()&&(j$b(c.U),WW(c));this.Ia.update(!a,this.B.Ra(),b)};
q.xjb=function(a){""!=this.Z&&(MJ(this.Ja,this.Z),this.Z="");var b=a.getConfidence()||0;a=a.B;var c=!!a&&a.rect,d=(c=!!c&&50<=Bh(c)&&5<=wh(c,"r")&&3<=wh(c,"c")&&5E4>=Bh(c))&&.6<=b;d!==this.Ba&&(this.Ba=d,X.Y0.Vb(d));c&&(a&&a.rect?(c=.9<=b,d=1E3>=Bh(a.rect),a=ritz.isFormsRegion(""+a.xd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=doa&&!this.B.Ra()&&!this.Y&&c&&d&&!Tv(this.X.D),a=eoa&&a,d=foa&&this.X.Hd(),c&&(a||d)?(c=new L7b,P(c,1,b),P(c,2,a),P(c,3,d),a=new Qn,Yi(a,58,
c),this.uza(new Bo(10,a)),a=!0):a=!1):a=!1,!a&&noa&&.6<=b&&!this.B.Ra()&&!this.Y&&!this.C&&this.Oa.B["ritz-DisplayExploreV2Promo"].Ha()&&(b=this.X.Y.Gx(),this.C=new cX(b),H(this,this.C),b=this.C,hq(b,b.C.firstElementChild),Cf(Cf(this.ma,this.C,"promo-dismiss",this.Ila),this.C,"promo-continue",this.pmb),this.Oa.B["ritz-DisplayExploreV2Promo"].Ta(!1)))};q.uza=function(a){this.B.bb=!0;var b=JNa(aw(this.J));VIb.B||b||(a=a||this.Zc,this.Ei().setVisible(!0),this.F.Pb(2225,a),Rk(Ca(this.g2a,a),5E3,this))};
q.g2a=function(a){this.B.Ra()||this.F.Pb(2752,a)};q.Ila=function(){I(this.C);this.C=null};q.pmb=function(){I(this.C);this.Pn(!0);Cf(this.ma,this.B,"assistant-done-rendering",y(function(){var a;a:{this.B.Ra();for(var b=a=!1,c=!1,d=this.B.$B(),e=0;e<d.length;e++)if(d[e]instanceof KW?a=!0:d[e]instanceof OW?b=!0:d[e]instanceof tW&&(c=!0),a&&b&&c){a=!0;break a}a=!1}a?this.PJa():this.Ila()},this))};
q.PJa=function(){this.B.Ra();I(this.C);var a=null;if(this.C instanceof cX){for(var a=null,b=this.B.$B(),c=0;c<b.length;c++)if(b[c]instanceof KW){a=b[c].qX()[0].toLowerCase();break}a=new bX(a)}else this.C instanceof bX?a=new dX:this.C instanceof dX&&(a=new aX);if(this.C=a)H(this,this.C),a=this.C,hq(a,a.C.firstElementChild),Cf(Cf(this.ma,this.C,"promo-dismiss",this.Ila),this.C,"promo-continue",this.PJa)};q.jhb=function(){this.B.Bc()};
q.ZUb=function(){$v(this.J)?(this.B.Ma(!0),this.uV(!1)):(this.Ei().setVisible(!1),this.B.Ma(!1))};q.ipb=function(){this.B.Zba(!X.yG.isEnabled())};q.hrb=function(a){this.uV(!1,a.B?a.B:a.rect?[a.rect]:[])};q.Pgb=function(a){var b=aw(this.J),c=""+b.hc(),d=[],e=A3b(b);if(e){var b=new Te,g=Cc(e,2);E(b,3,g);g=Cc(e,2);E(b,2,g);e=Cc(e,1);E(b,1,e);d.push(b)}b=a.B.Wa;for(e=0;e<b.length;e++)g=new Te,E(g,2,b[e]),d.push(g);this.oa.B(new HU(d,c));a=a.Mj();this.F.Pb(a,this.Zc)};
q.Ogb=function(a){var b=a.B,c=o4b(b.B),d=b.C.l6(),e=c.At?c.cw:null,g=c.B?c.Ov:null,h=parseInt(d.cb(),10),k;k=d.cb();var l=Jh(d);k=ritz.getWorkbookRangeIntersectingIds(k,l.fc(),l.Ub(),l.Rc(),l.cd(),7,!1);k=0<k.length?k[0]:null;this.O=Jh(d);k?this.oa.B(new BU(k,h,this.O,e,c.lr,c.Xr,g)):this.oa.B(new AU(h,this.O,e,c.lr,c.Xr,g));d=new O3b;P(d,1,1);c=new XT;b=b.C.getConfidence();P(c,2,b);Yi(c,5,d);b=new Qn;Yi(b,46,c);b=new Bo(10,b);a=a.Mj();this.F.Pb(a,b)};
q.bib=function(a){oC(aw(this.J),a.D);a=a.Mj();this.F.Pb(a,this.Zc)};
q.cyb=function(a){var b=a.B;a=a.Mj();if(b instanceof BW)this.F.Pb(a,this.Zc);else{var c=this.B.$B(),d=new XT,e=b.C.getConfidence(),c=c.indexOf(b);P(d,1,c);P(d,2,e);e=new Qn;Yi(e,46,d);if(b instanceof tW){(d=b.J)?(b=P$b(this,b,d),b=$6b(b,d,d.Qg)):b=null;if(!b)return;Yi(e,39,b)}else if(b instanceof wW){var g=b.C,c=new N7b;if(b instanceof wW)b=1;else throw Error("Unknown text analysis card type.");g=Bc(g.getAutovisRecommendation(),20).slice(0,10);P(c,2,g||[]);P(c,1,b);Yi(d,3,c)}this.F.Pb(a,new Bo(10,
e))}};q.Ywb=function(){this.B.Bc()};
q.fpb=function(a){var b=a.U;if(b){var c=aw(this.J),d=a.Be();d||(d=Iz(this.Ea).jd().B.Be());var e=16,g=16,h=a.Ya;h&&(e=h.x,g=h.y);c={oid:null,ar:vC(c,d.y),ac:wC(c,d.x),x:e,y:g,h:pGa.height,w:pGa.width,p:{context:{chartName:"Chart "+(Q$b(this)+1)}}};d=new jI(Vv(this.J)||0,c,!1,!1);c=b.Qg;e=new rl(c);g=Dl(e,"headers");g=null!=g&&va(g)&&Ra(g)?parseInt(g,10):-1;d.Oa=g;d.oa=0;g="1"==Dl(e,"transpose");d.Ia=g;d.L=g?"ROWS":"COLS";g=Dl(e,"range");g=F3b(E3b(g,","),this.J);d.gS(g);K2b(d,b);if(e=Dl(e,"dt"))e=
this.wb.od(Ze.Aa(),JSON.parse(decodeURIComponent(e))),d.O=encodeURIComponent(JSON.stringify(d.Sa.serialize(e)));this.Ea.dispatchEvent(new ZE("objectRequest"));this.oa.B(new RE(this.X,d));e=R$b(this,b,a.X,a.Xe());d=this.F;a=a.Mj();b=$6b(e,b,c);c=new Qn;Yi(c,39,b);d.Pb(a,new Bo(10,c))}};function P$b(a,b,c){var d=a.B.$B().filter(function(a){return a instanceof tW});return R$b(a,c,d.indexOf(b),b.J&&b.J.Xe())}
function R$b(a,b,c,d){var e=new b7b;a=a.B.$B().filter(function(a){return a instanceof tW}).map(function(a){return a.getChartType()});e.O=a;e.D=c;c7b(e,b.getChartType());e.C=d?d.clone():null;return e}function Q$b(a){var b=0;vG(a.X.F,function(a){6==a.getType()&&b++});return b};function S$b(a,b){rW.call(this,a,b)}z(S$b,rW);q=S$b.prototype;q.ZB=function(a){a()};q.Nw=na;q.dA=n("assistantPivotTableFeedback");q.tJ=n(2632);q.sJ=n(2631);function T$b(a,b,c,d,e,g,h){VW.call(this,a,b,c,d,e,h);this.F=new dq(this.ea);this.Ka(this.F);this.D=null;this.Wa=new M;H(this,this.Wa);this.C=[];this.Xa=null;this.Z=!0}z(T$b,VW);var U$b={UVa:"waffle-assistant-card-holder",Vy:"waffle-assistant-sidepane-content",VWa:"waffle-assistant-dragger-card",UWa:"waffle-assistant-dragged-card",VISIBLE:"waffle-assistant-visible"};q=T$b.prototype;q.Xsa=function(){return F$b};q.Da=function(){T$b.V.Da.call(this);var a=T(this,U$b.UVa);this.F.Ua(a)};
q.setVisible=function(a){var b=this.Ra();T$b.V.setVisible.call(this,a);a&&!b&&(this.Z=!0)};
q.Wsa=function(a){var b=C(a,1),c=null;switch(b){case 0:"WordCloud"==a.getAutovisRecommendation().getChartType()?c=new wW(a,this.ea):c=new tW(a,this.yb,this.Ba,this.J,null,this.ea);break;case 1:c=new S$b(a,this.ea);break;case 2:c=new PW(a,this.ea);break;case 4:c=new OW(a,this.J,this.ea);break;default:throw Error("Unsupported recommendation type: "+b);}a=this.F.kd();c.U=a;this.F.Ka(c,!0);if(X.yG.isEnabled()){if(!this.D||this.D.isDisposed())this.D=new V$b,q4b(this.D,this.F.va),this.D.U=10,this.D.O=Ta(U$b.VWa).split(" "),
this.D.Z=!0,this.D.mqa(U$b.VISIBLE),this.D.J=!1,this.D.Ue(),this.Wa.R(this.D,"beforedragstart",y(this.aVb,this)).R(this.D,"dragstart",y(this.bVb,this)).R(this.D,"beforedragend",y(this.shb,this));a=this.D;var b=this.F.va,d=c.va;u(void 0)?apa(b,d,void 0):b.appendChild(d);r4b(a,d)}0!=this.C.length&&c.getHandler().R(this.C[this.C.length-1],"content-rendered",c.WN);this.C.push(c)};q.Ysa=function(a){0<this.C.length&&this.C[0].WN();if(a||this.Z)this.Z=!1,W$b(this)};
function W$b(a){if(0!=a.C.length){for(var b=0,c=0;c<a.C.length;c++){var d=a.C[c].va;vp(d,0,1E3);b+=Kp(d).height}b=Math.max(Kp(T(a,"waffle-assistant-sidepane-content")).height,b);Jp(a.F.va,b);for(c=0;c<a.C.length;c++)Rk(Ca(a.M0a,a.C[c]),100*c,a);Rk(function(){Jp(this.F.va,"auto")},100*a.C.length,a)}}q.M0a=function(a){!a.isDisposed()&&this.isEnabled()&&(new nU(a.va,[0,1E3],[0,0],100)).play()};
q.XS=function(){this.Wa.Ec();I(this.D);for(var a=0;a<this.C.length;a++){var b=this.C[a];b.mc()&&this.F.removeChild(b,!0);I(b)}this.C=[]};q.Z8=function(){return 0<this.C.length};q.O0=function(){for(var a=E$b(this),b=0,c=0;c<this.C.length;c++)b<a?($V(this.C[c],!0),b+=Kp(this.C[c].va).height):$V(this.C[c],!1)};q.aVb=function(a){var b=pb(this.F.va.childNodes,a.B),b=this.F.vd(b);b.fMa()?this.Xa=b:a.preventDefault()};q.bVb=function(a){ip(a.D,U$b.UWa)};
q.shb=function(a){var b=wp(a.D),c=Iz(this.Ba).B;if(gh(yE(c,"page",!1,!1)).contains(b)){var d=wE(c,b.x,b.y,"page"),c=AE(c,mh(d),"page");this.Xa.P7(d,new N(b.x-c.left,b.y-c.top))}a.U.Yv(null,!0);a.preventDefault();this.Xa=null};q.$B=f("C");function V$b(){IU.call(this)}z(V$b,IU);V$b.prototype.Tja=function(a){a=V$b.V.Tja.call(this,a);var b=sb(a.querySelectorAll("clippath"),function(a){return a.id});X$b(a,b);return a};
function X$b(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];va(c)&&$a(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=Nm(a);for(d=0;d<a.length;d++)X$b(a[d],b)};function Y$b(){G.call(this)}z(Y$b,rn);Y$b.prototype.B=function(){return s$b};Y$b.prototype.D=function(){return goa||hoa||Vna?XW:T$b};Y$b.prototype.C=function(){return O$b};zn("assistant",Y$b);
