yU.prototype.hsa=ga(224,function(a){this.O=Pb(arguments,0)});function e$b(a,b,c,d,e){return olb(a,y(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.L,!0)},a))}function LV(a){Yi(this,a,0,-1,null)}z(LV,Xi);function f$b(a,b){var c=b.width;b=b.height;for(var d=a.width<=c?1:Math.floor(a.width/c),e=a.height<=b?1:Math.floor(a.height/b),g=[],h=0;h<d;h++)for(var k=a.left+h*c,l=0;l<e;l++){var m=a.top+l*b;g.push(new qh(m,k,m+b,k+c))}return g}var g$b=[2];
function h$b(a){return mc(t9b,function(b){return b.match(a)}).getName()}function i$b(a,b){var c=a.type;if(u(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(ya(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":ya(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,g=0;e=b[g];g++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}}
function j$b(a){var b=a.type;if(!u(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return u(a.value)?a.value:null}}function k$b(a){Yi(this,a,0,-1,null)}z(k$b,Xi);var l$b={Noc:0,Qza:1,pAa:2};function m$b(a){Yi(this,a,0,-1,g$b)}z(m$b,Xi);
function n$b(a,b,c){function d(){g=la.setTimeout(e,b);a.apply(null,k)}function e(){g=null;h&&(h=!1,d())}c&&(a=y(a,c));var g=null,h=!1,k=[];return function(a){k=arguments;g?h=!0:d()}}function o$b(a){for(var b=Math.random,c=a.length-1;0<c;c--){var d=Math.floor(b()*(c+1)),e=a[c];a[c]=a[d];a[d]=e}}function MV(a,b,c,d,e,g){K.call(this,a,b);this.C=b;this.Ka=c;this.Pa=d||null;this.Ua=e||null;this.F=g||null}z(MV,K);MV.prototype.Hj=f("Ka");MV.prototype.Se=f("Pa");
function p$b(a,b,c,d,e,g){MV.call(this,"assistant-sidepane-insert-chart",null,d,e,g);this.Y=a;this.$=b;this.dc=c}z(p$b,MV);p$b.prototype.Pe=f("dc");function q$b(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+T(a.title)+"</div>"+T(mt({Ee:"waffle-assistant-section-more-button",content:fs("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function NV(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Ya(b),lt(a,b,void 0),g6b(a),a.setAttribute("data-tooltip-delay",500),h6b(a,u(c)?c:1))};function r$b(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function s$b(){var a=V,b;b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+T(r$b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function t$b(a){return V('<div class="waffle-assistant-panel-title-bar">'+T(mt({Ee:"waffle-assistant-panel-back-button",content:fs(""+T(Ku({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+T(a.title)+"</div></div>")};function OV(a){xq.call(this,a);this.Ne=new EV(!1,"#4285f4");this.Ma(this.Ne);this.O=new xq(this.oa);this.Ma(this.O);this.D=[];this.Ff=this.Yd=!1;this.Ze=this.Oe=this.Xa=this.$=null;this.Tb=new nt("",a,4);sr(this.Tb,2);this.Ma(this.Tb)}z(OV,xq);var u$b={defaultHelpArticleId:"6280499"};q=OV.prototype;q.Sa=function(){OV.Z.Sa.call(this);this.Ba=Pr(s$b);this.Oe=S(this,"waffle-assistant-panel-content-container");this.Ze=S(this,"waffle-assistant-empty-list")};
q.Ha=function(){OV.Z.Ha.call(this);var a=S(this,"waffle-assistant-spinner-container");this.Ne.render(a);this.O.Va(S(this,"waffle-assistant-panel-card-holder"));this.Tb.Va(S(this,"waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.Tb,"action",this.NXb).V(this.Ba,"scroll",n$b(this.PWa,10,this))};q.setVisible=function(a){R(this.Ba,a);A(this.D,function(a){if(!a.mc()){var b=this.O.ld();a.Y=b;this.O.Ma(a,!0);a.lP()}},this);this.Yd=a};
q.Cra=function(a,b){var c=this.oa;this.$&&this.d6();this.$=new xq;this.Ma(this.$);a=Nr(a,t$b,{title:b});this.Xa=new nt("",this.oa);this.$.Ma(this.Xa);this.Xa.Va(yn(c,"waffle-assistant-panel-back-button",a));NV(this.Xa.Ba,"Back");this.$.getHandler().V(this.Xa,"action",this.akb)};q.d6=function(){this.$.dispose();this.$=null};function v$b(a,b){a.Ne.setActive(b);R(S(a,"waffle-assistant-panel-pane"),!b)}q.eM=function(a){R(this.Ze,a);R(this.Oe,!a)};
function w$b(a,b){Jb(a.D,b);a.O.removeChild(b);a.O.Ci(b,0);a.D.push(b)}q.EL=function(a){Jb(this.D,a);-1!=Gq(this.O,a)&&this.O.removeChild(a,!0)};q.n5=function(){this.O.Od(!0);Jc(this.D);this.D=[]};q.PWa=function(){for(var a=this.Ba,a=a.scrollTop+cq(a).height,b=0,c=0;c<this.D.length;c++){var d=this.D[c];b<a?(PV(d,!0),b+=cq(d.Ba).height):PV(d,!1)}};q.Ue=function(a){this.Ff=a;A(this.D,function(b){b.Ue(a)})};q.Gd=f("Ff");q.NXb=function(){Q.In.Pb(u$b)};q.akb=function(){this.dispatchEvent("assistant-sidepane-back-button-clicked")};function QV(a,b,c,d){xq.call(this,d);this.R=a;this.Ua=b;this.X=new nt("",this.oa);this.Ma(this.X);this.J=new xq(this.oa);this.Ma(this.J);this.D=null;this.Na=[];this.Ff=this.Ka=!1;this.O=c}z(QV,xq);q=QV.prototype;q.OMa=Kf;q.Osa=Lf;q.Sa=function(){QV.Z.Sa.call(this);this.Ba=Pr(q$b,{title:this.JU()})};
q.Ha=function(){QV.Z.Ha.call(this);this.J.Va(S(this,"waffle-assistant-section-card-holder"));this.X.Va(S(this,"waffle-assistant-section-more-button"));this.getHandler().V(this.X,"action",this.pub);this.D=this.RCa();I(this,this.D);R(x$b(this),this.OMa());this.setVisible(!1)};q.setVisible=function(a){if(this.mc()&&this.Ta()!=a&&(R(this.Ba,a),a)){R(this.X.Ba,this.gUa());a=new k$b;var b=this.Nda();P(a,4,b);b=new jo;dj(b,58,a);this.O.Ob(2774,new Vo(10,b))}};q.Ta=function(){return this.mc()&&gq(this.Ba)};
q.gUa=function(){return this.Na.length>this.R};q.JU=v;q.GX=v;q.RCa=function(){return new OV(this.oa)};q.Ue=function(a){this.Ff=a;A(y$b(this),function(b){b.Ue(a)});this.D.Ue(a)};q.Gd=f("Ff");q.uh=oa;q.e5=v;q.Nda=v;q.Rua=function(a){this.Na=a;for(var b=0;b<a.length;b++){Fc(a[b],1);if(this.J.ld()<this.R){var c=this.GX(a[b]);c.Ue(this.Ff);var d=this.J.ld();c.Y=d;this.J.Ma(c,!0)}if(this.Osa()&&(this.D.eM(!1),c=this.D,d=this.GX(a[b]),c.D.push(d),c.Yd)){v$b(c,!1);var e=c.O.ld();d.Y=e;c.O.Ma(d,!0);d.lP()}}};
function y$b(a){var b=[];a.J.wg(function(a){b.push(a)});return b}function x$b(a){return S(a,"waffle-assistant-section-content")}q.Mna=function(){return Kua(this.J)};q.w2=function(){this.Na=[];Jc(this.J.Od(!0));this.setVisible(!1);this.Osa()&&(this.D.n5(),this.D.eM(!0))};function z$b(a){a.J.wg(function(a,c){c<this.R&&a.lP()},a)}
q.Sua=function(a){var b=0;if(this.Ka)this.D.PWa();else if(this.Mna()){this.setVisible(!0);for(var b=cq(S(this,"waffle-assistant-section-header")).height+cq(x$b(this)).height,c=y$b(this),d=0;d<c.length;d++)b<a&&d<this.R?(this.RJa(c[d]),PV(c[d],!0),b+=cq(c[d].Ba).height):PV(c[d],!1)}else this.setVisible(!1);return a-b};q.RJa=oa;q.setActive=function(a){(this.Ka=a)||this.D.d6()};q.Nb=f("Ka");function A$b(a,b){a.D.Cra(b,a.JU())}q.pub=function(){this.setActive(!0);this.dispatchEvent("assistant-sidepane-set-active-panel")};var B$b={UNKNOWN_ERROR:0,cpc:1,Zhc:2,I6b:3},C$b={Uoc:0,HC:1,eic:2,Ihc:3,Xjc:4},D$b={Roc:0,aic:1,fI:2,Lfc:3},E$b={Loc:0,yoc:1,o$b:2,Nnc:3,Mnc:4};function RV(){B.call(this)}z(RV,B);var F$b=null;RV.prototype.El=function(){return D(this,1)};function SV(){B.call(this)}z(SV,B);var G$b=null;SV.prototype.getText=function(){return D(this,1)};SV.prototype.Gq=function(){return zc(this,1)};function TV(){B.call(this)}z(TV,B);var H$b=null;TV.prototype.getStatus=function(){return D(this,1)};TV.prototype.hasFormula=function(){return zc(this,2)};TV.prototype.getError=function(){return D(this,9)};function UV(){B.call(this)}z(UV,B);var I$b=null;q=UV.prototype;
q.lh=function(){return D(this,1)};q.zg=function(a){E(this,1,a)};q.c$=function(){return zc(this,1)};q.hasFormula=function(){return zc(this,2)};q.getType=function(){return D(this,3)};q.Dd=function(a){E(this,3,a)};q.kf=function(){return zc(this,3)};RV.prototype.Ca=function(){var a=F$b;a||(F$b=a=Gc(RV,{0:{name:"Error",fb:"ritz.assistant.Error"},1:{name:"message",Aa:9,type:String},2:{name:"code",Aa:14,defaultValue:0,type:B$b}}));return a};RV.Ca=RV.prototype.Ca;
SV.prototype.Ca=function(){var a=G$b;a||(G$b=a=Gc(SV,{0:{name:"AnswerQueryPhrase",fb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Aa:9,type:String},2:{name:"start_byte",Aa:5,type:Number},3:{name:"num_bytes",Aa:5,type:Number}}));return a};SV.Ca=SV.prototype.Ca;
TV.prototype.Ca=function(){var a=H$b;a||(H$b=a=Gc(TV,{0:{name:"AnswerResponse",fb:"ritz.assistant.AnswerResponse"},1:{name:"status",Aa:5,type:Number},10:{name:"parse_status",Aa:14,defaultValue:0,type:C$b},11:{name:"answer_status",Aa:14,defaultValue:0,type:D$b},2:{name:"formula",Aa:9,type:String},3:{name:"debug_parse_response",Aa:9,type:String},4:{name:"interpretation",Aa:9,type:String},5:{name:"debug_interpretation_response",Aa:9,type:String},6:{name:"unused_phrase",od:!0,Aa:11,type:SV},7:{name:"used_entity_phrase",
od:!0,Aa:11,type:SV},8:{name:"unused_entity_phrase",od:!0,Aa:11,type:SV},9:{name:"error",Aa:11,type:RV},12:{name:"alternate_suggestion",od:!0,Aa:11,type:UV}}));return a};TV.Ca=TV.prototype.Ca;UV.prototype.Ca=function(){var a=I$b;a||(I$b=a=Gc(UV,{0:{name:"QuerySuggestion",fb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Aa:9,type:String},2:{name:"formula",Aa:9,type:String},3:{name:"type",Aa:14,defaultValue:0,type:E$b}}));return a};UV.Ca=UV.prototype.Ca;function VV(){B.call(this)}z(VV,B);var J$b=null;VV.prototype.getChartType=function(){return D(this,1)};
VV.prototype.Ca=function(){var a=J$b;a||(J$b=a=Gc(VV,{0:{name:"AutovisRecommendationProto",fb:"ritz.assistant.AutovisRecommendationProto"},1:{name:"chart_type",Aa:9,type:String},2:{name:"chart_title",Aa:9,type:String},3:{name:"horizontal_axis_title",Aa:9,type:String},4:{name:"horizontal_axis_min",Aa:1,type:Number},5:{name:"horizontal_axis_max",Aa:1,type:Number},6:{name:"left_vertical_axis_title",Aa:9,type:String},7:{name:"left_vertical_axis_min",Aa:1,type:Number},8:{name:"left_vertical_axis_max",
Aa:1,type:Number},9:{name:"right_vertical_axis_title",Aa:9,type:String},10:{name:"right_vertical_axis_min",Aa:1,type:Number},11:{name:"right_vertical_axis_max",Aa:1,type:Number},12:{name:"columns_to_group_by",od:!0,Aa:5,type:Number},13:{name:"column_aggregation_types",od:!0,Aa:9,type:String},14:{name:"is_transposed",Aa:8,type:Boolean},15:{name:"use_first_column_as_domain",Aa:8,type:Boolean},16:{name:"first_data_row_index",Aa:5,type:Number},17:{name:"is_stacked",Aa:8,type:Boolean},19:{name:"text_analysis_words",
od:!0,Aa:9,type:String},20:{name:"text_analysis_word_counts",od:!0,Aa:5,type:Number},22:{name:"best_facet_column_from_range",Aa:5,type:Number},23:{name:"best_facet_labels",od:!0,Aa:9,type:String},24:{name:"needs_data_transformation",Aa:8,type:Boolean},25:{name:"data_transformation",Aa:11,type:df},26:{name:"best_facet_column_label",Aa:9,type:String},27:{name:"best_facet_range",od:!0,Aa:11,type:Pd}}));return a};VV.Ca=VV.prototype.Ca;var K$b={sfa:0,kea:1,N2:2,N3:3};function WV(){B.call(this)}z(WV,B);var L$b=null;q=WV.prototype;q.getName=function(){return D(this,1)};q.wh=function(a){E(this,1,a)};q.getType=function(){return D(this,4)};q.Dd=function(a){E(this,4,a)};q.kf=function(){return zc(this,4)};function XV(){B.call(this)}z(XV,B);var M$b=null;XV.prototype.getName=function(){return D(this,1)};XV.prototype.wh=function(a){E(this,1,a)};function YV(){B.call(this)}z(YV,B);var N$b=null;YV.prototype.Wd=function(a){return D(this,2,a)};
YV.prototype.gp=function(){return zc(this,2)};WV.prototype.Ca=function(){var a=L$b;a||(L$b=a=Gc(WV,{0:{name:"Dimension",fb:"ritz.assistant.Dimension"},1:{name:"name",Aa:9,type:String},2:{name:"filter",od:!0,Aa:9,type:String},3:{name:"non_unique_filter",od:!0,Aa:13,type:Number},4:{name:"type",Aa:14,defaultValue:0,type:K$b},5:{name:"year_only_dates",Aa:8,type:Boolean},6:{name:"density",Aa:1,type:Number},7:{name:"alt_name",od:!0,Aa:9,type:String}}));return a};WV.Ca=WV.prototype.Ca;
XV.prototype.Ca=function(){var a=M$b;a||(M$b=a=Gc(XV,{0:{name:"Metric",fb:"ritz.assistant.Metric"},1:{name:"name",Aa:9,type:String},2:{name:"alt_name",od:!0,Aa:9,type:String}}));return a};XV.Ca=XV.prototype.Ca;
YV.prototype.Ca=function(){var a=N$b;a||(N$b=a=Gc(YV,{0:{name:"EntityListTable",fb:"ritz.assistant.EntityListTable"},1:{name:"metric",od:!0,Aa:11,type:XV},2:{name:"dimension",od:!0,Aa:11,type:WV},3:{name:"non_unique_dimension",od:!0,Aa:13,type:Number},4:{name:"is_flipped_table",Aa:8,type:Boolean}}));return a};YV.Ca=YV.prototype.Ca;var O$b={g0b:0,YH:1,S1b:2,G_b:3,LXa:4};function ZV(){B.call(this)}z(ZV,B);var P$b=null;function $V(){B.call(this)}z($V,B);var Q$b=null;$V.prototype.Pf=function(a){return D(this,4,a)};function aW(){B.call(this)}z(aW,B);var R$b=null;q=aW.prototype;q.CT=function(){return D(this,2)};q.eh=function(){return D(this,3)};q.XJ=function(){return D(this,4,0)};q.getPivotTableDef=function(){return D(this,5)};q.Bga=function(){return Ec(this,7)};q.getAutovisRecommendation=function(){return D(this,8)};
function bW(){B.call(this)}z(bW,B);var S$b=null;ZV.prototype.Ca=function(){var a=P$b;a||(P$b=a=Gc(ZV,{0:{name:"AssistantResponseProto",fb:"ritz.assistant.AssistantResponseProto"},1:{name:"recommendation",od:!0,Aa:11,type:aW},2:{name:"selection_recommendation",od:!0,Aa:11,type:aW}}));return a};ZV.Ca=ZV.prototype.Ca;
$V.prototype.Ca=function(){var a=Q$b;a||(Q$b=a=Gc($V,{0:{name:"AssistantRequestProto",fb:"ritz.assistant.AssistantRequestProto"},1:{name:"table_range",Aa:11,type:Pd},2:{name:"selected_row",od:!0,Aa:5,type:Number},3:{name:"selected_column",od:!0,Aa:5,type:Number},4:{name:"color",od:!0,Aa:11,type:rd},5:{name:"color_frequency",od:!0,Aa:5,type:Number}}));return a};$V.Ca=$V.prototype.Ca;
aW.prototype.Ca=function(){var a=R$b;a||(R$b=a=Gc(aW,{0:{name:"RecommendationProto",fb:"ritz.assistant.RecommendationProto"},1:{name:"recommendation_type",Aa:14,defaultValue:0,type:O$b},2:{name:"confidence",Aa:1,type:Number},3:{name:"description",Aa:9,type:String},4:{name:"grid_ranges",od:!0,Aa:11,type:Pd},5:{name:"pivot_table_def",Aa:11,type:Me},6:{name:"conditional_format_rules",od:!0,Aa:11,type:Te},7:{name:"banding_protos",od:!0,Aa:11,type:Dd},8:{name:"autovis_recommendation",Aa:11,type:VV},9:{name:"entity_list_table",
Aa:11,type:YV}}));return a};aW.Ca=aW.prototype.Ca;
bW.prototype.Ca=function(){var a=S$b;a||(S$b=a=Gc(bW,{0:{name:"AssistantFlagsProto",fb:"ritz.assistant.AssistantFlagsProto"},2:{name:"include_word_clouds",Aa:8,type:Boolean},3:{name:"include_conditional_formats",Aa:8,type:Boolean},4:{name:"include_forms_integration",Aa:8,type:Boolean},5:{name:"include_answers",Aa:8,type:Boolean},6:{name:"include_autovis_faceting",Aa:8,type:Boolean},7:{name:"include_banding",Aa:8,type:Boolean},9:{name:"include_autovis_sum",Aa:8,type:Boolean},10:{name:"include_already_applied_formatting_recommendations",
Aa:8,type:Boolean}}));return a};bW.Ca=bW.prototype.Ca;function T$b(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(dm?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(dm?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function cW(){}z(cW,ZI);qa(cW);cW.prototype.rc=n("waffle-assistant-link-button");function U$b(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function V$b(a,b){xq.call(this,b);this.D=a;this.C=new gt("",new cW,this.oa);this.Ma(this.C)}z(V$b,xq);q=V$b.prototype;q.Sa=function(){this.Ba=Pr(U$b)};q.Ha=function(){V$b.Z.Ha.call(this);var a=S(this,"waffle-assistant-feedback-card-link");this.C.Va(a);this.getHandler().V(this.Ba,"mousedown",this.MXb).V(this.C,"action",this.ypb);this.show(!1)};q.MXb=function(a){a.stopPropagation()};
q.show=function(a){var b=this.Ba,c=S(this,"waffle-assistant-feedback-card-link");Ip(b,"waffle-assistant-feedback-card-hidden",!a);on(c,a)};q.ypb=function(){Q.sx.Pb({source:this.D});this.show(!1);this.dispatchEvent(new K("feedback-dialog-opened"))};function dW(){}z(dW,et);qa(dW);dW.prototype.rc=n("waffle-assistant-button");function W$b(){var a;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+T(Ku({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+T(Ku({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function eW(a){xq.call(this,a);this.C=new gt("",new dW,this.oa);this.Ma(this.C);this.D=new gt("",new dW,this.oa);this.Ma(this.D)}z(eW,xq);eW.prototype.Sa=function(){this.Ba=Pr(W$b)};eW.prototype.Ha=function(){eW.Z.Ha.call(this);var a=S(this,"waffle-assistant-thumbs-down-button");this.C.Va(a);NV(a,"Not useful");a=S(this,"waffle-assistant-thumbs-up-button");this.D.Va(a);NV(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.J)};
function X$b(a,b){a.oa.Lf(S(a,"waffle-assistant-thumbs-text"),b)}eW.prototype.F=function(){this.dispatchEvent(new K("thumbs-down"));R(this.Ba,!1)};eW.prototype.J=function(){this.dispatchEvent(new K("thumbs-up"));R(this.Ba,!1)};function fW(a,b){xq.call(this,b);this.D=a;this.X=this.F=this.Y=null;this.Za=new EV(!0,"#4285f4");this.Ma(this.Za);this.jb=this.Zc=this.Ne=!1;this.$=null;this.Ff=this.qc=!1}z(fW,xq);q=fW.prototype;q.zz=v;q.qz=v;q.hOa=Kf;q.IU=Kf;q.d$=Lf;q.ly=v;q.FE=Mf;q.CE=Mf;q.z8=Mf;q.jla=Mf;q.ila=Mf;q.Ue=ea("Ff");q.Gd=f("Ff");q.C9=oa;q.Sa=function(){this.Ba=Pr(T$b)};
q.Ha=function(){fW.Z.Ha.call(this);var a=S(this,"waffle-assistant-card-spinner-container");this.Za.render(a);Lp(S(this,"waffle-assistant-card-inner"),"visibility","hidden");if(this.IU()){var a=this.Ba,b=new wq(a);I(this,b);this.getHandler().V(b,"focusin",this.Ekb).V(b,"focusout",this.Dkb).V(a,"mouseenter",this.ona).V(a,"mouseleave",this.J9)}Y$b(this,!1);dm&&(this.X=new V$b(this.ly(),this.oa),this.X.render(S(this,"waffle-assistant-card-feedback-container")),this.getHandler().V(this.X,"feedback-dialog-opened",
this.zpb).V(this,"trigger_feedback",this.PRb),this.d$()?(this.F=new eW(this.oa),this.F.render(S(this,"waffle-assistant-thumbs-container")),Z$b(this,!0),a=Ta(this.z8()),Ra(a)||X$b(this.F,a),a=Ta(this.jla()),Ra(a)||NV(S(this.F,"waffle-assistant-thumbs-up-button"),a),a=Ta(this.ila()),Ra(a)||NV(S(this.F,"waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.F,"thumbs-down",this.KXb).V(this.F,"thumbs-up",this.LXb)):Z$b(this,!1));this.qz()};
function gW(a){return S(a,"waffle-assistant-card-content-container")}function $$b(a){a.IU();return S(a,"waffle-assistant-card-options")}function Z$b(a,b){dm&&R(S(a,"waffle-assistant-thumbs-container"),a.d$()&&b)}q.lP=function(){this.isDisposed()||(this.Ne=!0,aac(this))};function PV(a,b){!a.Zc&&b&&(a.Zc=!0,aac(a))}function aac(a){if(a.Ne&&a.Zc){var b=y(a.JXb,a);a.zz(b)}}q.ona=function(){this.jb||(Y$b(this,!0),this.jb=!0,el(this.$),this.$=dl(this.ZBa,100,this))};
q.ZBa=function(){this.isDisposed()||(el(this.$),this.$=null,this.Ba.parentNode.querySelector(":hover")==this.Ba?this.$=dl(this.ZBa,100,this):this.J9())};q.J9=function(){Y$b(this,!1);this.jb=!1};q.Ekb=function(){Y$b(this,!0)};q.Dkb=function(){dl(function(){this.isDisposed()||jn(this.Ba,document.activeElement)||this.Ba.parentNode.querySelector(":hover")==this.Ba||Y$b(this,!1)},0,this)};
q.KXb=function(){bac(this,!0);Z$b(this,!1);var a=this.CE();this.dispatchEvent(new MV("assistant-sidepane-thumbs",this,a))};q.LXb=function(){Z$b(this,!1);var a=this.FE();this.dispatchEvent(new MV("assistant-sidepane-thumbs",this,a))};q.zpb=function(){bac(this,!1)};q.PRb=function(){bac(this,!0)};function Y$b(a,b){var c=S(a,"waffle-assistant-card-options");a=a.IU();R(c,a&&b)}q.JXb=function(){this.Za.setActive(!1);R(this.Za.Ba,!1);Lp(S(this,"waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new K("content-rendered"))};
function bac(a,b){Ip(S(a,"waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.X.show(b)};function cac(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function dac(){return V(T(mt({Ee:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:fs(""+T(Ku({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+T(mt({Ee:"waffle-assistant-zoom-button",content:fs(""+T(Ku({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function eac(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(T(a.V4a)+"</span>"),d=0==a.hGa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">\x3c!-- Create chart containers with two in each row. --\x3e';a=a.hGa;for(var e=a.length,g=0;g<e;g++)var h=a[g],c=c+((0==g%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+T(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==g%2||g==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+
(d?" waffle-assistant-facet-white-section":"")+'">'+c+(dm?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function fac(a,b,c,d,e,g,h){xq.call(this,h);this.F=a;this.D=b;this.O=e;this.L=g;this.C=this.dc=null;this.J=Xo(new Wo,10).Fa()}z(fac,xq);q=fac.prototype;q.Ha=function(){fac.Z.Ha.call(this);(new gV(jI,this.D.Og)).send(y(this.Smb,this,this.D))};q.C9=function(a,b){a=new p$b(this.F.clone(),this.O,this.dc,2746,a,b);this.dispatchEvent(a)};q.Smb=function(a,b){b&&(b.ri()?JH.Yz(this.Ba,b):(b=b.Pe(),a.Df(b),uV(a,b),KH(a,"ready",y(this.CXb,this,a)),BV(a,this.Ba,om),this.dc=b))};
q.CXb=function(a){a.Yl()&&(KH(a.Yl(),"onmouseover",y(this.AXb,this)),KH(a.Yl(),"onmouseout",y(this.BXb,this)))};q.AXb=function(){this.C=Ha()};q.BXb=function(){Ca(this.C)&&500<Ha()-this.C&&this.L.Ob(2750,this.J);this.C=null};function gac(a,b,c,d,e){xq.call(this,e);this.L=a;this.Ka=b;this.ea=c;this.R=d;this.O=Ec(this.L,23);this.Da=D(this.L,22);this.D=D(this.L,26);this.$=[];this.Na=new Ii;this.X=this.F=this.C=null;this.Ff=!1;this.Y=new nt("",this.oa);this.Ma(this.Y);this.J=null}z(gac,xq);q=gac.prototype;q.Sa=function(){gac.Z.Sa.call(this);this.Ba=Pr(eac,{V4a:this.D,hGa:this.O});this.Ba.style.visibility="hidden"};
q.Ha=function(){gac.Z.Ha.call(this);var a=S(this,"waffle-assistant-facet-toggle");this.Y.Va(a);this.getHandler().V(this.Ba,"mousedown",this.xXb).V(this.Y,"action",this.PBb);dm&&(this.X=new V$b("assistantAutovisFacetFeedback",this.oa),this.X.render(S(this,"waffle-assistant-facet-feedback-container")),this.C=new eW(this.oa),this.Ma(this.C),this.C.render(S(this,"waffle-assistant-facet-thumbs-container")),X$b(this.C,this.O.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,
"thumbs-up",this.zXb).V(this.C,"thumbs-down",this.yXb));hac(this,yoa)};q.Gd=f("Ff");q.Ue=function(a){this.Ff=a;iac(this)};q.xXb=function(a){a.stopPropagation()};q.PBb=function(){var a=Dp(S(this,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");hac(this,a);jac(this,a?2647:2646)};
function hac(a,b){var c=S(a,"waffle-assistant-facet-toggle");mn(c,b?"HIDE":"SHOW");Ip(S(a,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(zq(a,"waffle-assistant-faceted-chart"),function(a){on(a,b)});a.C&&R(a.C.Ba,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');NV(c,b?a:d)}
function kac(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function lac(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function iac(a){a.R&&!a.Ff&&A(a.$,y(function(a){var b=a.Ba;if(!this.R.contains(b)){var d=this.R;a=new mac(b,a);tib(d,a)}},a))}q.zXb=function(){jac(this,2649)};q.yXb=function(){jac(this,2648);this.X.show(!0)};function jac(a,b){var c=a.ea,d=new z9b,e=a.J.getChartType();d.F=e;e=a.J.Pe();d.D=e?e.clone():null;w9b(c,b,d,10,a.J,a.J.Og)};function hW(a,b,c,d,e,g){fW.call(this,a,g);this.C=a.getAutovisRecommendation();this.qf=b;this.Oe=c;this.R=d;this.Xa=e;this.O=new nt("",this.oa);this.Ma(this.O);this.$a=new nt("",this.oa);this.Ma(this.$a);this.Ze=new Ii;this.Yd=null;this.Na=!1;this.Ed=[];this.dd=[];this.Tb=[];this.Ua=this.Ka=this.J=this.L=this.Da=null;this.ea=Xo(new Wo,10).Fa()}z(hW,fW);
var nac={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}},oac=["BarChart","ColumnChart"],iW={sXa:"waffle-assistant-after-chart-preview",OXa:"waffle-assistant-before-chart-preview",aYa:"waffle-assistant-card-draggable",
s3:"waffle-assistant-chart-highlights",k_a:"waffle-assistant-insert-chart-button",cfa:"waffle-assistant-chart-preview",X0a:"waffle-assistant-button-separator",s1a:"waffle-assistant-styled-border",t1a:"waffle-assistant-styled-rect",t2a:"waffle-assistant-zoom-button"};q=hW.prototype;q.zz=function(a){this.Yd=a;pac(this)};q.qz=function(){qac(this,y(function(a){a=v9b(this.qf,a);Bp(this.Ba,a)},this),!1)};q.hOa=Lf;q.IU=Lf;q.ly=n("autovisFeedback");q.FE=n(2208);q.CE=n(2207);q.z8=n("Was this chart useful?");
q.Sa=function(){hW.Z.Sa.call(this);gW(this).appendChild(Pr(cac));$$b(this).appendChild(Pr(dac));zc(this.C,22)&&(this.J=new gac(this.C,this.Y,this.R,this.Xa,this.oa),this.Ma(this.J,!0),this.J.Ue(this.Gd()))};
q.Ha=function(){hW.Z.Ha.call(this);Ep(this.Ba,iW.aYa);var a=S(this,iW.k_a);this.O.Va(a);NV(a,"Insert chart");a=S(this,iW.t2a);this.$a.Va(a);NV(a,"View full size");var a=S(this,iW.OXa),b=S(this,iW.cfa),c=S(this,iW.sXa);this.getHandler().V(this.Ba,"keydown",this.uXb).V(b,"click",this.jlb).V(a,"focus",this.ikb).V(c,"focus",this.djb).V(this.O,"action",this.Trb).V(this.O.Ba,"mousedown",this.Qua).V(this.$a,"action",this.zDb).V(this.$a.Ba,"mousedown",this.Qua).V(S(this,iW.s3),"mousedown",this.Qua).V(qw(this.qf),
"Ib",this.vXb);rac(this);this.R.Ob(2790,this.ea);this.J&&this.R.Ob(2791,this.ea)};q.Ue=function(a){hW.Z.Ue.call(this,a);rac(this);this.mc()&&sac(this)};function rac(a){if(a.mc()){var b=a.Gd();a.O.setVisible(!b);a=yn(a.oa,iW.X0a,$$b(a));R(a,!b)}}q.uXb=function(a){13==a.keyCode&&a.target==this.Ba&&(a.preventDefault(),a.stopPropagation(),tac(this,2255))};
function uac(a){for(var b=a.getChartType(),c=!!D(a.C,14),d=D(a.C,16),e=!!D(a.C,15),g="Histogram"==b,h="PieChart"==b,k=vac(a),l=1<k.length,m=[],b=0;b<k.length;b++){var p=wac(k[b].rect,c!=h);Ob(m,p)}var b=aB(a.Oe).td(),r=wb(gc(Wg),b.v2,b),c=wb(m,function(a){return wb(r,Fa(uh,a))});g&&e&&(c=Pb(c,1));a.Tb=xac(c.length,h&&0<d||!g&&!h&&e,h&&l);d=aB(a.Oe);for(b=0;b<c.length;b++)for(e=a.Tb[b],g=0;g<c[b].length;g++)c[b][g]&&Gh(c[b][g])&&(h=HT(d,c[b][g],iW.t1a),I(a,h),XF(OI(d),h,!0),Lp(h.Ba,"background-color",
e),h.setVisible(!0),a.Ed.push(h),h=lI(d,c[b][g],iW.s1a,1,0),I(a,h),VZa(h,e),h.setVisible(!0),a.dd.push(h))}function yac(a){Jc(a.Ed);Jc(a.dd);a.Ed=[];a.dd=[];a.Tb=[]}q.vXb=function(){this.Na&&(yac(this),uac(this))};q.ona=function(){hW.Z.ona.call(this);this.Ka=Ha();this.Na||(uac(this),this.Na=!0)};q.J9=function(){hW.Z.J9.call(this);Ca(this.Ka)&&500<Ha()-this.Ka&&this.R.Ob(2789,this.ea);this.Ka=null;yac(this);this.Na=!1};q.jlb=function(){this.Ba.focus()};
q.ikb=function(){var a=S(this,iW.s3);if(gq(a))a.focus();else{if(a=this.F)a=S(this.F,"waffle-assistant-thumbs-up-button"),gq(a)?(a.focus(),a=!0):a=!1;a||this.O.Ba.focus()}};q.djb=function(){var a;if(a=this.X)a=this.X,S(a,"waffle-assistant-feedback-card-hidden")?a=!1:(S(a,"waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Ba.focus()};q.Trb=function(){this.R.Ob(2255,this.ea);tac(this,2255)};q.Qua=function(a){a.stopPropagation()};q.zDb=function(){X.M2.Pb(this)};
q.C9=function(a,b){tac(this,2257,a,b)};function tac(a,b,c,d){qac(a,y(function(a){a=new p$b(a,this.Y,this.L&&this.L.Pe(),b,c,d);this.dispatchEvent(a)},a),!1)}
q.wXb=function(a,b){if(b){var c=S(this,iW.cfa);if(b.ri())JH.Yz(c,b);else{a.Df(b.Pe());uV(a,a.Pe());ZT(a,"ready",y(this.tXb,this,a));b=[];try{var d=new cf;d.setContext(a.toJSON());var e=!!D(this.C,14);E(d,3,e);var g=D(this.C,16);E(d,4,g);E(d,5,"ROWS"==(e?"ROWS":"COLS"));E(d,8,0);if(D(this.C,24)){var h=D(this.C,25);E(d,9,h)}for(var k=vac(this),e=0;e<k.length;e++)d.addRange(Mh(k[e].rect,k[e].ud));var l=this.Ze.serialize(d);b=wb(E9b(Fa(ritz.getVerbalHighlightsForProto,l),a).call(),B9b)}catch(m){b=[]}d=
S(this,iW.s3);R(d,0<b.length);0<b.length&&(d.appendChild(b[0]),on(d,!0));this.L=a;BV(a,c,om)}}};q.tXb=function(a){null!==this.Da&&(rJ(pJ.getInstance(),this.Da),this.Da=null);this.isDisposed()||(a.Yl()&&(KH(a.Yl(),"onmouseover",y(this.rXb,this)),KH(a.Yl(),"onmouseout",y(this.sXb,this))),this.Yd(),sac(this))};q.rXb=function(){this.Ua=Ha()};q.sXb=function(){Ca(this.Ua)&&500<Ha()-this.Ua&&this.R.Ob(2795,this.ea);this.Ua=null};
function sac(a){if(a.Xa&&!a.Gd()){var b=S(a,iW.cfa);if(!a.Xa.contains(b)){var c=a.Xa;a=new mac(b,a);tib(c,a)}}}
function zac(a){a.qc&&(a.Da=qJ(pJ.getInstance(),jj.sva),a.qc=!1);var b=new VH(tc(nac)),c=a.C.getChartType(),d=D(a.C,16);"PieChart"==c?(b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled")):0>=d&&b.setOption("legend.position","none");b.setOption("title",D(a.C,2));b.setOption("hAxis.title",D(a.C,3));zc(a.C,4)&&b.setOption("hAxis.viewWindow.min",D(a.C,4));zc(a.C,5)&&b.setOption("hAxis.viewWindow.max",D(a.C,5));b.setOption("vAxes.0.title",D(a.C,6));zc(a.C,7)&&b.setOption("vAxes.0.viewWindow.min",
D(a.C,7));zc(a.C,8)&&b.setOption("vAxes.0.viewWindow.max",D(a.C,8));b.setOption("vAxes.1.title",D(a.C,9));zc(a.C,10)&&b.setOption("vAxes.1.viewWindow.min",D(a.C,10));zc(a.C,11)&&b.setOption("vAxes.1.viewWindow.max",D(a.C,11));b.setOption("useFirstColumnAsDomain",D(a.C,15));b.setOption("isStacked",D(a.C,17));b.setOption("treatLabelsAsText",Cb(oac,c));b.Dh(c);d=Ec(a.C,12);if(!D(a.C,24)&&d&&d.length)if(b.setOption("applyAggregateData",0),d=Ec(a.C,13),"PieChart"===c)b.setOption("aggregateFunction",d[0]);
else for(c=0;c<d.length;c++)b.setOption("series."+c+".aggregateFunction",d[c]);b.dca(jI);var c=vac(a),d=!!D(a.C,14),e=D(a.C,16)||0,d=r5a("/gviz/tq").ek("").hb("transpose",d?"1":"0").hb("headers",e.toString()).hb("hds",0).hb("merge",d?"ROWS":"COLS").hb("authkey",tm("authKey"));D(a.C,24)&&d.hb("dt",encodeURIComponent(JSON.stringify(a.Ze.serialize(D(a.C,25)))));z5a(d,c);b.Mi(d.toString());a.J&&(c=d.clone(),a.J.F=c);return b}
function pac(a){var b=zac(a);b.setOption("legend.position","none");b.setOption("hAxis.slantedText",0);b.setOption("hAxis.textStyle.fontSize",11);b.setOption("vAxes.0.textStyle.fontSize",11);b.setOption("vAxes.1.textStyle.fontSize",11);b.setOption("fontStyle.size",10);b.setOption("fontStyle.italic",!1);b.setOption("titleTextStyle.bold",!1);b.setOption("titleTextStyle.fontSize",12);b.setOption("async",40);!1!==b.Ub("useFirstColumnAsDomain")&&b.Pe()&&"number"===b.Pe().Yc(0)&&b.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==b.Ub("useFirstColumnAsDomain")&&b.Pe()&&"string"===b.Pe().Yc(0)){var c=0,d=Vm("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";S(a,"waffle-assistant-card-inner").appendChild(d);for(var e=0;e<b.Pe().getNumberOfRows();e++)mn(d,b.Pe().yf(e,0)),c=Math.max(c,kq(d).width);bn(d);c=Math.min(27,Math.max(15,10+100*c/271))}b.setOption("chartArea.top","15%");d=b.Ub("hAxis.title");b.setOption("chartArea.height",Ra(Ta(d))?"80%":"65%");b.setOption("chartArea.left",c+"%");b.setOption("chartArea.width",
95-c+"%");"PieChart"==b.getChartType()&&(b.setOption("chartArea.top",Ra(Ta(b.Ub("title")))?"12%":"15%"),b.setOption("chartArea.height","70%"),b.setOption("chartArea.left","0%"),b.setOption("chartArea.width","100%"),b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled"),b.setOption("legend.textStyle.fontSize",10));(new gV(jI,b.Og)).send(y(a.wXb,a,b));a.J&&qac(a,y(function(a){var c=this.J,d=b;a=new VH(a.toJSON());var d=new VH(d.toJSON()),e=zq(c,"waffle-assistant-faceted-chart");
if(1<e.length){lac(a);var g=d;kac(g);g.setOption("pieSliceText","percentage");g.setOption("axisFontSize",0);g.setOption("hAxis.title",null);g.setOption("hAxis.textPosition","none");g.setOption("vAxes.0.title",null);g.setOption("vAxes.0.textPosition","none");g.setOption("vAxes.1.title",null);g.setOption("vAxes.1.textPosition","none");g.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});g.setOption("legend","none");g.setOption("titleTextStyle.fontSize",0)}else g=a,lac(g),g.setOption("applyAggregateData",
void 0),g.setOption("legend","right"),kac(d);for(var g=z5a,p=c.F,r=Ec(c.L,27),t=[],w=0;w<r.length;w++)t.push(ET(r[w]));g(p,t);g=D(c.L,25);for(p=0;p<e.length;p++){var r=ya(c.O[p])?c.O[p]:null,w=t=g.clone(),x=c.Da,C=r,F=new hf;E(F,1,x);ya(C)&&F.Wa(C);E(w,7,F);c.F.hb("dt",encodeURIComponent(JSON.stringify(c.Na.serialize(t))));w=new VH(a.toJSON());w.Mi(c.F.toString());t=d.clone();t.Mi(c.F.toString());var C=c,G=w,x=r;(F=G.Ub("title"))||(F=h$b(G));G=F+(' when "'+(C.D+('" is "'+(x+'"'))));C=F+(' by "'+(C.D+
'"'));x=x?G:C;w.setOption("title",x);t.setOption("title",x);x=new fac(w,t,0,0,c.Ka,c.ea,c.oa);c.Ma(x);C=e[p];x.Va(C);c.$.push(x);x=c;F=h$b(w);w=F+(' broken down by "'+(x.D+('" for "'+(r+'"'))));x=F+(' broken down by "'+(x.D+'"'));Bp(C,r?w:x);c.J=t}iac(c);c.Ba.style.visibility="visible"},a),!1)}function qac(a,b,c){var d=zac(a);(new gV(jI,d.Og)).send(function(a){a?(a=a.Pe(),c&&d.Df(a),uV(d,a),b(d)):b(null)})}function vac(a){a=Ec(a.D,4);for(var b=[],c=0;c<a.length;c++)b.push(ET(a[c]));return b}
q.getChartType=function(){return this.C.getChartType()};function xac(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=J7b("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Ob(d,d);return d}function wac(a,b){return b?f$b(a,new hh(a.width,1)):f$b(a,new hh(1,a.height))};function Aac(){mL.call(this);this.La.push(this);this.va=this.ea=!0;this.Na="waffle-assistant-dragged-card"}z(Aac,sib);Aac.prototype.contains=function(a){return!!A(this.J,function(b){if(b.element==a)return!0})};Aac.prototype.Ela=function(a){var b=Aac.Z.Ela.call(this,a);if(eU()||om){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=wb(b.querySelectorAll("clippath"),function(a){return a.id}),Bac(b,a);return b};
function Bac(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];ya(c)&&db(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=dn(a);for(d=0;d<a.length;d++)Bac(a[d],b)}function mac(a,b){oL.call(this,a,b)}z(mac,oL);mac.prototype.Gla=f("element");function Cac(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function jW(a,b){fW.call(this,a,b);this.C=a.getAutovisRecommendation()}z(jW,fW);q=jW.prototype;q.qz=oa;q.ly=n("assistantWordCloudFeedback");q.FE=n(2634);q.CE=n(2633);q.Sa=function(){jW.Z.Sa.call(this);gW(this).appendChild(Pr(Cac));Ep(gW(this),"waffle-assistant-word-cloud-content-container")};
q.zz=function(a){for(var b=Ec(this.C,19),c=Ec(this.C,20),d=S(this,"waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(this.Sk(b,c,e),120<d.clientHeight){this.Sk(b,c,e-1);break}b=this.oa;c=D(this.C,2);c=Bn(b,c);d=S(this,"waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
q.Sk=function(a,b,c){for(var d=S(this,"waffle-assistant-word-cloud-words-container"),e=this.oa;d.firstChild;)d.removeChild(d.firstChild);for(var g=b[c],h=b[0],k=0;k<=c;k++){0!=k&&d.appendChild(Bn(e," "));var l=e.createElement("SPAN");e.appendChild(l,Bn(e,a[k]));e.appendChild(d,l);Ep(l,"waffle-assistant-word-cloud-word");var m=b[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-g)/(h-g)*15+9+"px"}};function kW(a,b,c,d,e){QV.call(this,20,d,c,e);this.ea=a;this.$=b;this.C=new Aac;I(this,this.C);this.F=null;this.Y=0}z(kW,QV);q=kW.prototype;q.Ha=function(){kW.Z.Ha.call(this);this.C.Te();this.getHandler().V(this.C,"drag",this.qXb).V(this.C,"dragend",this.pXb)};q.JU=n("Analysis");q.e5=function(a){return 0==a};q.GX=function(a){return"WordCloud"==a.getAutovisRecommendation().getChartType()?new jW(a,this.oa):new hW(a,this.ea,this.$,this.O,this.C,this.oa)};q.Ue=function(a){kW.Z.Ue.call(this,a);a&&aib(this.C)};
q.RJa=function(a){Gf(this.getHandler(),a,"content-rendered",this.oXb);this.Y++};q.oXb=function(){0==--this.Y&&this.dispatchEvent("assistant-done-rendering")};q.qXb=function(){this.F=Zp(this.C.Vc.target)};q.pXb=function(a){var b=this.F,c=aB(this.$).C;if(mh(QE(c,"page",!1,!1)).contains(b)){var d=OE(c,b.x,b.y,"page"),c=SE(c,sh(d),"page"),b=new N(b.x-c.left,b.y-c.top);a.C.getData().C9(d,b)}this.F=null};q.Nda=n(2);function Dac(a){for(var b=0;b<Eac.length;++b)if(-1!=Bb(Eac[b].vj,function(b){return Ma(a,b)}))return b;return-1};function Fac(a,b,c,d,e){this.C=a;this.bga=b;this.F=d;this.Xn=c;this.L=d?Ec(d,6):[];this.O=d?Ec(d,7):[];this.J=d?Ec(d,8):[];this.error=e||1;this.interpretation=moa&&d&&zc(d,4)?D(d,4):null;this.D=noa&&d?Ec(d,12):[]}function Gac(a){return{tT:Hac(a),interpretation:a.interpretation,bga:a.bga,Xn:a.Xn}}function Iac(a){return{tT:Hac(a),error:Jac(a)}}
function Jac(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer. Please try again.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about you data.";case 6:return a.F.getError().El()||"";case 7:return a=Dac(a.C),-1!=a?Eac[a].xg:""}return""}
function Hac(a){var b=[];if(loa&&1==a.error&&null!=a.Xn){var c=[];A(Lb(a.L,a.J),function(a){c.push(Kac(a,"waffle-assistant-answercard-question-unused-phrase"))},a);A(a.O,function(a){c.push(Kac(a,"waffle-assistant-answercard-question-used-entity"))},a);Tb(c,function(a,b){return a.lC>b.lC?1:-1});var d=0;A(c,function(a){a.lC>d&&b.push({text:this.C.substring(d,a.lC),className:null});d=a.lC+a.length;b.push({text:this.C.substring(a.lC,d),className:a.Ck})},a);d<a.C.length&&b.push({text:a.C.substring(d),
className:null})}else b.push({text:a.C,className:null});return b}function Kac(a,b){return{lC:D(a,2),length:D(a,3),Ck:b}}function Lac(a,b,c){return new Fac(a,null,null,c||null,b)};function lW(a,b,c,d){L.call(this);this.R=a;this.X=b;this.Y=c;this.Ga=d;this.qa=new M(this);I(this,this.qa);this.C=new yU;I(this,this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.Ff=!1;N6b(this.C,this.R);this.C.X=10;this.C.ea=!0;this.C.L=!1;this.C.hsa("waffle-assistant-visible");this.C.R=Ya("waffle-assistant-dragged-formula").split(" ");this.C.Te();this.qa.V(this.C,"beforedragstart",this.va).V(this.C,"dragmove",this.ea).V(this.C,"beforedragend",this.$)}z(lW,L);lW.prototype.Ue=ea("Ff");
lW.prototype.va=function(a){a=tb(this.R.childNodes,a.C);this.O=this.L[a]};
lW.prototype.ea=function(a){var b=a.event instanceof vq?a.event.C:a.event;this.Ff?(a.Y.Dw(b,!0),a.preventDefault()):(Rp(a.F,a.event.clientX,a.event.clientY),a=Sp(a.F),b=aB(this.X).C,mh(QE(b,"page",!1,!1)).contains(a)?(a=OE(b,a.x,a.y,"page"),(b=ay(sw(this.Y),a.y,a.x))?a=new N(b.Wb(),b.fc()):b=sh(a),this.J=a,this.D&&this.D.tc().equals(b)||(a=aB(this.X),J(this.D),this.D=HT(a,b,"waffle-assistant-formula-insertion-rect"),I(this,this.D),XF(OI(a),this.D),J(this.F),this.F=lI(a,b,"waffle-assistant-formula-insertion-border",
2,0),I(this,this.F),VZa(this.F,"#000"),this.F.setVisible(!0))):Mac(this))};lW.prototype.$=function(a){if(this.J){var b=this.J,c=sw(this.Y),b=new hF(c,b,this.O);this.Ga.C(b);this.dispatchEvent(new K("formula_inserted"))}a.Y.Dw(null,!0);a.preventDefault();this.O="";Mac(this)};function Mac(a){a.J=null;J(a.D);a.D=null;J(a.F);a.F=null};function Nac(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+Oac({tT:a.N4.tT}),d;d=a.N4.bga;var e=a.N4.Xn;a=a.N4.interpretation;null==d||ta(d);a=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+is("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(a?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
T(a)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){a+='<div class="waffle-assistant-answercard-answer">';for(var g=d.length,h=0;h<g;h++){var k=d[h],l=1<k.length;if(0==h&&l){a+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=k.length,m=0;m<l;m++)a+='<span class="waffle-assistant-answercard-answer-col">'+T(k[m])+"</span>"}else for(l="waffle-assistant-answercard-answer-row"+(l?" waffle-assistant-answercard-answer-list-row":""),l=es(l),a+=
'<div class="'+W(l)+'">',l=k.length,m=0;m<l;m++){var p=k[m];a=p?a+('<span class="waffle-assistant-answercard-answer-col">'+T(p)+"</span>"):a+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}a+="</div>"}a+="</div>"}a+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+
T(Ku({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+T(e)+"</div></div></div></div></div></div>";d=V(a);return b(c+d+"</div></div>")}
function Oac(a){a=a.tT;var b;b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+is("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+T(e.text)+"</span>":T(e.text)}return V(b+"</div></div></div>")}
function Pac(){return V(T(V('<div class="waffle-assistant-answers-card-remove">'+T(Ku({icon:"docs-icon-img docs-icon-trash"}))+"</div>")))};var Qac="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this".split(";"),Eac=[{vj:["Thank you"],xg:"No problem"},{vj:["you are amazing","This is great","omg"],xg:"Happy to help"},{vj:["I love you"],xg:"Must be in the air"},{vj:["How do you know"],xg:"It's all in the data"},{vj:["Are you sure"],xg:"Send feedback if this doesn't seem correct to help improve accuracy"},{vj:["How are you"],xg:"Pretty good, thanks"},{vj:["Hi","Hello","Hey"],xg:"Hi, there. Try asking a question about your data."},
{vj:["You are stupid","This is dumb","You are wrong"],xg:"Help improve this experience by sending feedback"},{vj:["How smart are you"],xg:"Pretty smart"}];function Rac(a,b,c,d){K.call(this,"sqc");this.Y=a;this.C=d||"";this.F=c}z(Rac,K);function mW(a,b,c,d,e,g,h,k){fW.call(this,new aW,k);this.L=a;this.Da=b;this.Xa=c;this.Ua=d;this.$a=g;this.ea=e;this.Ka=h;this.Na=Xo(new Wo,10).Fa();this.R=new gt("",new dW,this.oa);this.Ma(this.R);this.C=null;this.J=new gt("",new cW,this.oa);this.Ma(this.J);this.O=new gt("",new cW,this.oa);this.Ma(this.O)}z(mW,fW);q=mW.prototype;q.lka=f("Ka");q.Sa=function(){mW.Z.Sa.call(this);$$b(this).appendChild(Pr(Pac))};
q.Ha=function(){mW.Z.Ha.call(this);var a=S(this,"waffle-assistant-answers-card-remove");this.R.Va(a);NV(a,"Remove card",0);Gf(this.getHandler(),this.R,"action",this.EXb).V(this.J,"action",this.pzb).V(this.O,"action",this.Wqb)};
q.zz=function(a){gW(this).appendChild(Pr(Nac,{N4:Gac(this.L)}));this.J.Va(S(this,"waffle-assistant-answercard-see-formula-link"));this.O.Va(S(this,"waffle-assistant-answercard-hide-formula-link"));this.C=new lW(S(this,"waffle-assistant-answercard-formula-text-container"),this.Da,this.Xa,this.Ua);this.C.Ue(this.Gd());this.C.L=[this.L.Xn];I(this,this.C);var b=S(this,"waffle-assistant-answercard-formula-text");Bp(b,"Formula: "+(this.L.Xn+". Click/Press ENTER to copy or drag to insert on to sheet."));
If(this.getHandler().V(this.C,"formula_inserted",this.DXb),S(this,"waffle-assistant-answercard-formula-text"),md,this.nqb);Sac(this,!1);a()};q.qz=function(){Bp(this.Ba,"Answer Card for question: "+this.L.C)};q.IU=Lf;q.ly=n("assistantAnswersFeedback");q.FE=n(2628);q.CE=n(2627);q.z8=n("Was this answer correct?");q.jla=n("Correct");q.ila=n("Incorrect");q.B7=f("L");q.Ue=function(a){mW.Z.Ue.call(this,a);this.C&&this.C.Ue(a)};
function Sac(a,b){a.J.setVisible(!b);a.O.setVisible(b);R(S(a,"waffle-assistant-answercard-formula"),b);b?S(a,"waffle-assistant-answercard-formula-text").focus():(a.J.Ba.focus(),a.J.Xq(!0))}q.EXb=function(){var a=new LV;P(a,3,!0);var b=new KT;dj(b,4,a);a=new jo;dj(a,46,b);this.ea.Ob(2753,new Vo(10,a));this.dispatchEvent(new K("rc"))};q.pzb=function(){Sac(this,!0)};q.Wqb=function(){Sac(this,!1)};q.DXb=function(){this.ea.Ob(2709,this.Na)};
q.nqb=function(){var a=this.oa.wb(),b=a.createElement("textarea");b.textContent=this.L.Xn;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&Tac(this.$a,"Formula copied to clipboard",this.oa)};function Uac(){var a;a=es("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+T(Ku({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function Vac(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+T(Oac({tT:a.VFa.tT})),d;d=a.VFa.error;var e=!!a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+T(Ku({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';e?(d=T(d)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',
a+='<div class="waffle-assistant-errorcard-text">'+d+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+T(d)+"</div>";d=V(a+"</div></div>");return b(c+d+"</div></div>")}function Wac(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function nW(a,b,c,d,e){fW.call(this,new aW,e);this.O=a;this.ea=b;this.L=d;this.Da=c;this.R=new gt("",new dW,this.oa);this.Ma(this.R);this.J=new gt("",new cW,this.oa);this.Ma(this.J);this.C=new gt("",new cW,this.oa);this.Ma(this.C)}z(nW,fW);q=nW.prototype;q.qz=function(){Bp(this.Ba,"Error Card for question: "+this.O.C)};q.ly=n("assistantAnswersFeedback");q.IU=Lf;q.d$=Kf;q.Sa=function(){nW.Z.Sa.call(this);$$b(this).appendChild(Pr(Pac))};
q.Ha=function(){nW.Z.Ha.call(this);var a=S(this,"waffle-assistant-answers-card-remove");this.R.Va(a);this.C.setVisible(this.L);NV(a,"Remove card",0);Gf(Gf(this.getHandler(),this.R,"action",this.IXb),this.J,"action",this.Czb).V(this.C,"action",this.Sqb)};
q.zz=function(a){gW(this).appendChild(Pr(Vac,{VFa:Iac(this.O),showHelp:this.L}));if(dm){var b=Pr(Wac);this.oa.appendChild(this.Ba,b);this.J.Va(S(this,"waffle-assistant-answercard-feedback-link"))}this.L&&this.C.Va(S(this,"waffle-assistant-answers-helpcenter-link"));a()};q.lka=f("ea");q.B7=f("O");q.Czb=function(){this.J.setVisible(!1);R(S(this,"waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new K("trigger_feedback"))};
q.IXb=function(){var a=new LV;P(a,3,!1);var b=new KT;dj(b,4,a);a=new jo;dj(a,46,b);this.Da.Ob(2753,new Vo(10,a));this.dispatchEvent(new K("rc"))};q.Sqb=function(){Q.In.Pb()};function Xac(a){fW.call(this,new aW,a);this.C=this.oa.createElement("div");mn(this.C,"Previous")}z(Xac,fW);q=Xac.prototype;q.qz=function(){Bp(this.Ba,"Previous questions below")};q.Sa=function(){Xac.Z.Sa.call(this);Gp(this.Ba,"waffle-assistant-card");Ep(this.Ba,"waffle-assistant-answers-previousheadercard")};q.zz=function(a){0<this.oa.Ch(gW(this)).length||gW(this).appendChild(this.C);a()};q.d$=Kf;q.ly=n("assistantAnswersFeedback");function Yac(a){var b;b=""+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+T(a.title)+"</div>":"");var c;c=es("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.$Qb;for(var d=a.length,e=0;e<d;e++){var g=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+T(Ku({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+
T(g)+"</div></div></div>"}return V(b+"</div>")};function oW(a,b,c,d,e){fW.call(this,a,e);this.J=c;this.C=d;this.L=b}z(oW,fW);q=oW.prototype;q.FE=function(){return Cb([Zac,$ac],this.C)?2799:Cb([abc,bbc],this.C)?2801:null};q.CE=function(){return Cb([Zac,$ac],this.C)?2798:Cb([abc,bbc],this.C)?2800:null};q.z8=n("Were these interesting?");q.jla=n("Interesting");q.ila=n("Not interesting");q.ly=n("assistantAnswersFeedback");q.qz=function(){var a=this.C.title;a&&this.J?Bp(this.Ba,a+(" for question : "+this.J)):Bp(this.Ba,"Suggested questions")};
q.zz=function(a){this.L.then(function(b){if(0==b.length)R(this.Ba,!1);else{var c=this.oa,d=gW(this);if(0==c.Ch(d).length){var e=Pr(Yac,{title:this.C.title,$Qb:wb(b,function(a){return a.query})});d.appendChild(e);d=zq(this,"waffle-assistant-answercard-question-container");A(d,function(a,d){var e=new gt("",new dW,c);this.Ma(e);e.Va(a);this.getHandler().V(e,"action",y(this.gBb,this,b[d]))},this)}}a()},null,this)};q.gBb=function(a){this.dispatchEvent(new Rac(this.C.L1,0,a.Xn||null,a.query))};
var cbc={title:"",L1:null},Zac={title:"",L1:1},$ac={title:"Suggested questions",L1:1},bbc={title:"Did you mean?",L1:4},abc={title:"Related questions",L1:4};function dbc(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){var g;do g=Math.floor(Math.random()*a);while(d[g]);d[g]=1;c.push(g)}else{for(e=0;e<a;e++)c.push(e);for(e=0;e<b;e++)d=Math.floor(Math.random()*(a-e)+e),g=c[e],c[e]=c[d],c[d]=g}return c.slice(0,b)}function pW(a){return dbc(a,1)[0]}function ebc(a){var b=0;A(a,function(c,d){c.length>a[b].length&&(b=d)});return wb(a[b],function(b,d){return wb(a,function(a){return a[d]})})};function fbc(a){this.J=[];this.D={};this.L=a;this.C=new gP}function gbc(a,b,c,d){function e(a){return a.toLowerCase()}Qb(b,void 0,e);Qb(c,void 0,e);Qb(d,void 0,e);A(b,a.F,a);A(c,a.F,a);A(d,a.F,a)}fbc.prototype.F=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,g=b.substr(d),h=this.C.get(g);h||(h=[],this.C.add(g,h));h.push(e)}};
fbc.prototype.mG=function(a,b,c){var d;if(Ya(a||"")){d=this.L.Vl();d=hbc(this,a.substring(0,d));var e=ibc(this,b-d.length,a);d=Lb(d,e)}else d=ibc(this,b);d.length>b&&(d=Pb(d,0,b));c(a,d)};function ibc(a,b,c){var d=c||"";c=bc(a.D,function(a){return Ma(a,d)});var e=jbc(gc(c),d?1:2,1);a=vb(a.J,function(a){return Ma(a.query,d)&&!e[a.query.toLowerCase()]});b=jbc(a,b-fc(e),2);return Lb(gc(b),gc(e))}
function hbc(a,b){for(var c=[],d=3,e={},g=b.toLowerCase(),h=0;h<g.length&&0<d;++h)if(0==h||" "==g[h-1]&&" "!=g[h]){var k={},l=0,m=g.substr(h),p=a.C.xe(m);A(p,function(a){var b=a.length-m.length;l=Math.max(b,l);a=this.C.get(a);k[b]||(k[b]=[]);Ob(k[b],a)},a);for(p=0;p<=l&&0<d;++p){var r=k[p];if(r)for(var t=0;t<r.length&&0<d;++t){var w=r[t];db(b.toLowerCase(),w.toLowerCase())||e[w]||(--d,c.push({text:w,Xn:"",lz:0,TBa:g.length-h}),e[w]=!0)}}}return c}
function jbc(a,b,c){b=dbc(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=ya(b)?b:b.query;d[e.toLowerCase()]={text:e,Xn:ya(b)?"":b.Xn,lz:c,TBa:0}});return d};function qW(){MF.call(this,"",null,!1)}z(qW,MF);qW.prototype.WB=function(a,b){if(2==a.lz||1==a.lz)return qW.Z.WB.call(this,a.text,b);var c=this.Ia(),d=this.Vl(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var g=c.substring(0,d-a.TBa)+a.text;e||(g+=" ");a=qW.Z.WB.call(this,{toString:function(){return g+c.substring(d)}},b);this.e1(g.length);b=this.Ej;b.blur();b.focus();return a};
qW.prototype.Ig=function(a){var b=qW.Z.Ig.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,GYa(b)&&b.cF()&&a.preventDefault(),b=!0);return b};function kbc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+T(Ku({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+T(Ku({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+T(Ku({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function lbc(a){this.C=a||Im()}
lbc.prototype.FL=function(a,b,c){b=Pr(kbc);var d=yn(this.C,"waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.C.Lf(d,a.text);var d=yn(this.C,"waffle-assistant-answers-ac-entity-icon",b),e=yn(this.C,"waffle-assistant-answers-ac-suggested-query-icon",b),g=yn(this.C,"waffle-assistant-answers-ac-session-query-icon",b);R(d,0==a.lz);R(e,2==a.lz);R(g,1==a.lz);d="";switch(a.lz){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Ep(c,d);this.C.appendChild(c,b)};function rW(a,b,c,d,e,g,h,k,l){OV.call(this,l);this.qf=c;this.xk=d;this.qj=e;this.Bi=a;this.Ab=h;this.Da=this.R=this.J=this.jb=null;this.ea=new qW;this.ea.LGa=!0;this.ea.ea=!0;this.Ka=new fbc(this.ea);a=new KF(null,new lbc(l));this.F=new FF(this.Ka,a,this.ea);I(this,this.F);this.L=g;this.Ed=this.Y=null;this.Kg=k;this.Za=!1;this.Ua=Xo(new Wo,10).Fa();this.wk=new Ii;this.Na={};this.X=this.C=this.qc=null;this.dd=[];this.Zc=[];this.Zg=pJ.getInstance();this.$a=""}z(rW,OV);q=rW.prototype;
q.Sa=function(){rW.Z.Sa.call(this);var a=this.F.Qe();a.className="waffle-assistant-answers-ac-renderer";a.Yh="waffle-assistant-answers-ac-row";a.Pr="waffle-assistant-answers-ac-active";a.oI="waffle-assistant-answers-ac-highlighted"};q.Ha=function(){rW.Z.Ha.call(this);this.ea.C=this.F;this.F.W4=!1;this.F.qaa=6;this.getHandler().V(this.F,"update",this.Njb);this.eM(null==this.Y)};
q.Cra=function(a,b){rW.Z.Cra.call(this,a,b);b=this.oa;var c=this.$;b.appendChild(a,Pr(Uac));this.X=yn(b,"waffle-assistant-answers-query-box",a);this.J=new gt("",new dW,this.oa);c.Ma(this.J);this.J.Va(yn(b,"waffle-assistant-answers-clear-query-button",this.X));this.Da=new EV(!1,"#4285f4");c.Ma(this.Da);this.qc=yn(b,"waffle-assistant-answers-spinner-container",this.X);this.Da.render(this.qc);this.C=yn(b,"waffle-assistant-answers-input-box",this.X);VYa(this.ea,this.C);NV(this.J.getElement(),"Clear query");
c.getHandler().V(this.X,"submit",y(this.cBb,this)).V(this.X,"focus",y(this.QFa,this,!0),!0).V(this.X,"blur",y(this.QFa,this,!1),!0).V(this.J,"action",y(this.M4a,this)).V(this.C,"input",y(this.gSb,this)).V(this.C,"focus",y(this.ONb,this));this.J.setVisible(!1)};q.d6=function(){XYa(this.ea,this.C);this.J.setVisible(!1);this.Da.dispose();this.Da=null;rW.Z.d6.call(this)};q.eM=function(a){rW.Z.eM.call(this,a);this.C&&(a?this.C.setAttribute("disabled",!0):this.C.removeAttribute("disabled"))};q.uh=ea("jb");
function mbc(a,b,c){var d=wb(Ec(c,1),function(a){return a.getName()}),e=[],g=[];A(Ec(c,2),function(a){e.push(a.getName());g=g.concat(Ec(a,2))});gbc(a.Ka,d,e,g);nbc(a.Bi).then(function(a){this.Ka.J=a},null,a);a.Y=b;a.Ed=c;a.eM(null==b)}q.reset=function(){hU(this.Na);hU(this.Ka.D);this.R=null};
function obc(a){if(a.mc()&&(pbc(a),null!=a.Y))for(var b=aB(a.qf),c=b.td(),c=wb(gc(Wg),c.v2,c),c=wb(c,Fa(uh,a.Y.rect)),d=0;d<c.length;d++)if(c[d]&&Gh(c[d])){var e=HT(b,c[d],"waffle-assistant-answers-styled-rect");I(a,e);XF(OI(b),e,!0);e.setVisible(!0);a.dd.push(e);e=lI(b,c[d],"waffle-assistant-answers-styled-border",1,0);I(a,e);e.setVisible(!0);a.Zc.push(e)}}function pbc(a){Jc(a.dd);Jc(a.Zc);a.dd=[];a.Zc=[]}
q.Njb=function(a){a.row&&(a=a.row,2==a.lz?(qbc(this,1,a.Xn),this.L.Ob(2652,this.Ua)):0==a.lz?(this.Za=!0,this.L.Ob(2651,this.Ua)):1==a.lz&&qbc(this,3))};q.QFa=function(a){Ip(this.X,"waffle-assistant-answers-query-box-focused",a);HF(this.F)&&!a&&this.F.xj()};q.gSb=function(){this.J.setVisible(!!j$b(this.C))};q.ONb=function(){this.F.Hv(this.C);var a=Ta(j$b(this.C));this.ea.e1(a.length);DYa(this.F,a||"  ");this.F.update(!0)};
function qbc(a,b,c){var d=Ya(j$b(a.C));if(!a.jb||3<=a.jb.getStatus().getState().C)d=Lac(d,2),rbc(a,d,!1);else{if(d&&a.Y)if(a.Na[d])a.L.Ob(2681,a.Ua),c=a.Na[d],c!=sb(a.D)&&(1<a.D.length&&(sbc(a),tbc(a)),ubc(a,c.B7()),w$b(a,c));else{var e=vbc(),g=bj(bj(e,KT,46),LV,4);P(g,2,a.Za);a.L.Ob(2635,new Vo(10,e));a.Za=!1;e=Jw(a.Y.rect);b=Zk(qj($k(sj(tj(a.jb.Hf("/answers/parse").Jf("q",d,"qt",b,"gid",a.Y.ud,"range",e),y(a.Wj,a,d,b)),y(a.FXb,a,d,b)),"POST"),2));c&&b.Jf("sgfml",c);b.Ve();a.$a=qJ(a.Zg,jj.ova);wbc(a,
!0)}else i$b(a.C,"");a.C.blur();a.J.setVisible(!!d);HF(a.F)&&a.F.xj()}}q.cBb=function(a){a.stopPropagation();a.preventDefault();qbc(this,2)};q.M4a=function(){i$b(this.C,"");this.J.setVisible(!1)};q.FXb=function(a,b){var c=vbc(),d=bj(bj(c,KT,46),LV,4);P(d,1,1==b||4==b?l$b.Qza:l$b.pAa);this.L.Ob(2640,new Vo(10,c));xbc(this,a)};function xbc(a,b){wbc(a,!1);b=Lac(b,3);rbc(a,b,!1);ybc(a)}
q.Wj=function(a,b,c){this.Kg.C.D.re.then(function(){var d=null,e=null,g=!1,h=vbc(),k=bj(bj(h,KT,46),LV,4);P(k,1,1==b||4==b?l$b.Qza:l$b.pAa);h=new Vo(10,h);if(c.ql()){e=this.wk.fd(TV.Ca(),c.Nf());if(g=e.getStatus()){var l;switch(g){case 1:l=2639;break;case 2:l=2643;break;case 3:l=2644;break;case 4:l=2638;break;case 5:l=2707;break;case 6:l=2706}l&&this.L.Ob(l,h)}if(1==g){xbc(this,a);return}if(2==g){e=-1!=zbc(a);g=-1!=Dac(a);h=4;e?h=5:g&&(h=7);g=Lac(a,h);e?(e=new nW(g,!0,this.L,!0,this.oa),Abc(this,
g,e)):rbc(this,g,!0);wbc(this,!1);ybc(this);return}l=e.hasFormula()?D(e,2):null;k=zc(e,9)?e.getError().El():null;g=!0;if(l){d=Bbc(this.Kg,l,this.Y,!!this.Ed&&!!D(this.Ed,4));if(!d){if(k=l.match(/([A-Z]*)\(/)){var m=bj(bj(h.C,KT,46),LV,4);P(m,7,k[1])}this.L.Ob(2645,h)}d=new Fac(a,d,"="!=l[0]?"="+l:l,e,null)}else k&&(d=Lac(a,6,e))}else this.L.Ob(2640,h);d||(d=Lac(a,4,e));wbc(this,!1);1==d.error&&null!=d.Xn?Cbc(this,d,g):rbc(this,d,g);ybc(this)},function(){xbc(this,a)},this)};
function ybc(a){""!=a.$a&&(rJ(a.Zg,a.$a),a.$a="")}function Dbc(a){if(null!=a.Xn)return abc;switch(a.error){case 4:return 0<a.D.length?bbc:$ac;case 5:return $ac;case 6:return bbc}return cbc}function vbc(){var a=new LV,b=new KT;dj(b,4,a);a=new jo;dj(a,46,b);return a}function zbc(a){return Bb(Qac,function(b){return Ma(a,b)})}function Ebc(a){var b=[];a=a.D;0<a.length&&(a=Pb(a,0,3),b=wb(a,function(a){return{query:a.lh(),Xn:D(a,2),type:a.getType()}}));return Dj(b)}
function Cbc(a,b,c){c=new mW(b,a.qf,a.xk,a.qj,a.L,a.Ab,c,a.oa);Abc(a,b,c)}function rbc(a,b,c){c=new nW(b,c,a.L,!1,a.oa);Abc(a,b,c)}function Abc(a,b,c){sbc(a);tbc(a);ubc(a,b);Fbc(a,c);for(var d=a.D;5<d.length;)a.EL(d[0]);if(1==b.error&&null!=b.Xn){var d=a.Ka,e=b.C;d.D[e.toLowerCase()]||(d.D[e.toLowerCase()]=e)}c.lka()&&(a.Na[b.C]=c);a.getHandler().V(c,"rc",a.ayb)}function tbc(a){0!=a.D.length&&(a.R?w$b(a,a.R):(a.R=new Xac(a.oa),Fbc(a,a.R)))}
function sbc(a){A(a.D,function(a){a instanceof mW||a instanceof nW||a==this.R||this.EL(a)},a)}function ubc(a,b){var c=Dbc(b),d=null;c==abc||c==bbc?0<b.D.length&&(d=Ebc(b)):c==$ac&&(d=Gbc(a.Bi));d&&(c=new oW(new aW,d,b.C,c,a.oa),Fbc(a,c),a.L.Ob(2769,a.Ua),a.getHandler().V(c,"sqc",y(a.fBb,a,b)))}q.fBb=function(a,b){i$b(this.C,b.C);this.C.focus();qbc(this,b.Y,b.F);this.L.Ob(2762,this.Ua)};
function wbc(a,b){R(a.qc,b);R(yn(a.oa,"waffle-assistant-answers-button-container",a.X),!b);a.Da&&a.Da.setActive(b)}function Fbc(a,b){b.Ue(a.Gd());a.D.push(b);a.Yd&&(a.O.Ci(b,0,!0),b.lP());PV(b,!0)}q.n5=function(){rW.Z.n5.call(this);this.reset()};
q.ayb=function(a){var b=this.oa;a=a.target;a instanceof mW?(this.EL(a),Tac(this.Ab,"Answer removed",b,y(this.byb,this,a))):a instanceof nW&&(this.EL(a),Tac(this.Ab,"Card removed",b));b=this.D;!this.R||b[0]!=this.R&&b[b.length-1]!=this.R||(this.EL(this.R),this.R=null)};q.byb=function(a){Cbc(this,a.B7(),a.lka());Tac(this.Ab,"Remove answer undone",this.oa)};q.EL=function(a){if(a.mc()){if(a instanceof mW||a instanceof nW)delete this.Na[a.B7().C],a==sb(this.D)&&sbc(this);rW.Z.EL.call(this,a)}J(a)};function Hbc(){var a;a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
T(Ku({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+is("Ask a question about your data")+'" /></div></form></div>');return V(a)};function Ibc(a,b){this.C=a;this.D=b}function Bbc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=mw(a.D),e=null!=e?e.toString():"0",g=0,h=0;ritz.getActiveFilterId(e)&&c&&(c=c.rect,ritz.getNumberOfRows(e)>c.Pc()+1?g=c.Pc()+1:ritz.getNumberOfColumns(e)>c.Uc()+1&&(h=c.Uc()+1));(a=e$b(a.C,b,e,g,h))&&d&&(a=ebc(a));return a};function Jbc(a){var b=[];if(zc(a,25)&&(a=D(a,25)))for(var c=0;c<Ac(a,1);c++){var d=D(a,1,c);if(zc(d,2)){var e=D(d,2);e&&b.push(Kbc(e,Lbc(d)))}}return b}function Mbc(a){var b=Jbc(a);zc(a,6)&&(a=D(a,6))&&b.push(Kbc(a,0));return b}function Lbc(a){return(a=zc(a,4)?D(a,4):0)?a:0}function Kbc(a,b){return{name:a,JAa:b}};function Nbc(a,b,c){this.va=a;this.ea=b;this.D=[];this.F=[];this.O=[];this.R=[];this.X=[];this.Y=[];this.C=new jg;this.L=new jg;this.$=new jg;this.J=new jg;Obc(this,c)}function Pbc(a,b){return lg(a,b)?a.get(b).values.Ad():[]}
function Obc(a,b){for(var c=new qg,d=new qg,e=0;e<b.length;e++){for(var g=Mbc(b[e]),h=[],k=[],l=0;l<g.length;l++){var m=g[l].name.toLowerCase();if(lg(a.va,m)){var p=a.va.get(m);c.add(p);h.push(p)}lg(a.ea,m)&&(m=a.ea.get(m),d.add(m),k.push(m))}Qbc(a,h,k)}a.D=c.Ad();a.F=d.Ad();Tb(a.D);Tb(a.F);a.O=wb(a.C.Ad(),function(a){return a.key});Tb(a.O);a.R=wb(a.L.Ad(),function(a){return a.key});Tb(a.R);a.X=wb(a.$.Ad(),function(a){return a.key});Tb(a.X);a.Y=wb(a.J.Ad(),function(a){return a.key});Tb(a.Y)}
function Qbc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)sW(a.C,b[d],b[e]),sW(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)sW(a.L,b[d],c[e]),sW(a.$,c[e],b[d]);for(d=0;d<c.length;d++)for(e=d+1;e<c.length;e++)sW(a.J,c[d],c[e]),sW(a.J,c[e],c[d])}function sW(a,b,c){var d;lg(a,b)?d=a.get(b).values:d=new qg;d.add(c);a.set(b,{key:b,values:d})};function Rbc(a,b){this.C=a;for(var c=new jg,d=0;d<Ac(a,2);d++)c.set(a.Wd(d).getName().toLowerCase(),d);this.R=c;c=new jg;for(d=0;d<Ac(a,1);d++)c.set(D(a,1,d).getName().toLowerCase(),d);this.va=c;c=[];for(d=0;d<Ac(a,2);d++)tW(a.Wd(d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Ac(a,1);d++)tW(D(a,1,d).getName())&&c.push(d);this.O=c;c=[];for(d=0;d<Ac(a,1);d++){for(var e=D(a,1,d).getName(),g=!0,h=0;h<Sbc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Sbc[h]+"(\\b|_)","i"))){g=!1;break}g&&c.push(d)}this.ea=
c;this.$=Tbc(a,0);this.X=Tbc(a,1);c=[];for(d=0;d<Ac(a,2);d++).8<=D(a.Wd(d),6)&&c.push(d);this.Y=c;this.F=Ubc(Ac(a,2));this.J=Ubc(Ac(a,1));this.D=new Nbc(this.R,this.va,b)}function Ubc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function Tbc(a,b){for(var c=[],d=0;d<Ac(a,2);d++)a.Wd(d).getType()==b&&c.push(d);return c}
function Vbc(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Wbc(c,a[d]);for(d=0;d<b.length;d++)a=c,c=Wbc(a,b[d]),c=0<c.length?c:a;return 0<c.length?c[pW(c.length)]:-1}function Xbc(a,b,c,d,e){var g=[a.L,a.D.D],h=[a.F];b&&(h.push(a.$),h.push(a.Y));c&&h.push(Ec(a.C,3));null!=e&&-1!=e?g.push(Pbc(a.D.L,e)):d&&g.push(a.D.R);return Vbc(h,g)}function uW(a,b,c){var d=[a.O,a.D.F],e=[a.J];b&&e.push(a.ea);c&&d.push(a.D.X);return Vbc(e,d)}
function Ybc(a,b){for(var c=5;;){var d=a.C.Wd(b),e=pW(Ac(d,2));c--;if(tW(D(d,2,e))||0==c)return e}}function vW(a,b){b=a.C.Wd(b);a=b.getName();tW(a)||(b=Zbc(Ec(b,7)),a=null==b?a:b);return a}function wW(a,b){b=D(a.C,1,b);a=b.getName();tW(a)||(b=Zbc(Ec(b,2)),a=null==b?a:b);return a}function Zbc(a){for(var b=0;b<a.length;b++)if(tW(a[b]))return a[b];return null}function tW(a){return null==a?!1:50>=a.length}function $bc(a){for(var b=dbc(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}
function Wbc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Sbc=["average","total","sum","mean","median"];function acc(a){this.C=[];this.D=[];this.J=this.L=this.F=null;this.R=new qg;this.O=new qg;this.X=a}acc.prototype.reset=function(){this.C=[];this.D=[];this.F&&(this.F.cancel(),this.F=null);this.O=new qg;this.R=new qg};acc.prototype.uh=ea("J");function nbc(a,b){if(ooa)return a.F.then(function(){var a=this.D.slice();b||o$b(a);return a},null,a);a=a.C.slice();b||o$b(a);return Dj(a)}
function bcc(a){if(!a.C)throw Error("Suggestions not generated. Must call generate() at the top level");return 0<a.C.length?a.C[0].query:""}function xW(a,b,c,d){a.O.contains(c)||(b.push({query:c,Xn:void 0,type:d}),a.R.add(d),a.O.add(c))}function yW(a,b){return!a.R.contains(b)}function Gbc(a){return nbc(a,poa).then(function(a){return 3>=a.length?a:Pb(a,0,3)},null,a)}function ccc(a,b){var c=[];b=Jbc(b);for(var d=0;d<b.length&&-1!=a.va.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}
function dcc(a){switch(a){case 6:return"Sum";case 1:return"Average";case 4:return"Count"}return null}function zW(a){return a[pW(a.length)]}
function ecc(a){var b=null;a.F=new Bj(function(a){if(!this.J||3<=this.J.getStatus().getState().C)this.D=this.C,a();var c=Jw(this.L.rect),e=wb(this.C,function(a){return a.query});b=$k(Zk(qj(sj(tj(this.J.Hf("/answers/parsesuggestions").Jf("gid",this.L.ud,"range",c),y(function(b){fcc(this,b).then(a)},this)),y(function(){this.D=this.C;a()},this)).setContent(["queries",Ui(e)]).setTimeout(2E3),1)),"POST").Ve()},a);Jj(a.F,function(){b&&b.dispose()})}
function fcc(a,b){return a.X.C.D.re.then(function(){var a=[];if(b.ql())for(var d=b.Nf(),e=0;e<d.length;e++){var g;if(g=d[e])a:{if(g=Bbc(this.X,d[e],this.L,!1))for(var h=1<g.length?1:0;h<g.length;h++){for(var k=!1,l=g[h],m=0;m<l.length;m++)if(!l[m]){k=!0;break}if(!k){g=!0;break a}}g=!1}g&&(this.C[e].Xn=d[e],a.push(this.C[e]))}this.D=a},function(){this.D.length=0},a)}var gcc="Minimum Maximum Most Least Highest Lowest".split(" "),hcc=["Average","Median"],icc=["before","after"];function AW(a,b,c,d,e,g,h){QV.call(this,1,g,e,h);this.Za=c;this.ea=null;this.Y=new gt("",new cW,this.oa);this.Ma(this.Y);this.$=new gt("",new cW,this.oa);this.Ma(this.$);a=new mlb(a,!0,!0);a=new Ibc(a,c);this.L=new acc(a);this.C=new rW(this.L,0,b,c,d,e,this.Ua,a,h);this.F=this.Da=null;this.Xa=Xo(new Wo,10).Fa()}z(AW,QV);
var jcc={i_a:"waffle-assistant-answers-input-box",v0a:"waffle-assistant-answers-query-box",skc:"waffle-assistant-answers-query-box-focused",s_a:"waffle-assistant-answers-learn-more",ugc:"waffle-assistant-answers-logging-message-container",Z_a:"waffle-assistant-answers-logging-opt-out"};q=AW.prototype;q.Sa=function(){AW.Z.Sa.call(this);var a=Pr(Hbc);this.oa.appendChild(x$b(this),a)};
q.Ha=function(){AW.Z.Ha.call(this);var a=S(this,jcc.v0a),b=S(this,jcc.i_a);this.$.Va(S(this,jcc.Z_a));this.Y.Va(S(this,jcc.s_a));this.getHandler().V(a,"focus",this.qxb,!0).V(a,"blur",this.oxb,!0).V(a,"mouseover",this.sxb).V(a,"mouseout",this.rxb).V(a,"click",this.pxb).V(b,"input",this.GXb).V(this.$,"action",this.Qvb).V(this.Y,"action",this.Jsb).V(qw(this.Za),"Ib",n$b(this.HXb,25,this));this.setVisible(null!=this.Da);kcc(this,koa&&qoa&&tm("showAnswersLoggingOptOut"))};q.gUa=Kf;q.OMa=Lf;q.Osa=Kf;
q.JU=n("Answers");q.Nda=n(1);q.e5=function(a){return 3==a||0==a};q.Rua=function(a,b){Tb(a,function(a,b){return b.CT()-a.CT()});for(var c=[],d=null,e=0;e<a.length;e++){var g=Fc(a[e],1);3==g?d=a[e]:0==g&&c.push(a[e].getAutovisRecommendation())}d&&d.CT()?(e=b||null,0<Ac(d,4)?lcc(this,ET(d.XJ()),D(d,9),c):lcc(this,e,D(d,9),c),this.F||(AW.Z.Rua.call(this,a,b),this.getHandler().V(this.F,"sqc",this.eBb))):this.w2(!0)};q.GX=function(a){if(!this.F){var b=Gbc(this.L);this.F=new oW(a,b,"",Zac,this.oa)}return this.F};
q.RCa=f("C");q.Mna=function(){return this.Ta()};q.w2=function(a,b,c){this.L.reset();(a||b)&&this.F&&(AW.Z.w2.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(AW.Z.w2.call(this,a,b,c),this.F.dispose(),this.F=null),this.mc()&&(this.L.reset(),this.Da=null,a=this.C,a.mc()&&(b=a.Ka,b.J=[],b.C.clear(),a.C&&i$b(a.C),a.n5(),a.Y=null,a.eM(!0),a.J&&!a.J.isDisposed()&&a.J.setVisible(!1),a.Za=!1),this.setVisible(!1),this.Nb()&&pbc(this.C));c&&this.C.reset()};
q.uh=function(a){this.ea=a;this.C.uh(a);this.L.uh(a)};q.setActive=function(a){AW.Z.setActive.call(this,a);a?obc(this.C):pbc(this.C)};function kcc(a,b){R(S(a,"waffle-assistant-answers-logging-message-container"),b)}function mcc(a,b){a=S(a,"waffle-assistant-answers-query-box");Ip(a,"waffle-assistant-answers-query-box-focused",b)}q.HXb=function(){this.Nb()&&obc(this.C)};q.qxb=function(){mcc(this,!0);obc(this.C)};q.oxb=function(){mcc(this,!1);this.Nb()||pbc(this.C)};q.sxb=function(){obc(this.C)};
q.rxb=function(){this.Nb()||pbc(this.C)};q.pxb=function(){ncc(this,"")};q.GXb=function(){var a=S(this,"waffle-assistant-answers-input-box");ncc(this,a.value);a.value=""};q.eBb=function(a){ncc(this,a.C);dl(y(function(a){qbc(this.C,1,a)},this,a.F),150,this);this.O.Ob(2652,this.Xa)};function ncc(a,b){a.setActive(!0);a.dispatchEvent("assistant-sidepane-set-active-panel");dl(function(){var a=this.C;i$b(a.C,b);a.C.focus()},150,a)}
function lcc(a,b,c,d){c=c||new YV;a.Da=b;var e=a.L,g=d;e.reset();g=poa?g:[];d=[];var h=new Rbc(c,g);if(poa)for(var k=0;k<g.length;k++){var l=g[k];switch(l.getChartType()){case "BarChart":var m=e,p=h,r=l,l=d;if(yW(m,12)||yW(m,1)){var t=D(r,6);if(t&&-1!=p.R.get(t.toLowerCase(),-1)){p=ccc(p,r);if(0<p.length){var r=zW(p),w=dcc(r.JAa);w&&yW(m,12)&&xW(m,l,w+" of "+r.name+" by "+t,12)}1<p.length&&yW(m,1)&&xW(m,l,"Correlation between "+p[0].name+" and "+p[1].name,1)}}break;case "ScatterChart":m=e;t=h;p=l;
l=d;yW(m,1)&&(t=ccc(t,p),1<t.length&&xW(m,l,"Correlation between "+t[0].name+" and "+t[1].name,1));break;case "PieChart":if(m=e,t=h,r=l,l=d,yW(m,13)){p=[];r=Jbc(r);for(w=0;w<r.length&&-1!=t.R.get(r[w].name.toLowerCase(),-1);w++)p.push(r[w]);t=p;1==t.length&&4==t[0].JAa&&xW(m,l,"Distribution of "+t[0].name,13)}}}yW(e,0)&&(g=uW(h,!1,!0),k=Xbc(h,!0,!1,!0,g),-1!=k&&-1!=g&&(k=vW(h,k),g=wW(h,g),k!=g&&xW(e,d,"Top "+k+" by "+g,0)));if(yW(e,1)&&1<Ac(h.C,1)){a:if(2>h.J.length)k=[-1,-1];else{k=Vbc([h.J],[h.O,
h.D.F,h.D.Y]);if(-1!=k&&(g=Pbc(h.D.J,k),0<g.length)){k=[k];m=pW(g.length);k.push(g[m]);break a}k=$bc(2<=h.O.length?h.O:h.J)}g=wW(h,k[0]);k=wW(h,k[1]);g!=k&&xW(e,d,"Correlation between "+g+" and "+k,1)}yW(e,2)&&(g=uW(h,!0),-1!=g&&xW(e,d,zW(hcc)+" of "+wW(h,g),2));if(yW(e,4)&&(m=h.C,k=uW(h,!0,!0),g=Xbc(h,!0,!1,!0,k),-1!=k&&-1!=g&&(k=wW(h,k),m=m.Wd(g),l=vW(h,g),0<Ac(m,3)&&l!=k))){a:for(t=5;;)if(p=h.C.Wd(g),r=pW(Ac(p,3)),w=D(p,3,r),t--,tW(D(p,2,r))||0==t){g=w;break a}xW(e,d,zW(hcc)+" of "+k+" when "+
l+" is "+D(m,2,g),4)}yW(e,8)&&(k=uW(h,!1,!0),g=Xbc(h,!0,!1,!0,k),-1!=g&&-1!=k&&(k=wW(h,k),g=vW(h,g),g!=k&&xW(e,d,g+" with "+zW(gcc)+" "+k,8)));yW(e,9)&&0<Ac(h.C,1)&&(g=wW(h,uW(h)),xW(e,d,zW(gcc)+" "+g,9));yW(e,10)&&(g=h.C,k=Xbc(h,!0,!0),-1!=k&&(m=vW(h,k),0<Ac(g.Wd(k),3)&&xW(e,d,"Most frequent "+m,10)));if(yW(e,11)){g=h.C;m=uW(h,!0);a:{if(1==h.X.length&&(k=h.X[0],!D(h.C.Wd(k),5)))break a;k=-1}-1!=k&&-1!=m&&(m=wW(h,m),g=g.Wd(k),0<Ac(g,2)&&(k=Ybc(h,k),xW(e,d,zW(hcc)+" of "+m+" "+zW(icc)+" "+D(g,2,k),
11)))}((g=3>d.length)||0==pW(5))&&yW(e,6)&&(m=h.C,t=uW(h,!1,!0),k=Xbc(h,!1,!1,!0,t),-1!=k&&-1!=t&&(m=m.Wd(k),l=vW(h,k),t=wW(h,t),0<Ac(m,2)&&l!=t&&(k=Ybc(h,k),xW(e,d,"Show "+t+" for "+l+" "+D(m,2,k),6))));if((g||0==pW(5))&&yW(e,7)){g=h.C;a:if(2>h.F.length)m=[-1,-1];else{k=[h.L,h.D.D,h.D.O];m=[h.F];m.push(h.$);m.push(h.Y);l=Vbc(m,k);if(-1!=l&&(k=Pbc(h.D.C,l),0<k.length)){m=[l];l=pW(k.length);m.push(k[l]);break a}m=$bc(2<=h.L.length?h.L:h.F);m[0]!=l&&(m[1]=m[0],m[0]=l)}k=m[0];1<Ac(g,2)&&-1!=k&&(m=m[1],
g=g.Wd(m),l=vW(h,m),k=vW(h,k),0<Ac(g,2)&&l!=k&&(h=Ybc(h,m),xW(e,d,"What is "+k+" where "+l+" is "+D(g,2,h),7)))}e.C=d;e.L=b;ooa&&ecc(e);a.setVisible(null!=b);mbc(a.C,b,c);a.Nb()&&obc(a.C)}q.Qvb=function(a){a.stopPropagation();a.preventDefault();this.ea&&($k(sj(tj(this.ea.Hf("/answers/logoptout"),y(this.rtb,this)),y(this.qtb,this)),"POST").Ve(),this.O.Ob(2663,this.Xa))};
q.Jsb=function(a){a.stopPropagation();a.preventDefault();Zo("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};q.rtb=function(a){a.ql()&&kcc(this,!1)};q.qtb=da();function occ(){var a;a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+pcc()+"</div>");return V(a)}
function qcc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+pcc()+"</div>")}function pcc(){var a;a=""+T(mt({Ee:"waffle-assistant-formatting-edit-button",content:es("Edit"),style:4}));return V(a)};function BW(a,b,c){fW.call(this,a,c);a=wb(this.D.Bga(),E6b);this.C=new uU(!1,a,7);this.Ma(this.C);this.O=new nt("",this.oa);this.Ma(this.O);this.R=b;this.L=!1;this.J=-1}z(BW,fW);var rcc={fea:"waffle-assistant-banding-color-picker-container",pea:"waffle-assistant-formatting-edit-button",ZH:"waffle-assistant-banding-range"};q=BW.prototype;q.Sa=function(){BW.Z.Sa.call(this);gW(this).appendChild(Pr(occ))};
q.Ha=function(){BW.Z.Ha.call(this);this.getHandler().V(this.O,"action",this.Oob).V(this.C,"banding-scheme-changed",this.dkb);this.R.Ob(2768,void 0)};q.zz=function(a){var b=S(this,rcc.fea);this.C.render(b);K6b(this.C);var b=S(this,rcc.ZH),c=this.D.XJ(),d=Oh(c);mn(b,Jw(d));scc(this,c);b=S(this,rcc.pea);this.O.Va(b);a()};q.qz=function(){Bp(this.Ba,"Suggested alternating background colors");or(this.C,"Choose a color scheme")};q.ly=n("assistantBandingFeedback");q.FE=n(2672);q.CE=n(2671);
q.Oob=function(a){Tn.dispatchEvent({type:"show-banding-pane-recommendation",$Ra:this.D,M5a:L6b(this.C)});a.stopPropagation()};q.dkb=function(a){if(!this.L&&vU(this.C)){var b=this.J;this.J=this.C.ai();this.J==b?this.dispatchEvent(new MV("assistant-sidepane-remove-banding",this,2797)):this.dispatchEvent(new MV("assistant-sidepane-apply-banding",this,2673));a.stopPropagation()}};
function scc(a,b){a.L=!0;var c;c=b.eb();b=Oh(b);c=ritz.getWorkbookRangeIntersectingIds(c,b.fc(),b.Wb(),b.Pc(),b.Uc(),7,!1);c.length?(c=ritz.getBandedRangeByWorkbookRangeId(c[0]),c=(new Ii).fd(Dd.Ca(),c),c=E6b(c)):c=null;c?(c=M6b(a.C,c),bL(a.C,c?c.getElement():null)):bL(a.C,null);a.J=a.C.ai();a.L=!1};function CW(a,b){fW.call(this,a,b);this.C=new nt("",this.oa);this.Ma(this.C);this.Ab=Ec(a,6)}z(CW,fW);var DW={pea:"waffle-assistant-formatting-edit-button",MZa:"waffle-assistant-conditionalformat-format-preview",Q0a:"waffle-assistant-conditionalformat-rule-holder",V2:"waffle-assistant-conditionalformat-description",W_a:"one-rule",R1a:"two-rules",E1a:"three-rules",o0a:"waffle-assistant-conditionalformat-format-preview-label"};q=CW.prototype;q.Sa=function(){CW.Z.Sa.call(this);gW(this).appendChild(Pr(qcc))};
q.Ha=function(){CW.Z.Ha.call(this);var a=S(this,DW.pea);this.C.Va(a);NV(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.Cjb)};q.zz=function(a){mn(S(this,DW.V2),Fc(this.D,3));var b=S(this,DW.Q0a),c=new tcc(this,this.oa);this.Ma(c);c.Va(b);NV(b,"Apply conditional format rules");a()};q.qz=oa;q.ly=n("assistantConditionalFormatFeedback");q.FE=n(2630);q.CE=n(2629);
q.Cjb=function(){ucc(this);this.dispatchEvent(new MV("assistant-sidepane-change-selection",this,2670,void 0,void 0,Oh(D(this.Ab[0],1,0))));Xn()};function ucc(a){a.dispatchEvent(new MV("assistant-sidepane-apply-conditional-format-rules",a,2563))}function tcc(a,b){lr.call(this,void 0,void 0,b);this.C=a}z(tcc,lr);
tcc.prototype.Fe=function(a){tcc.Z.Fe.call(this,a);var b=this.C.Ab,c;switch(b.length){case 0:break;case 1:c=DW.W_a;break;case 2:case 4:c=DW.R1a;break;default:c=DW.E1a}for(var d=0;d<b.length;d++){var e=b[d],g=Tm("DIV");Fp(g,[DW.MZa,c]);var h=Tm("DIV");Ep(h,DW.o0a);g.appendChild(h);mn(h,"123");if(zc(e,2)){var k=D(D(e,2),1);switch(D(D(k,1),1)){case 9:case 13:var k=Ec(D(k,1),2)[0],l=Ec(e,1)[0];mn(h,EF(k,Fc(l,1),Fc(l,2),Fc(l,4)))}}Y5b(e,g);a.appendChild(g)}};tcc.prototype.gj=function(){ucc(this.C);return!0};function vcc(a,b,c){QV.call(this,2,b,a,c)}z(vcc,QV);q=vcc.prototype;q.JU=n("Formatting");q.e5=function(a){return 2==a||4==a};q.GX=function(a){var b=D(a,1);switch(b){case 2:return new CW(a,this.oa);case 4:return a=new BW(a,this.O,this.oa),this.getHandler().V(a,"assistant-sidepane-apply-banding",this.OPb).V(a,"assistant-sidepane-remove-banding",this.ODb),a;default:throw Error("Unsupported recommendation type: "+b);}};
q.OPb=function(a){Tac(this.Ua,"Alternating colors applied",this.oa,y(this.ekb,this,a.C))};q.ODb=function(){this.Ua.clear()};q.ekb=function(a){this.dispatchEvent(new MV("assistant-undo-pressed",a,2796))};q.Ue=function(a){vcc.Z.Ue.call(this,a);this.setVisible(!a)};q.Sua=function(a){return this.Gd()?(this.setVisible(!1),a):vcc.Z.Sua.call(this,a)};q.Nda=n(3);function EW(a,b,c,d){Qu.call(this,a,b,c,d,void 0,void 0,!0)}z(EW,Qu);EW.prototype.Sa=function(){EW.Z.Sa.call(this);Ep(this.Ba,"waffle-assistant-toast");Ep(S(this,"docs-ui-toast-content"),"waffle-assistant-toast-content")};EW.prototype.sI=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Cq(this,b);EW.Z.sI.call(this,a,b,c)};EW.prototype.Zh=function(a,b,c,d){this.sI(a,b,d);a=Eq(this,b);If(this.getHandler(),a,md,y(function(){this.setVisible(!1);c()},this))};function wcc(){this.C=null}z(wcc,H);wcc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function Tac(a,b,c,d){a.clear();a.C=new EW(b,c,!1,5E3);a.C.render();d&&a.C.Zh("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}wcc.prototype.ma=function(){wcc.Z.ma.call(this);this.clear()};function xcc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+T(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+is("Press enter to insert formula")+'"></span></div>');return V(a)};function FW(a,b){xq.call(this);this.C=a;this.D=b}z(FW,xq);q=FW.prototype;q.Sa=function(){this.Ba=Pr(xcc,{name:this.C,title:this.D})};q.Ha=function(){FW.Z.Ha.call(this);var a=S(this,"waffle-assistant-quicksum-entry-name");NV(a);this.getHandler().V(this.Ba,"keypress",this.nXb);R(this.Ba,!1)};q.getFunctionName=f("C");q.Wa=function(a){mn(S(this,"waffle-assistant-quicksum-entry-value"),a||"");R(this.Ba,!!a)};q.Ta=function(){return gq(this.Ba)};
q.nXb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new K("insert",this)))};function GW(a,b,c,d,e){xq.call(this,e);this.Da=a;this.$=b;this.O=c;this.L=d;this.D=a.C;this.ea=new Ii;this.X=Xo(new Wo,17).Fa();this.R=Xo(new Wo,2).Fa();this.Ff=!1;this.F=[];this.C=null;this.J=[]}z(GW,xq);
GW.prototype.Ha=function(){GW.Z.Ha.call(this);this.Ci(new FW(ritz.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Ci(new FW(ritz.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Ci(new FW(ritz.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Ci(new FW(ritz.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Ci(new FW(ritz.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new lW(this.Ba,this.$,this.D,this.O);this.C.Ue(this.Ff);I(this,this.C);this.getHandler().V(this,"insert",
this.Y).V(this.C,"formula_inserted",this.Ka)};
function ycc(a){function b(a){return l?ritz.renderNumberAsFormattedString(a,m):null}if(rw(a.D)){var c=sw(a.D),d=Ux(c),e=nJ(a.D);if(zb(d,c.Js,c)){var g=[];a.F=[];for(c=0;c<d.length;c++){var h=d[c],k=fha(e+"",h.fc(),h.Wb(),h.Pc(),h.Uc());g.push(a.ea.serialize(k));a.F.push(h)}if(d=ritz.quickSum(g)){R(a.Ba,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.yd(0).Wa(b(d.sum));a.yd(1).Wa(b(d.average));a.yd(2).Wa(b(d.min));a.yd(3).Wa(b(d.max));1<e?a.yd(4).Wa(ritz.renderNumberAsFormattedString(e,
c)):R(a.Ba,!1);if(a.C){a.C.L=[];a.J=[];for(c=0;c<a.ld();++c)d=a.yd(c),a.J.push(zcc(a,d.getFunctionName()));a.C.L=a.J}}else R(a.Ba,!1)}else R(a.Ba,!1)}else R(a.Ba,!1)}GW.prototype.Ue=function(a){this.Ff=a;this.C&&this.C.Ue(a);Ip(this.Ba,"waffle-assistant-quicksum-panel-readonly",a)};GW.prototype.Y=function(a){var b=a.target;a=this.F[0];a=new N(a.left,a.Pc());b=b.getFunctionName();b=zcc(this,b);a=new hF(sw(this.D),a,b);this.O.C(a);this.L.Ob(2624,this.R)};GW.prototype.Ka=function(){this.L.Ob(2624,this.X)};
function zcc(a,b){var c=Qw(a.Da.O);a=wb(a.F,function(a){return Jw(a)});return"="+b+"("+a.join(c)+")"};function Acc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+T(mt({content:es("INSERT CHART"),style:4,Ee:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+T(mt({Ee:"waffle-autovis-lightbox-close",content:fs(""+T(Ku({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:es("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">\x3c!-- TODO(cuiffo): Replace with real icons --\x3e'+
T(mt({content:fs("&#10094;"),style:4,Ee:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:gs('aria-label="'+is("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+T(mt({content:fs("&#10095;"),style:4,Ee:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:gs('aria-label="'+is("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
T(a.DHb)+"</div></div></div>");return V(a)}function Bcc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function HW(a,b,c){xq.call(this,c);this.F=a;this.D=b;this.J=[];this.C=new nt("",this.oa);this.Ma(this.C);this.R=new nt("",this.oa);this.Ma(this.R);this.O=new nt("",this.oa);this.Ma(this.O);this.L=new nt("",this.oa);this.Ma(this.L)}z(HW,xq);q=HW.prototype;q.Sa=function(){HW.Z.Sa.call(this);this.Ba=Pr(Acc,{DHb:this.F.length})};
q.Ha=function(){HW.Z.Ha.call(this);var a=X.nH.isEnabled();this.Ue(!a);a=S(this,"waffle-autovis-lightbox-close");this.C.Va(a);a=S(this,"waffle-autovis-lightbox-insert");this.R.Va(a);var b=S(this,"waffle-autovis-lightbox-previous");this.O.Va(b);b=S(this,"waffle-autovis-lightbox-next");this.L.Va(b);Ccc(this);Dcc(this,this.D,!1);this.getHandler().V(document.body,bd,this.ESb).V(this.Ba,"keydown",this.FSb).V(Sm(),"resize",this.ISb).V(this.C,"action",this.close).V(this.R,"action",this.Urb).V(this.O,"action",
this.HSb).V(this.L,"action",this.GSb);b=new vv(this.Ba,this.oa);yv(b);I(this,b);a.focus()};function Ccc(a){var b=S(a,"waffle-autovis-lightbox-content"),c=S(a,"waffle-autovis-lightbox-content-inner");a=S(a,"waffle-autovis-lightbox-page-count");var d=Qm();a=cq(a);var e=d.height-a.height-195,g=d.width-200;.75<e/g?(d=g,e=.75*g):d=e/.75;$p(c,d,e);$p(b,d,e+a.height+35)}q.Ue=function(a){Ip(this.Ba,"waffle-autovis-lightbox-readonly",a)};
function Dcc(a,b,c){c&&Wn("Page "+(b+1+(" of "+(a.F.length+"."))));a.J[b]?Ecc(a,b):a.F[b]&&qac(a.F[b],y(a.plb,a,b),!0)}q.plb=function(a,b){if(!this.isDisposed()&&b){var c=S(this,"waffle-autovis-lightbox-container"),d=Pr(Bcc);c.appendChild(d);this.J[a]=d;BV(b,d,om);Ecc(this,a)}};function Ecc(a,b){R(a.J[a.D],!1);R(a.J[b],!0);a.O.Qa(0!=b);a.L.Qa(b!=a.F.length-1);var c=S(a,"waffle-autovis-lightbox-page-number");mn(c,b+1);a.D=b}q.ESb=function(a){!jn(this.Ba,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
q.FSb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&Dcc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Fcc(this);a.stopPropagation()};q.ISb=function(){var a=S(this,"waffle-autovis-lightbox-container");Zm(a);this.J=[];Ccc(this);Dcc(this,this.D,!0)};q.Urb=function(){this.close();tac(this.F[this.D],2256)};q.HSb=function(){0!=this.D&&Dcc(this,this.D-1,!0);0==this.D&&this.L.Ba.focus()};q.GSb=function(){Fcc(this);this.D==this.F.length-1&&this.O.Ba.focus()};
function Fcc(a){a.D!=a.F.length-1&&Dcc(a,a.D+1,!0)}q.close=function(){this.dispose()};q.zd=function(){HW.Z.zd.call(this);var a=this.F[this.D];a&&a.Ba&&a.Ba.focus()};function Gcc(a,b){L.call(this);this.Za=a;this.yb=b;this.F=a.C;this.Da=new Ii;this.La=Sj();this.J=Sj();this.jc=this.C=this.D=this.L=this.O=this.va=this.X=null;this.bb=!1;this.$=null;this.Xa=!0;this.Pa=this.Ka=!1;this.Na=this.Ua=null;this.R=pJ.getInstance();this.Ga=this.ea="";b=this.Za.O.Sr();this.Y=new bW;E(this.Y,2,Una);a=zoa&&!a.Gd();E(this.Y,3,a);E(this.Y,4,roa);a=nm&&"en"==TD(b);E(this.Y,5,a);E(this.Y,6,uoa);E(this.Y,7,Aoa);E(this.Y,10,!1);a=new M(this);I(this,a);a.V(this.yb,"Ca",this.PXb)}
z(Gcc,L);var Hcc={T1b:"cu",$Xa:"cs",ZXa:"ce",z_a:"ls",y_a:"le"};q=Gcc.prototype;q.update=function(a,b,c){c&&this.C&&!Ab(c,function(a){return $ga(a,this.C.rect)},this)||!a&&this.C&&c&&1==c.length&&1==Hh(c[0])&&this.C.rect.contains(c[0])||(this.La.cancel(!0),a&&(this.Pa=!0,this.J.cancel(!0),this.D=this.L=this.O=this.va=null,this.X&&(this.X.cancel(!0),this.X=null)),this.La=Icc(),this.La.addCallback(this.V3a,this),this.La.addCallback(Fa(this.W3a,b),this))};q.uh=ea("Ua");
q.PXb=function(){this.X&&3==this.yb.getState()&&(this.X.Hb(),this.X=null)};function Icc(){var a=null,b=new Lj(function(){null===a||el(a)}),a=dl(function(){b.Hb()});return b}q.Akb=function(){this.Ka=!0};q.V3a=function(){var a=this.F.getActiveGrid();if(a){var b=sw(this.F),c=Ux(b),d=Jcc(this,c||[]),e=Jcc(this,this.jc||[]);d&&!e||!d&&!Kcc(c,this.jc)?(this.D=null,this.bb=!0):this.bb=!1;this.jc=c;var g=VC(b).clone();A(Ux(b),function(a){vh(g,a)});this.$=new Jh(a.eb(),"",g)}else this.$=null};
q.W3a=function(a){this.ea=qJ(this.R,jj.Gwa);var b=this.F.getActiveGrid(),c=this.$&&this.$.ud;if(!b||b.eb()!=c||null===c)return this.$=null;var d=this.F.getActiveGrid().D,b=pB(d,this.$.rect);b.addCallback(function(){if(!this.F.getActiveGrid()||mw(this.F)!=c)return null;var b=sw(this.F),g=sB(b,this.$.rect,gc(Vg),a?void 0:500),h=mB(b.F,"r"),k=b.Vm("r");return!b.Js(g)||h>=g.fc()&&GKa(b)||k<=g.Pc()&&FKa(b)?(this.dispatchEvent(new K("ls")),rB(d,g,gc(Vg),a?void 0:500).addCallback(this.v6a,this)):g},this);
b.addCallback(function(a){var b=this.F.getActiveGrid();return a&&b&&b.eb()==c&&null!==c?Lcc(this,a,sw(this.F)):null},this);b.addCallback(function(b){b=b&&new Jh(c,"",b);if(null===b&&null!==this.C||null!==b&&!b.equals(this.C))this.D=this.L=this.O=this.va=null;var d=null!==b&&b.equals(this.C);if(d=this.Pa||this.bb||!d&&(null===this.O||null!==this.L&&null===this.D))this.Xa=this.Ka&&this.Xa||!this.C||!b||!b.rect.intersects(this.C.rect);var e=null!==b&&b.contains(this.C);this.C=b;""!=this.ea&&(rJ(this.R,
this.ea),this.ea="");d&&(a&&(this.Ga=qJ(this.R,jj.Hwa)),this.J.cancel(!0),this.J=Sj(),this.J.addCallback(this.c4a,this),this.J.addCallback(this.s6a,this),a&&(this.J.addCallback(Fa(this.o6a,e),this),this.Ua&&!cy(this.Za)&&voa?this.J.addCallback(this.Ufb,this):(this.J.addCallback(this.$3a,this),this.J.addCallback(this.a4a,this)),this.J.addCallback(this.n6a,this)),Oj(this.J,this.Akb,this))},this);return b};
q.c4a=function(){if(null!==this.C&&null!==this.C.rect&&null===this.va){var a=qJ(this.R,jj.rva);this.va=ritz.getAssistantConfidence(""+this.C.ud,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,this.Da.serialize(this.Y));rJ(this.R,a)}};q.v6a=function(){this.dispatchEvent(new K("le"))};q.s6a=function(){this.dispatchEvent(new Mcc(this.C,this.va))};q.o6a=function(a){a=new Ncc(a,this.Pa);this.Pa=!1;this.dispatchEvent(a)};
q.Ufb=function(){if(null===this.C||null===this.C.rect||null!==this.L&&null!==this.D)return null;J(this.Na);return 3!=this.yb.getState()?(this.X=new Lj,this.X.addCallback(this.hTa,this),this.X):this.hTa()};
q.hTa=function(){var a=qJ(this.R,jj.Jwa),b=Occ(this),c=b&&!b.rOa,b=ritz.getAssistantRequestProto(this.C.ud.toString(),this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,c?b.rows:[],c?b.Ae:[]),b=this.Da.fd($V.Ca(),b),c=new Ii;c.Sv=!0;var b=Ui(c.serialize(b)),d=new Lj;this.Na=sj(tj(qj(Zk($k(this.Ua.Hf("/explore/getrecommendations").Jf("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=qJ(this.R,jj.Iwa);b=Pcc(this,b.Nf());rJ(this.R,c);this.L=Ec(b,
1);this.D=Ec(b,2);this.Na=null;rJ(this.R,a);d.Hb()},this),function(){this.L=[];this.D=[];d.Hb()},this).Ve();return d};
q.$3a=function(){function a(){b=null;ritz.continueAssistantRecommendation(this.O)?(this.L=Ec(Pcc(this,ritz.getAssistantRecommendations(this.O)),1),d.Hb()):b=dl(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.L)return null;this.O=ritz.newAssistantRecommender(this.Da.serialize(this.Y));this.D=this.L=null;ritz.startAssistantRecommendation(this.O,""+this.C.ud,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var b=null,c=
y(function(){null!==b&&(el(b),this.D=this.L=this.O=b=null)},this),d=new Lj(c),b=dl(a,5,this);return d};q.a4a=function(){var a=Occ(this);a&&this.O&&null===this.D&&(this.D=a.rOa?[]:Ec(Pcc(this,ritz.getAssistantRecommendationsOnlySelection(this.O,a.rows,a.Ae)),2))};q.n6a=function(){this.Ka=!1;var a=this.D&&0<this.D.length?this.D:this.L;""!=this.Ga&&(rJ(this.R,this.Ga),this.Ga="");this.dispatchEvent(new Qcc(this.C,a||[],this.Xa))};function Pcc(a,b){return a.Da.fd(ZV.Ca(),b)}
function Lcc(a,b,c){b=b.clone();ec(Vg,function(a){for(var d=!0;d&&b;){for(var g=Zg(a),h=0;h<(g?b.width:b.height);h++){var k=Dh(b,a),l=g?b.Wb():b.fc();if(g&&!HJb(c.uf(k,l+h))||!g&&!HJb(c.uf(l+h,k))){d=!1;break}}d&&(dha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function Kcc(a,b){return Vb(a,b,function(a,b){return wh(a,b)})}
function Occ(a){var b=a.F.getActiveGrid();if(!b||!a.C||b.eb()!=a.C.ud)return null;for(var c=Ux(sw(a.F)),c=wb(c,Fa(uh,a.C.rect)),c=vb(c,sa),d=wb(c,function(a){return new kh(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new qg,e=new qg,g=0;g<d.length;g++){for(var h=0;h<d[g].width;h++)e.add(d[g].left+h);for(h=0;h<d[g].height;h++)b.add(d[g].top+h)}a=Jcc(a,c);return{rows:b.Ad(),Ae:e.Ad(),rOa:a}}
function Jcc(a,b){a.F.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(xh(b)||0==Hh(b))return!0;a=EOa(sw(a.F).Y,b.top,b.left);return b.equals(a)}function Mcc(a,b){K.call(this,"cu");this.C=a;this.F=b}z(Mcc,K);function Qcc(a,b,c){K.call(this,"ce");this.C=a;this.F=b;this.Y=c}z(Qcc,K);function Ncc(a,b){K.call(this,"cs");this.C=a;this.F=b}z(Ncc,K);function IW(a,b,c,d,e,g){mU.call(this,g);this.Na=a;this.Ab=b.C;this.Ka=c;this.dd=d;this.L=e;this.Y=new GW(b,c,d,e,this.oa);this.Ma(this.Y);this.R=new EV(!1,"#4285f4");this.Ma(this.R);this.O=null;this.Ff=this.jb=!1;this.Za=!0;this.Xa=pJ.getInstance();this.ea=this.$="";this.Ua=Xo(new Wo,10).Fa()}z(IW,mU);q=IW.prototype;q.Sa=function(){IW.Z.Sa.call(this);this.Ba=Pr(this.Uua(),{LPb:nm});Ep(this.Ba,"waffle-assistant-sidepanel")};q.Uua=v;
q.Ha=function(){IW.Z.Ha.call(this);var a=S(this,"waffle-assistant-quicksum-panel");this.Y.Va(a);a=S(this,"waffle-assistant-spinner-container");this.R.render(a);this.getHandler().V(this,"close-sidebar",this.zna).V(this.Na,Hcc.z_a,this.nna).V(this.Na,Hcc.y_a,this.mna).V(this.Na,Hcc.$Xa,this.Oma).V(this.Na,Hcc.ZXa,this.Nma).V(S(this,"waffle-assistant-scroll-pane"),"scroll",n$b(this.z2,10,this));a=X.nH.isEnabled();this.Ue(!a)};
q.resize=function(){var a=S(this,"waffle-assistant-sidepane-content"),a=cq(a).height,b=S(this,"waffle-assistant-spinner-container");Lp(b,"margin-top",a/2-16+"px")};q.uh=oa;function Rcc(a,b){var c=a.dH();0!=c.length&&(J(a.O),c=c.filter(function(a){return a instanceof hW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new HW(c,b,a.oa),a.O.render(),I(a,a.O),a.O.Ue(a.Ff)))}q.Ue=function(a){this.Ff=a;Ip(this.Ba,"waffle-assistant-readonly",a);this.Y.Ue(a);this.O&&!this.O.isDisposed()&&this.O.Ue(a)};
q.setVisible=function(a){var b=this.Ta();IW.Z.setVisible.call(this,a);a&&!b&&(this.ea=qJ(this.Xa,jj.Owa),this.R.setActive(!0),JW(this));a||this.KU(!0)};q.nna=function(){this.Ta()&&(this.KU(!0),this.R.setActive(!0),JW(this))};q.mna=function(){this.Ta()&&(this.R.setActive(!1),JW(this))};q.Oma=function(a){this.Ta()&&(this.L.Ob(2775,this.Ua),this.KU(void 0,a.C,a.F),this.M$()||this.R.setActive(!0),JW(this),this.Za=!1)};
q.Nma=function(a){if(this.Ta()){this.L.Ob(2776,this.Ua);var b=a.F;0<b.length&&(this.$=qJ(this.Xa,jj.Mwa));this.KU(!1);this.R.setActive(!1);this.Tua(b,a.C);a=a.Y;b=this.dH();0<b.length&&this.jb&&(b[b.length-1].qc=!0);this.jb=!1;JW(this);this.Vua(a);this.z2()}};q.Tua=v;q.Vua=v;q.KU=v;q.Eka=v;function JW(a){var b=a.M$(),c=gq(S(a,"waffle-assistant-quicksum-panel")),d=a.R.Nb(),b=b||c||d,c=a.Eka();a=S(a,c);R(a,!b)}q.M$=v;q.z2=v;q.dH=v;q.UHa=Mf;
function Scc(a){return S(a,"waffle-assistant-scroll-pane").scrollTop+cq(S(a,"waffle-assistant-sidepane-content")).height}q.Ac=oa;q.Gd=f("Ff");q.zna=function(){this.L.Ob(2226,this.Ua)};q.EGb=function(){""!=this.$&&(rJ(this.Xa,this.$),this.$="");""!=this.ea&&(rJ(this.Xa,this.ea),this.ea="");this.Za||(this.L.Ob(2777,this.Ua),this.Za=!0)};function Tcc(a){a=a||{};return V(T(wU(cs({title:fs(""+Ucc()),Qj:fs('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content">'+V('<div class="waffle-assistant-empty-list-old" style="display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title-old">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body-old">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>')+
'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-card-holder"></div></div></div>'),id:es("autovis"),W1:es("waffle-assistant-title"),cP:es("waffle-assistant-sidepane-content")},a))))}
function Vcc(a){a=a||{};var b=V,c=fs('<div class="waffle-assistant-replaceable-title">'+Ucc()+"</div>"),d,e;e=a||{};d=V;e=e||{};var g;g=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+T(r$b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');g=e.LPb?g+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
g+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=V(g+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=d('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>');return b(T(wU(cs({title:c,Qj:fs(""+d),id:es("autovis"),W1:es("waffle-assistant-title"),cP:es("waffle-assistant-sidepane-content")},a))))}
function Ucc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+T(r$b({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+T("Explore")+"</div></div>")};function KW(a,b,c,d,e,g,h){IW.call(this,a,b,c,d,e,h);this.$a=g;this.Tb=b;this.X=new xq(this.oa);this.Ma(this.X);this.J=new wcc;I(this,this.J);this.D=[];this.F=null;this.Da=new nt("",h,4);sr(this.Da,2);this.Ma(this.Da)}z(KW,IW);
var LW={Ez:"waffle-assistant-scroll-pane-feature-content",kZa:"waffle-assistant-empty-list",zZa:"waffle-assistant-features",r_a:"waffle-assistant-empty-list-learn-more",Zea:"waffle-assistant-expanded-panel",I0a:"waffle-assistant-replaceable-title",Amc:"waffle-assistant-scroll-pane",hO:"waffle-assistant-title"},Wcc={defaultHelpArticleId:"6280499"};q=KW.prototype;q.Uua=function(){return Vcc};q.Eka=n("waffle-assistant-empty-list");
q.Ha=function(){KW.Z.Ha.call(this);this.X.Va(S(this,LW.Zea));NV(this.C.Ba,"Close");var a=this.Tb.O.Sr();nm&&"en"==TD(a)&&(a=new AW(this.$a,this.Ka,this.Ab,this.dd,this.L,this.J,this.oa),this.Ma(a),this.D.push(a));if(zoa||Aoa)a=new vcc(this.L,this.J,this.oa),this.Ma(a),this.D.push(a);a=new kW(this.Ab,this.Ka,this.L,this.J,this.oa);this.Ma(a);this.D.push(a);var b=S(this,LW.zZa);A(this.D,function(a){a.render(b);this.X.Ma(a.D,!0)},this);this.Da.Va(S(this,LW.r_a));this.getHandler().V(this.Da,"action",
this.OXb);Xcc(this)};q.OXb=function(){Q.In.Pb(Wcc)};q.Tua=function(a,b){for(var c=0;c<this.D.length;c++){for(var d=[],e=0;e<a.length;e++){var g=Fc(a[e],1);this.D[c].e5(g)&&d.push(a[e])}0<d.length&&this.D[c].Rua(d,b)}};q.Vua=function(){A(this.D,function(a){z$b(a)})};q.KU=function(a,b,c){A(this.D,function(d){d.w2(a,b,c)})};q.M$=function(){return!!Ab(this.D,function(a){return a.Mna()})};
q.z2=function(){var a=Scc(this);A(this.D,function(b){this.F&&this.F!=b||(b instanceof kW&&Gf(this.getHandler(),b,"assistant-done-rendering",this.EGb),a=b.Sua(a))},this)};q.dH=function(){if(this.F)return this.F.D.D;var a=[];A(this.D,function(b){Ob(a,y$b(b))});return a};q.Ue=function(a){KW.Z.Ue.call(this,a);Xcc(this)};q.uh=function(a){A(this.D,function(b){b.uh(a)})};
q.Ac=function(){var a=S(this,LW.Ez),b=S(this,LW.I0a),c=S(this,LW.hO),d=this.X.Ba;if(this.F)this.F.D.setVisible(!1),this.F.setActive(!1),this.F=null,R(a,!0),R(d,!1),Nr(b,Ucc),xp(b,"label"),this.resize();else if(this.F=Ab(this.D,function(a){return a.Nb()}))R(a,!1),R(d,!0),this.F.D.setVisible(!0),A$b(this.F,b),Bp(b,this.F.JU());bq(c,cq(b).height);dl(function(){var a=Vv;a&&a.dispatchEvent("resize");this.z2()},150,this)};
q.setVisible=function(a){var b=this.Ta();KW.Z.setVisible.call(this,a);a&&!b&&Ycc(this,!0);a||this.J.clear()};q.zna=function(){KW.Z.zna.call(this);this.F&&this.Ac()};q.nna=function(){KW.Z.nna.call(this);Ycc(this,!0)};q.mna=function(){KW.Z.mna.call(this);Ycc(this,!1)};q.Oma=function(a){KW.Z.Oma.call(this,a);Ycc(this,!0,a.C)};q.Nma=function(a){KW.Z.Nma.call(this,a);Ycc(this,!1)};function Xcc(a){A(a.D,function(a){a.Ue(this.Gd())},a)}q.UHa=f("D");function Ycc(a,b,c){A(a.D,function(a){c||v$b(a.D,b)})};function Zcc(a){var b;a=a||{};return V('<div class="docs-explore-promo-base '+W(a.Vf)+'"><div class="docs-explore-promo-content">'+(a.tF?'<div class="docs-explore-promo-header">'+T(null==(b=a.tF)?"":b)+"</div>":"")+'<div class="docs-explore-promo-description">'+T(null==(b=a.PX)?"":b)+'<div class="docs-explore-promo-buttons">'+(a.dJ?T(mt({Ee:"docs-explore-promo-button docs-explore-promo-continue-button",content:fs(""+T(a.dJ)),style:4})):"")+(a.lJ?T(mt({Ee:"docs-explore-promo-button docs-explore-promo-close-button",
content:fs(""+T(a.lJ)),style:4})):"")+"</div></div></div>"+(a.yNa?V('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+T(r$b({color:a.yNa,iconSize:"32"}))+"</div></div>"):"")+"</div>")};function $cc(a,b){xq.call(this,b);this.F=new nt("",b);this.Ma(this.F);this.C=new nt("",b);this.Ma(this.C);this.D=new nt("",b);sr(this.D,2);this.Ma(this.D);this.J=a;Sqa([Q.qea,Q.rea,Q.Lwa],!0)}z($cc,xq);q=$cc.prototype;q.Sa=function(){this.Ba=Pr(Zcc,this.J)};
q.Ha=function(){$cc.Z.Ha.call(this);var a=S(this,"docs-explore-promo-continue-button");a&&this.F.Va(a);(a=S(this,"docs-explore-promo-close-button"))&&this.C.Va(a);(a=S(this,"docs-explore-promo-icon"))&&this.D.Va(a);this.getHandler().V(this.F,"action",this.kKa).V(this.C,"action",this.C7a).V(this.D,"action",this.lrb)};q.show=function(a){Q.Lwa.Pb();this.render(a)};q.kKa=function(a){Q.qea.Pb();a.stopPropagation()};q.C7a=function(a){Q.rea.Pb();a.stopPropagation()};q.lrb=function(a){this.kKa(a)};function adc(a){return V('<div class="waffle-assistant-walkthrough-promo-content"><h1 class="waffle-assistant-walkthrough-promo-header">'+T(a.tF)+'</h1><p class="waffle-assistant-walkthrough-promo-description">'+T(a.PX)+"</p>"+(a.dJ?T(mt({Ee:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-continue-button",content:fs(""+T(a.dJ)),style:4})):"")+(a.lJ?T(mt({Ee:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-close-button",content:fs(""+T(a.lJ)),
style:4})):"")+"</div>")};function MW(a,b,c){uF.call(this,a,c);this.O=new nt("",c);this.C=new nt("",c);a=Pr(adc,b);this.setContent(a);this.Gg("docs-promo-bubble");this.setPosition(0,0);this.F.My=!0;Jq(this.D,!1);this.Jv=!1}z(MW,uF);MW.prototype.Ha=function(){MW.Z.Ha.call(this);var a=S(this,"waffle-assistant-walkthrough-promo-continue-button");a&&this.O.Va(a);(a=S(this,"waffle-assistant-walkthrough-promo-close-button"))&&this.C.Va(a);this.getHandler().V(this.O,"action",this.J).V(this.C,"action",this.R)};
MW.prototype.J=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};MW.prototype.R=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};function bdc(a){var b=Om("waffle-assistant-chart-preview",void 0);MW.call(this,b,{tF:"See the big picture",PX:"Data visualizations and text summaries make it easier to spot trends and outliers",dJ:"Learn more",lJ:"Got it"},a)}z(bdc,MW);var cdc={defaultHelpArticleId:"6280499"};bdc.prototype.J=function(a){Q.In.Pb(cdc);bdc.Z.J.call(this,a)};function ddc(a,b){var c=Om("waffle-assistant-answers-input",void 0),d;d=new Wv;a="Interested in the "+(d.Hm("b")+(a+(d.Tm("b")+"? Ask a question about your data to learn more, no formulas needed.")));d={tF:"Find answers in a snap",PX:d.format(a),dJ:"Next",lJ:"Dismiss"};MW.call(this,c,d,b)}z(ddc,MW);function edc(a,b){a={Vf:"waffle-assistant-entry-promo",tF:"Get insights instantly",PX:nm&&"en"==TD(a)?"Find answers to questions about your data, apply formatting, and create charts in a single click using Sheets Explore":"Apply formatting and create charts over your data in a single click using Sheets Explore",dJ:"Check it out",lJ:"Dismiss",yNa:"#0F9D58"};$cc.call(this,a,b)}z(edc,$cc);function fdc(a){var b=Om("waffle-assistant-banding-color-picker-container",void 0);MW.call(this,b,{tF:"Make it pop",PX:"Quickly apply alternating row color formatting to add style, polish, and visual appeal",dJ:"Next",lJ:"Dismiss"},a)}z(fdc,MW);function gdc(a,b,c,d,e,g,h,k,l){sU.call(this,b,h);this.Pa=a;this.C=b;this.Y=c;this.La=d;this.yb=e;this.va=g;this.Da=k;this.X=c.C;this.Ka=this.ea=!1;this.J=l;this.D=null;this.Gc=new Ii;this.O=null;a=qw(this.yb);this.qa.V(this.La,"selectionChange",this.RXb).V(this.X,"Sa",this.QXb).V(a,"kb",this.bub).V(this.C,"assistant-sidepane-apply-conditional-format-rules",this.Ejb).V(this.C,"assistant-sidepane-apply-banding",this.Djb).V(this.C,"assistant-sidepane-remove-banding",this.$xb).V(this.C,"assistant-sidepane-change-selection",
this.Skb).V(this.C,"assistant-sidepane-insert-chart",this.Vrb).V(this.C,"assistant-sidepane-thumbs",this.NAb).V(this.C,"assistant-sidepane-set-active-panel",this.Izb).V(this.C,"assistant-sidepane-back-button-clicked",this.$jb).V(this.C,"assistant-undo-pressed",this.SXb).V(this.Pa,"cu",this.lmb);Uo(this.L,X.nH,fo,this.Yrb).subscribe(X.ZU,"action",this.Xjb).subscribe(X.M2,"action",this.AAb).subscribe(X.Xda,"action",this.vAb);X.L2.Qa(!0);this.R=Xo(new Wo,10).Fa();this.Na=pJ.getInstance();this.Ga=qJ(this.Na,
jj.Kwa);dl(Fa(this.tX,!1),100,this)}z(gdc,sU);q=gdc.prototype;q.Ih=function(){return X.Zda};q.wt=function(){return X.$da};q.Ds=function(a){gdc.Z.Ds.call(this,a);X.M2.Qa(a);this.tX(!1);!this.ea&&a&&(this.ea=!0,Foa&&qK(this.Da,"ritz-DisplayExploreV2Promo",!1))};q.uh=function(a){this.C.uh(a);this.Pa.uh(a)};q.Xjb=function(){var a=this.C.Ta();this.Ih().setVisible(!a);a?this.J.Ob(2226,this.R):(this.C.focus(),this.J.Ob(2253,this.R))};q.vAb=function(){this.C.Ta()||this.Ds(!0)};
q.AAb=function(a){Rcc(this.C,a)};q.RXb=function(){this.tX(!0)};q.tX=function(a,b){if(b){if(!b.length)return;if(1==b.length&&this.O&&b[0].equals(this.O)){this.O=null;return}}var c=this.C;c.Ta()&&(ycc(c.Y),JW(c));this.Pa.update(!a,this.C.Ta(),b)};
q.lmb=function(a){""!=this.Ga&&(rJ(this.Na,this.Ga),this.Ga="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&Hh(c)>=Joa&&Ch(c,"r")>=Loa&&Ch(c,"c")>=Moa&&Hh(c)<=Koa)&&.6<=b;d!==this.Ka&&(this.Ka=d,X.L2.Pb(d),!d&&this.D&&(J(this.D),this.D=null));if(c){if(a&&a.rect){var d=.9<=b,e=1E3>=Hh(a.rect),c=ritz.isFormsRegion(""+a.ud,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),d=voa&&!this.C.Ta()&&!this.ea&&d&&e&&!cy(this.Y),c=woa&&c,e=xoa&&this.Y.Gd();d&&(c||e)?(d=new k$b,P(d,
1,b),P(d,2,c),P(d,3,e),c=new jo,dj(c,58,d),this.mBa(new Vo(10,c)),c=!0):c=!1}else c=!1;if(c=!c)if(c=Foa){if(b=.6<=b&&!this.C.Ta()&&!this.ea&&!this.D&&this.Da.C["ritz-DisplayExploreV2Promo"].Ia()&&a)b=a.rect,b=ritz.hasBandingSuggestions(a.ud+"",b.fc(),b.Pc(),b.Wb(),b.Uc());c=b}c&&(a=this.Y.O.Sr(),this.D=new edc(a),I(this,this.D),this.D.show(),this.L.subscribe(Q.qea,"action",this.epb).subscribe(Q.rea,"action",this.tna),qK(this.Da,"ritz-DisplayExploreV2Promo",!1),this.J.Ob(2788,this.R))}};
q.mBa=function(a){this.C.jb=!0;var b=pQa(sw(this.X));VKb.C||b||(a=a||this.R,this.Ih().setVisible(!0),this.J.Ob(2225,a),dl(Fa(this.r4a,a),5E3,this))};q.r4a=function(a){this.C.Ta()||this.J.Ob(2752,a)};q.tna=function(){J(this.D);this.D=null};
q.epb=function(){J(this.D);this.Ds(!0);Gf(this.qa,this.C,"assistant-done-rendering",y(function(){var a;a:{this.C.Ta();a=this.Y.O.Sr();a=nm&&"en"==TD(a);for(var b=!1,c=!1,d=!1,e=this.C.dH(),g=0;g<e.length;g++)if(e[g]instanceof oW?b=!0:e[g]instanceof BW?c=!0:e[g]instanceof hW&&(d=!0),c&&d&&(b||!a)){a=!0;break a}a=!1}a?this.PLa():this.tna()},this))};
q.PLa=function(){this.C.Ta();J(this.D);var a=null;this.D instanceof edc?(a=this.Y.O.Sr(),nm&&"en"==TD(a)?(a=this.C.UHa(),a=bcc(Ab(a,function(a){return a instanceof AW}).L).toLowerCase(),a=new ddc(a)):a=new fdc):this.D instanceof ddc?a=new fdc:this.D instanceof fdc&&(a=new bdc);if(this.D=a)I(this,this.D),this.D.render(),Gf(Gf(this.qa,this.D,"promo-dismiss",this.tna),this.D,"promo-continue",this.PLa)};q.$jb=function(){this.C.Ac()};
q.SXb=function(a){var b=a.C,c=b.D.XJ(),d=parseInt(c.eb(),10);this.O=Oh(c);this.va.C(new OLb(d));scc(b,c);this.J.Ob(a.Hj(),this.R)};q.QXb=function(){rw(this.X)?(this.C.Qa(!0),this.tX(!1)):(this.Ih().setVisible(!1),this.C.Qa(!1))};q.Yrb=function(){this.C.Ue(!X.nH.isEnabled())};q.bub=function(a){this.tX(!1,a.C?a.C:a.rect?[a.rect]:[])};
q.Ejb=function(a){var b=sw(this.X),c=""+b.hc(),d=[],e=Z5b(b);if(e){var b=new Xe,g=Fc(e,2);E(b,3,g);g=Fc(e,2);E(b,2,g);e=Fc(e,1);E(b,1,e);d.push(b)}b=a.C.Ab;for(e=0;e<b.length;e++)g=new Xe,E(g,2,b[e]),d.push(g);this.va.C(new xU(d,c));a=a.Hj();this.J.Ob(a,this.R)};
q.Djb=function(a){var b=a.C,c=L6b(b.C),d=b.D.XJ(),e=c.au?c.Gw:null,g=c.C?c.pw:null,h=parseInt(d.eb(),10),k=hdc(d);this.O=Oh(d);k?this.va.C(new rU(k,h,this.O,e,c.Mr,c.Cs,g)):this.va.C(new pU(h,this.O,e,c.Mr,c.Cs,g));d=new l6b;P(d,1,1);c=new KT;b=b.D.CT();P(c,2,b);dj(c,5,d);b=new jo;dj(b,46,c);b=new Vo(10,b);a=a.Hj();this.J.Ob(a,b)};q.$xb=function(a){a=a.C;var b=a.D.XJ(),c=parseInt(b.eb(),10),d=hdc(b);this.O=Oh(b);this.va.C(new qU(d,c));scc(a,b)};
function hdc(a){var b=a.eb();a=Oh(a);b=ritz.getWorkbookRangeIntersectingIds(b,a.fc(),a.Wb(),a.Pc(),a.Uc(),7,!1);return 0<b.length?b[0]:null}q.Skb=function(a){aD(sw(this.X),a.F);a=a.Hj();this.J.Ob(a,this.R)};
q.NAb=function(a){var b=a.C;a=a.Hj();if(b instanceof mW||b instanceof oW)this.J.Ob(a,this.R);else{var c=this.C.dH(),d=new KT,e=b.D.CT(),c=c.indexOf(b);P(d,1,c);P(d,2,e);e=new jo;dj(e,46,d);if(b instanceof hW){(d=b.L)?(b=idc(this,b,d),b=x9b(b,d,d.Og)):b=null;if(!b)return;dj(e,39,b)}else if(b instanceof jW){var g=b.D,c=new m$b;if(b instanceof jW)b=1;else throw Error("Unknown text analysis card type.");g=Ec(g.getAutovisRecommendation(),20).slice(0,10);P(c,2,g||[]);P(c,1,b);dj(d,3,c)}this.J.Ob(a,new Vo(10,
e))}};q.Izb=function(){this.C.Ac()};
q.Vrb=function(a){var b=a.Y;if(b){var c=sw(this.X),d=a.Se();d||(d=aB(this.La).td().C.Se());var e=16,g=16,h=a.Ua;h&&(e=h.x,g=h.y);c={oid:null,ar:lD(c,d.y),ac:mD(c,d.x),x:e,y:g,h:uIa.height,w:uIa.width,p:{context:{chartName:"Chart "+(jdc(this)+1)}}};d=new hI(mw(this.X)||0,c,!1,!1);c=b.Og;e=new Fl(c);g=Nl(e,"headers");g=null!=g&&ya(g)&&Va(g)?parseInt(g,10):-1;d.Pa=g;d.va=0;g="1"==Nl(e,"transpose");d.La=g;d.O=g?"ROWS":"COLS";g=Nl(e,"range");g=c6b(b6b(g,","),this.X);d.ZT(g);i5b(d,b);if(e=Nl(e,"dt"))e=
this.Gc.fd(df.Ca(),JSON.parse(decodeURIComponent(e))),d.R=encodeURIComponent(JSON.stringify(d.Ua.serialize(e)));this.La.dispatchEvent(new mF("objectRequest"));this.va.C(new fF(this.Y,d));d=kdc(this,b,a.$,a.Pe());w9b(this.J,a.Hj(),d,10,b,c)}};function idc(a,b,c){var d=a.C.dH().filter(function(a){return a instanceof hW});return kdc(a,c,d.indexOf(b),b.L&&b.L.Pe())}
function kdc(a,b,c,d){var e=new z9b;a=a.C.dH().filter(function(a){return a instanceof hW}).map(function(a){return a.getChartType()});e.R=a;e.J=c;A9b(e,b.getChartType());e.D=d?d.clone():null;return e}function jdc(a){var b=0;CG(a.Y.J,function(a){6==a.getType()&&b++});return b};function ldc(a,b){fW.call(this,a,b)}z(ldc,fW);q=ldc.prototype;q.zz=function(a){a()};q.qz=oa;q.ly=n("assistantPivotTableFeedback");q.FE=n(2632);q.CE=n(2631);function mdc(a,b,c,d,e,g,h){IW.call(this,a,b,c,d,e,h);this.J=new xq(this.oa);this.Ma(this.J);this.F=null;this.Da=new M;I(this,this.Da);this.D=[];this.$a=null;this.X=!0}z(mdc,IW);var ndc={bYa:"waffle-assistant-card-holder",Ez:"waffle-assistant-sidepane-content",eZa:"waffle-assistant-dragger-card",dZa:"waffle-assistant-dragged-card",kZa:"waffle-assistant-empty-list-old",VISIBLE:"waffle-assistant-visible"};q=mdc.prototype;q.Uua=function(){return Tcc};q.Eka=n("waffle-assistant-empty-list-old");
q.Ha=function(){mdc.Z.Ha.call(this);var a=S(this,ndc.bYa);this.J.Va(a)};q.setVisible=function(a){var b=this.Ta();mdc.Z.setVisible.call(this,a);a&&!b&&(this.X=!0)};
q.Tua=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=D(c,1),e=null;switch(d){case 0:"WordCloud"==c.getAutovisRecommendation().getChartType()?e=new jW(c,this.oa):e=new hW(c,this.Ab,this.Ka,this.L,null,this.oa);break;case 1:e=new ldc(c,this.oa);break;case 2:e=new CW(c,this.oa);break;case 4:e=new BW(c,this.L,this.oa);break;default:throw Error("Unsupported recommendation type: "+d);}c=this.J.ld();e.Y=c;this.J.Ma(e,!0);if(X.nH.isEnabled()){if(!this.F||this.F.isDisposed())this.F=new odc,N6b(this.F,
this.J.Ba),this.F.X=10,this.F.R=Ya(ndc.eZa).split(" "),this.F.ea=!0,this.F.hsa(ndc.VISIBLE),this.F.L=!1,this.F.Te(),this.Da.V(this.F,"beforedragstart",y(this.TXb,this)).V(this.F,"dragstart",y(this.UXb,this)).V(this.F,"beforedragend",y(this.jkb,this));var c=this.F,d=this.J.Ba,g=e.Ba;u(void 0)?zpa(d,g,void 0):d.appendChild(g);O6b(c,g)}0!=this.D.length&&e.getHandler().V(this.D[this.D.length-1],"content-rendered",e.lP);this.D.push(e)}};
q.Vua=function(a){0<this.D.length&&this.D[0].lP();if(a||this.X)this.X=!1,pdc(this)};function pdc(a){if(0!=a.D.length){for(var b=0,c=0;c<a.D.length;c++){var d=a.D[c].Ba;Rp(d,0,1E3);b+=cq(d).height}b=Math.max(cq(S(a,"waffle-assistant-sidepane-content")).height,b);bq(a.J.Ba,b);for(c=0;c<a.D.length;c++)dl(Fa(a.U2a,a.D[c]),100*c,a);dl(function(){bq(this.J.Ba,"auto")},100*a.D.length,a)}}q.U2a=function(a){!a.isDisposed()&&this.isEnabled()&&(new bU(a.Ba,[0,1E3],[0,0],100)).play()};
q.KU=function(){this.Da.Fc();J(this.F);for(var a=0;a<this.D.length;a++){var b=this.D[a];b.mc()&&this.J.removeChild(b,!0);J(b)}this.D=[]};q.M$=function(){return 0<this.D.length};q.z2=function(){for(var a=Scc(this),b=0,c=0;c<this.D.length;c++)b<a?(PV(this.D[c],!0),b+=cq(this.D[c].Ba).height):PV(this.D[c],!1)};q.TXb=function(a){var b=tb(this.J.Ba.childNodes,a.C),b=this.J.yd(b);b.hOa()?this.$a=b:a.preventDefault()};q.UXb=function(a){Ep(a.F,ndc.dZa)};
q.jkb=function(a){var b=Sp(a.F),c=aB(this.Ka).C;if(mh(QE(c,"page",!1,!1)).contains(b)){var d=OE(c,b.x,b.y,"page"),c=SE(c,sh(d),"page");this.$a.C9(d,new N(b.x-c.left,b.y-c.top))}a.Y.Dw(null,!0);a.preventDefault();this.$a=null};q.dH=f("D");function odc(){yU.call(this)}z(odc,yU);odc.prototype.Ila=function(a){a=odc.Z.Ila.call(this,a);var b=wb(a.querySelectorAll("clippath"),function(a){return a.id});qdc(a,b);return a};
function qdc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];ya(c)&&db(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=dn(a);for(d=0;d<a.length;d++)qdc(a[d],b)};function rdc(){H.call(this)}z(rdc,Jn);rdc.prototype.C=function(){return Gcc};rdc.prototype.F=function(){return zoa||Aoa||nm?KW:mdc};rdc.prototype.D=function(){return gdc};Rn("assistant",rdc);
